<!DOCTYPE html>
<html color-mode="light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="ucs_libraries/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="ucs_libraries/dataTables.bootstrap4.min.css" />
    <link rel="stylesheet" type="text/css" href="ucs_libraries/flags32.css" />

    <title>UCS Renaming Tool</title>
    <link rel="icon" type="image/png" href="ucs_libraries/ucs_logo_black_on_white.png">

    <style>
        /* Light Mode CSS Vars */
        :root[color-mode="light"] {
            --text-color: #333333;
            --background-color: #ffffff;
            --border-color: black;
            --navbar-background: #cccccc;
            --navbar-text: #000000;
            --modal-background:  #ffffff;
        }

        /* Dark Mode CSS Vars */
        :root[color-mode="dark"] {
            --text-color: #ffffff;
            --background-color: #2c3034;
            --border-color: white;
            --navbar-background: #1b1f22;
            --navbar-text:  #ffffff;
            --modal-background:  #282b2e;
        }
        
        :root[color-mode="light"] .light--hidden {
            display: none;
        }

        :root[color-mode="dark"] .dark--hidden {
            display: none;
        }
        
        /* Main */
        #main_wrap {
            margin: 0 auto;
            width: 960px;
            position: relative;
            overflow-x: hidden;
        }

        /* Divs */
        div {
            margin-top: 10px;
            margin-bottom: 10px;
            margin-right: 30px;
            margin-left: 30px;
        }

        /* Page body */
        body {
            padding-top: 70px;
            background-color: var(--background-color);
            color: var(--text-color);
            transition: background-color 1s, color 1s;
        }

        /* Headings */
        h3 {
            margin-top: 40px;
        }

        h5 {
            display: flex;
            width: 30%;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

            h5:before,
            h5:after {
                content: '';
                border-top: 2px solid;
                margin: 0 20px 0 0;
                flex: 1 0 20px;
            }

            h5:after {
                margin: 0 0 0 20px;
            }

        h7 {
            margin-top: 40px;
        }

        /* Selects and Drop Downs*/
        select {
            margin-top: 10px;
        }

        .dropdown-menu {
            color: var(--text-color);
            background-color: var(--navbar-background);
        }

        .dropdown-item {
            color: var(--text-color);
            background-color: var(--navbar-background);
        }

        /* Horizontal line */
        hr {
            border: 1px solid var(--border-color);
            transition: border 1s;
        }

        /* Form elements */
        .form-group label, input, select, textarea {
            color: var(--text-color) !important;
            background-color: var(--background-color) !important;
            transition: background-color 1s, color 1s;
        }

        /* Cards */
        .card {
            color: var(--text-color) !important;
            background-color: var(--background-color) !important;
            transition: background-color 1s, color 1s;
        }

        /* Modal */
        .modal-content {
            color: var(--text-color) !important;
            background-color: var(--modal-background) !important;
        }

        .modal-backdrop {
            margin: 0;
        }

        .modal-heading {
            margin-top: 30px;
            font-style: italic;
        }

        /* Row Click Alert */
        .notification {
            display: none;
            position: sticky;
            top: 100px;
            right: 20px;
            width: 250px;
            justify-content: right;
            box-sizing: border-box;
        }

        @font-face {
            font-family: 'Helvetica';
        }

        /* Form Field Required */
        .form-group.required .control-label:after {
            content: "*";
            color: red;
        }

        /* Buttons */
        button {
            height: 45px;
            line-height: 120px;
            margin: 5px;
            white-space: pre;
        }

        /* Button Icons */
        /* https://www.svgrepo.com/ */
        .icons {
            position: relative;
            display: inline-block;
            speak: none;
            font-style: normal;
            font-weight: normal;
            width: 16px;
            height: auto;
            line-height: 1;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* BUTTON COLOR FILTERS */
        /* https://codepen.io/sosuke/pen/Pjoqqp */
        .filter-green {
            filter: invert(24%) sepia(76%) saturate(458%) hue-rotate(82deg) brightness(94%) contrast(95%);
        }

        .filter-yellow {
            filter: invert(41%) sepia(80%) saturate(1700%) hue-rotate(29deg) brightness(96%) contrast(94%);
        }

        .filter-blue {
            filter: invert(16%) sepia(74%) saturate(2294%) hue-rotate(198deg) brightness(104%) contrast(101%);
        }

        .filter-info {
            filter: invert(64%) sepia(44%) saturate(6740%) hue-rotate(153deg) brightness(93%) contrast(82%);
        }

        .filter-light {
            filter: invert(100%) sepia(11%) saturate(496%) hue-rotate(176deg) brightness(100%) contrast(97%);
        }

        .filter-dark {
            filter: invert(21%) sepia(13%) saturate(448%) hue-rotate(169deg) brightness(93%) contrast(93%);
        }

        /* SET BUTTON ICON COLORS WHITE ON HOVER */
        .btn-outline-primary:hover .filter-blue {
            filter: invert(99%) sepia(9%) saturate(0%) hue-rotate(203deg) brightness(115%) contrast(100%);
        }

        .btn-outline-info:hover .filter-info {
            filter: invert(99%) sepia(9%) saturate(0%) hue-rotate(203deg) brightness(115%) contrast(100%);
        }

        .btn-outline-light:hover {
            color: #161719 !important;
        }

        .btn-outline-light:hover .filter-light {
            filter: invert(21%) sepia(13%) saturate(448%) hue-rotate(169deg) brightness(93%) contrast(93%);
        }

        .btn-outline-dark:hover {
            color: #F8F9FA !important;
        }

        .btn-outline-dark:hover .filter-dark {
            filter: invert(100%) sepia(11%) saturate(496%) hue-rotate(176deg) brightness(100%) contrast(97%);
        }

        /* BUTTON SUBMISSION ANIMATION */
        .anim-trig {
            animation: fadeOutRight 1s ease-in-out 0s 1 normal;
        }

        @-webkit-keyframes fadeOutRight {
            0% {
                opacity: 1
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(120%,0,0) scale3d(0.6, 0.6, 0.6);
                transform: translate3d(120%,0,0) scale3d(0.6, 0.6, 0.6)
            }
        }

        @keyframes fadeOutRight {
            0% {
                opacity: 1
            }

            to {
                opacity: 0;
                -webkit-transform: translate3d(120%,0,0) scale3d(0.6, 0.6, 0.6);
                transform: translate3d(120%,0,0) scale3d(0.6, 0.6, 0.6)
            }
        }

        /* DATATABLES SEARCH BAR & PAGINATION */
        .dtSearch {
            align-items: flex-start;
            display: flex;
            margin-left: auto;
            justify-content: left;
            margin-top: 15px;
        }

        .dtPages {
            align-items: center;
            display: flex;
            justify-content: center;
        }

        /* TYPEAHEAD x BOOTSTRAP FORMATTING */
        span.twitter-typeahead .tt-menu,
        span.twitter-typeahead .tt-dropdown-menu {
            cursor: pointer;
            position: absolute;
            top: 100%;
            left: 0;
            z-index: 1000;
            display: none;
            float: left;
            min-width: 160px;
            padding: 5px 0;
            margin: 2px 0 0;
            list-style: none;
            font-size: 14px;
            text-align: center;
            background-color: var(--background-color);
            transition: background-color 1s;
            border: 1px solid #cccccc;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 4px;
            -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
            background-clip: padding-box;
        }

        span.twitter-typeahead .tt-suggestion {
            display: block;
            padding: 3px 20px;
            clear: both;
            font-weight: normal;
            line-height: 1.42857143;
            color: var(--text-color);
            transition: color 1s;
            white-space: nowrap;
        }

            span.twitter-typeahead .tt-suggestion.tt-cursor,
            span.twitter-typeahead .tt-suggestion:hover,
            span.twitter-typeahead .tt-suggestion:focus {
                color: #ffffff;
                text-decoration: none;
                outline: 0;
                background-color: #337ab7;
            }

        .input-group.input-group-lg span.twitter-typeahead .form-control {
            height: 46px;
            padding: 10px 16px;
            font-size: 18px;
            line-height: 1.3333333;
            border-radius: 6px;
        }

        .input-group.input-group-sm span.twitter-typeahead .form-control {
            height: 30px;
            padding: 5px 10px;
            font-size: 12px;
            line-height: 1.5;
            border-radius: 3px;
        }

        span.twitter-typeahead {
            width: 100%;
        }

        .input-group span.twitter-typeahead {
            display: block !important;
            height: 34px;
        }

            .input-group span.twitter-typeahead .tt-menu,
            .input-group span.twitter-typeahead .tt-dropdown-menu {
                top: 32px !important;
            }

            .input-group span.twitter-typeahead:not(:first-child):not(:last-child) .form-control {
                border-radius: 0;
            }

            .input-group span.twitter-typeahead:first-child .form-control {
                border-top-left-radius: 4px;
                border-bottom-left-radius: 4px;
                border-top-right-radius: 0;
                border-bottom-right-radius: 0;
            }

            .input-group span.twitter-typeahead:last-child .form-control {
                border-top-left-radius: 0;
                border-bottom-left-radius: 0;
                border-top-right-radius: 4px;
                border-bottom-right-radius: 4px;
            }

        .input-group.input-group-sm span.twitter-typeahead {
            height: 30px;
        }

            .input-group.input-group-sm span.twitter-typeahead .tt-menu,
            .input-group.input-group-sm span.twitter-typeahead .tt-dropdown-menu {
                top: 30px !important;
            }

        .input-group.input-group-lg span.twitter-typeahead {
            height: 46px;
        }

            .input-group.input-group-lg span.twitter-typeahead .tt-menu,
            .input-group.input-group-lg span.twitter-typeahead .tt-dropdown-menu {
                top: 46px !important;
            }

        /* Datatables pagination buttons */
        .page-item.active .page-link {
            color: var(--text-color) !important;
            background-color: var(--background-color) !important;
            transition: background-color 1s, color 1s;
        }

        .page-link {
            color: var(--text-color) !important;
            background-color: var(--background-color) !important;
            transition: background-color 1s, color 1s;
        }
    </style>
    <script src="/main.js"></script>
    <script type="text/javascript" src="ucs_libraries/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="ucs_libraries/popper.min.js"></script>
    <script type="text/javascript" src="ucs_libraries/bootstrap.min.js"></script>
    <script type="text/javascript" src="ucs_libraries/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="ucs_libraries/dataTables.bootstrap4.min.js"></script>
    <script type="text/javascript" src="ucs_libraries/typeahead.bundle.js"></script>
    <script type="text/javascript" src="ucs_libraries/countrystatecity.js"></script>
</head>
<body>
    <!--------------->
    <!--- NAVBAR ---->
    <!--------------->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" style="background-color: var(--navbar-background); color: var(--navbar-text); transition: background-color 1s, color 1s;" id="ucsNavbar">
        <a class="navbar-brand" href="#">
            <img src="ucs_libraries/ucs_logo_white_on_black.png" width="30" height="30" class="d-inline-block align-top" alt="" id="navbarLogo">
            <b id="navbarTitle">&nbsp;UCS Renaming Tool</b>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" style="white-space: normal;">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto f32" style="display: flex; align-items: center; justify-content: center;">
                <li class="nav-item active" id="namingScroll">
                    <a class="nav-link" href="#">Naming<span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item" id="processingScroll">
                    <a class="nav-link" href="#userInputData">Processing</a>
                </li>
                <li class="nav-item" id="metadataScroll">
                    <a class="nav-link" href="#userInputArea">Metadata</a>
                </li>
                <li class="nav-item" id="dataScroll">
                    <a class="nav-link" href="#formSubmitButton">UCS Table</a>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarPresetsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display: flex; align-items: center; justify-content: center;">
                        Presets
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarPresetsDropdown" id="navbarPresetsDropdownOptions">
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#" id="saveThisAsPreset" onClick="showPresetModal()" style="display: flex; align-items: center;">Save/Edit Preset...</a>
                        <a class="dropdown-item" href="#" id="deleteAPreset" onClick="showDeletePresetModal()" style="display: flex; align-items: center;">Delete Preset...</a>
                    </div>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarHistoryDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display: flex; align-items: center; justify-content: center;">
                        History
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarHistoryDropdown" id="navbarHistoryDropdownOptions">
                    </div>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarLangDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display: flex; align-items: center; justify-content: center;">
                        Language
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarLangDropdown">
                        <a class="dropdown-item" href="#" id="langEN" style="display: flex; align-items: center;"><i class="flag us"></i>&nbsp;&nbsp;English</a>
                        <a class="dropdown-item" href="#" id="langES" style="display: flex; align-items: center;"><i class="flag es"></i>&nbsp;&nbsp;Spanish</a>
                        <a class="dropdown-item" href="#" id="langFR" style="display: flex; align-items: center;"><i class="flag fr"></i>&nbsp;&nbsp;French</a>
                        <a class="dropdown-item" href="#" id="langDE" style="display: flex; align-items: center;"><i class="flag de"></i>&nbsp;&nbsp;German</a>
                        <a class="dropdown-item" href="#" id="langIT" style="display: flex; align-items: center;"><i class="flag it"></i>&nbsp;&nbsp;Italian</a>
                        <a class="dropdown-item" href="#" id="langPL" style="display: flex; align-items: center;"><i class="flag pl"></i>&nbsp;&nbsp;Polish</a>
                        <a class="dropdown-item" href="#" id="langNL" style="display: flex; align-items: center;"><i class="flag nl"></i>&nbsp;&nbsp;Dutch</a>
                        <a class="dropdown-item" href="#" id="langDA" style="display: flex; align-items: center;"><i class="flag dk"></i>&nbsp;&nbsp;Danish</a>
                        <a class="dropdown-item" href="#" id="langNO" style="display: flex; align-items: center;"><i class="flag no"></i>&nbsp;&nbsp;Norwegian</a>
                        <a class="dropdown-item" href="#" id="langSE" style="display: flex; align-items: center;"><i class="flag se"></i>&nbsp;&nbsp;Swedish</a>
                        <a class="dropdown-item" href="#" id="langFI" style="display: flex; align-items: center;"><i class="flag fi"></i>&nbsp;&nbsp;Finnish</a>
                        <a class="dropdown-item" href="#" id="langPT" style="display: flex; align-items: center;"><i class="flag pt"></i>&nbsp;&nbsp;Portuguese</a>
                        <a class="dropdown-item" href="#" id="langPTBR" style="display: flex; align-items: center;"><i class="flag br"></i>&nbsp;&nbsp;Portuguese-Brazil</a>
                        <a class="dropdown-item" href="#" id="langZH" style="display: flex; align-items: center;"><i class="flag cn"></i>&nbsp;&nbsp;Chinese</a>
                        <a class="dropdown-item" href="#" id="langJA" style="display: flex; align-items: center;"><i class="flag jp"></i>&nbsp;&nbsp;Japanese</a>
                        <a class="dropdown-item" href="#" id="langTW" style="display: flex; align-items: center;"><i class="flag tw"></i>&nbsp;&nbsp;Taiwanese</a>
                        <a class="dropdown-item" href="#" id="langKR" style="display: flex; align-items: center;"><i class="flag kr"></i>&nbsp;&nbsp;Korean</a>
                        <a class="dropdown-item" href="#" id="langRU" style="display: flex; align-items: center;"><i class="flag ru"></i>&nbsp;&nbsp;Russian</a>
                        <a class="dropdown-item" href="#" id="langUA" style="display: flex; align-items: center;"><i class="flag ua"></i>&nbsp;&nbsp;Ukrainian</a>
                        <a class="dropdown-item" href="#" id="langTR" style="display: flex; align-items: center;"><i class="flag tr"></i>&nbsp;&nbsp;Turkish</a>
                    </div>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0" style="display: flex; align-items: center; justify-content: center;">
                <!-- FETCH FROM REAPER -->
                <a id="reacallBtnDark" onClick="reacall()" type="button" class="btn btn-outline-dark dark--hidden" style="margin-left: 15px; margin-right: 15px;"><img class="icons filter-dark" src="ucs_libraries/reacall.svg" alt="reacall_icon">&nbsp;Reacall</a>
                <a id="reacallBtnLight" onClick="reacall()" type="button" class="btn btn-outline-light light--hidden" style="margin-left: 15px; margin-right: 15px;"><img class="icons filter-light" src="ucs_libraries/reacall.svg" alt="reacall_icon">&nbsp;Reacall</a>

                <!-- SETTINGS MENU -->
                <a id="settingsBtnDark" type="button" class="btn btn-outline-dark dark--hidden" data-toggle="modal" data-target=".settings-modal"><img class="icons filter-dark" src="ucs_libraries/settings.svg" alt="settings_icon">&nbsp;Settings</a>
                <a id="settingsBtnLight" type="button" class="btn btn-outline-light light--hidden" data-toggle="modal" data-target=".settings-modal"><img class="icons filter-light" src="ucs_libraries/settings.svg" alt="settings_icon">&nbsp;Settings</a>
            </form>
        </div>
    </nav>
    
    <!------------------------>
    <!---  SETTINGS MENU  ---->
    <!------------------------>
    <div class="modal fade settings-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h3 style="margin:0;" class="modal-title" id="settingsMenuTitle">UCS Renaming Tool Settings</h4>
              </div>
              <div class="modal-body">               
                <!------------------------>
                <!---  PROCESSING     ---->
                <!------------------------>
                <h5 id="settingsMenuProcessingTitle"><i>Processing</i></h5>
                <!-- VENDOR CATEGORY -->
                <p style="margin-bottom:0px;" id="settingsVendorHeader">Vendor Category:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="vendorCatCheckbox">
                    <h7 id="settingsVendorDescription">Show Vendor Category field. Only relevant for library vendors.</h7>
                </div>
                <!-- DISABLE FX NAME FORMATTING -->
                <p style="margin-bottom:0px;margin-top:15px;" id="settingsFXFormattingHeader">File Name Cleanup:</p>
                <small class="form-text text-muted" id="settingsfxFormatting">Title Case, Remove Illegal Characters, Extra Spaces, etc.</small>
                <select id="fxFormattingSetting" class="form-control col-md-5" style="margin-left:30px">
                    <option>Enable name cleanup (Default)</option>
                    <option>Disable name cleanup</option>
                </select>                
                <!-- DISABLE CAPITALIZATION -->
                <p style="margin-bottom:0px;margin-top:15px;" id="settingsCapsHeader">Automatic Field Capitalization:</p>
                <small class="form-text text-muted" id="settingsCapsDesc">Creator ID, Source ID, User Category, Vendor Category</small>
                <select id="nameCapitalizationSetting" class="form-control col-md-5" style="margin-left:30px">
                    <option>ALL CAPS (Default)</option>
                    <option>Title Case</option>
                    <option>Disable automatic capitalization</option>
                </select>
                <!-- COPY RESULTS -->
                <p style="margin-bottom:0px;margin-top:15px;" id="settingsCopyHeader">Copy UCS File Name to Clipboard:</p>
                <select id="copyResultsSetting" class="form-control col-md-5" style="margin-left:30px">
                    <option>Do not copy (Default)</option>
                    <option>Copy after processing</option>
                    <option>Copy WITHOUT processing</option>
                </select>
                <div id="copyResultsWarning" style="margin:0;margin-left:30px;" class="alert alert-warning" role="alert">This will bypass the processing section and <i>just copy to clipboard</i>.</div>

                <!------------------------>
                <!---  UCS TABLE      ---->
                <!------------------------>
                <h5 class="modal-heading" style="margin-top:35px;" id="settingsUCSTableHeader">UCS Table</h5>
                <!-- AUTO SUBMIT FORM ON ROW CLICK -->
                <p style="margin-bottom:0px;" id="settingsUCSAutoSubmit">Auto Submit:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="autoSubmitCheckbox">
                    <h7 id="settingsUCSAutoSubmitDesc">Automatically submit form data when clicking table rows</h7>
                </div>
                <!-- AUTO SEARCH MEDIA EXPLORER -->
                <p style="margin-bottom:0px;margin-top:25px;" id="settingsFilterMediaExp">Filter Media Explorer:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="autoSearchCatSubcatCheckbox">
                    <h7 id="settingsFilterMediaExpDesc">Search media explorer for category/subcategory when clicking table rows</h7>
                </div>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="autoSearchSynonymsCheckbox">
                    <h7 id="settingsFilterMediaExpSyn">Search media explorer for synonyms when clicking table rows</h7>
                </div>

                <!------------------------>
                <!--- RENDER METADATA  --->
                <!------------------------>
                <h5 class="modal-heading" style="margin-top:35px;" id="settingsMetadataHeader">Metadata</h5>
                <!-- UCS Metadata -->
                <p style="margin-bottom:0px;" id="settingsUCSMetadataHeader">Render UCS Metadata:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="iXMLSettings">
                    <h7 id="settingsUCSMetadataDesc">Embed UCS form info in metadata when rendering</h7>
                </div>
                <!-- Extended Metadata -->
                <p style="margin-bottom:0px;" id="settingsExtMetaHeader">Render Additional Fields:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="metadataSettings">
                    <h7 id="settingsExtMetaDesc">Show extended metadata input fields like microphone, perpective, location, etc</h7>
                </div>
                <div id="metadataWarning" style="margin:0;margin-bottom:20px;" class="alert alert-warning" role="alert">- Render Metadata requires 'Embed: Metadata' to be checked in your render settings<br>- Render Metadata does <b>NOT</b> apply when renaming Tracks<br>- Render Metadata fields are all optional, and can be left blank.</div>
                <!-- Metadata Marker Positioning -->
                <p style="margin-bottom:0px;">Metadata Marker Position:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="markerPositionSettings">
                    <h7>Places metadata (META) markers slightly <i>after</i> regions and items so that they don't get embedded as cue markers at render.<br>This is useful when embedding regular project markers as cue markers in files.<br>Be careful with overlapping regions and items.</h7>
                </div>
                <!-- Render Directory -->
                <p style="margin-bottom:0px;">Render to Category/Subcategory Directory:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="renderDirectorySettings">
                    <h7>Sets render dialog wildcards for <b>/UCS Category/UCS Subcategory/Filename</b></h7>
                </div>
                <!-- ASWG Metadata -->
                <p style="margin-bottom:0px;" id="ASWGMetaHeader">Sony ASWG Scheme Metadata:</p>
                <div class="form-check" style="margin-left:30px">
                    <input class="form-check-input" type="checkbox" id="ASWGSettings">
                    <h7 id="ASWGMetaDesc">Show additional fields for ASWG General, SFX, Dialogue, and Music metadata?<br>Requires "Render Additional Fields" above.</h7>
                </div>
                <!-- Location Input -->
                <p style="margin-bottom:0px;" id="locInputHeader">Location Input:</p>
                <div class="form-check" style="margin-left:30px" id="locInputDiv">
                    <input class="form-check-input" type="checkbox" id="locationInputSettings">
                    <h7 id="locationInputDesc"><b>Unchecked</b>: Country, State, City - Separate dropdowns (Default; requires online connection for location API)<br><b>Checked</b>: Textbox - User input</h7>
                </div>

                <!------------------------>
                <!---  APPEARANCE     ---->
                <!------------------------>
                <h5 class="modal-heading" style="margin-top:35px;" id="settingsAppearanceHeader">Appearance</h5>
                <!-- COLOR MODE -->
                <a class="btn color-mode__btn btn-outline-light light--hidden" id="settingsLightModeButton"><img src="ucs_libraries/light-mode-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;Light Mode</a>
                <a class="btn color-mode__btn btn-outline-dark dark--hidden" id="settingsDarkModeButton"><img src="ucs_libraries/dark-mode-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;Dark Mode</a>
                
                <!------------------------>
                <!---  STORAGE        ---->
                <!------------------------>
                <h5 class="modal-heading" style="margin-top:35px;" id="settingsLinksHeader">Data Storage</h5>
                <div>
                    <h7>Allows you to backup and transfer all settings, language, presets, and history data.<br>- Exporting will download a file that can be used for backup and transfer.<br>- Importing will overwrite <b>ALL</b> local data on this PC.</h7><br><br>
                    <a class="btn btn-success" href="#" id="exportPresets" onClick="exportPresetStorage()" style="display: flex; align-items: center; width: 150px; margin-bottom: 10px;"><img class="icons filter-light" src="ucs_libraries/export-data-2.svg" alt="settings_icon">&nbsp;Export Data</a>
                    <label class="btn btn-info" style="display: flex; align-items: center; cursor: pointer; width: 150px;"><i class="fa fa-image"><img class="icons filter-light" src="ucs_libraries/import-data.svg" alt="settings_icon"></i>&nbsp;Import Data<input id="uploadedPresetFile" type="file" style="display: none;" name="image" accept=".txt"></label>                        
                </div>

                <!------------------------>
                <!---  LINKS          ---->
                <!------------------------>
                <h5 class="modal-heading" style="margin-top:35px;" id="settingsLinksHeader">External Links</h5>
                <!-- FEEDBACK -->
                <a href="https://forms.gle/DaVCaesTLcRLrJVt7" class="btn btn-outline-dark dark--hidden" target="_blank" id="settingsLightFdbk"><img src="ucs_libraries/dark-feedback-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;Feedback</a>
                <a href="https://forms.gle/DaVCaesTLcRLrJVt7" class="btn btn-outline-light light--hidden" target="_blank" id="settingsDarkFdbk"><img src="ucs_libraries/light-feedback-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;Feedback</a>
                <!-- UCS WEBSITE -->
                <a href="https://universalcategorysystem.com/" class="btn btn-outline-dark dark--hidden" target="_blank" style="margin-left:20px" id="settingsLightUCS"><img src="ucs_libraries/ucs_logo_white_on_black.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;UCS Website</a>
                <a href="https://universalcategorysystem.com/" class="btn btn-outline-light light--hidden" target="_blank" style="margin-left:20px" id=settingsDarkUCS><img src="ucs_libraries/ucs_logo_black_on_white.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;UCS Website</a>
              </div>
              <div class="modal-footer" id="settingsFooter">
                <p class="mr-auto">Developed by&nbsp;<a href="https://aaroncendan.me" target="_blank">Aaron Cendan</a>. Feel free to&nbsp;<a href="https://ko-fi.com/acendan_" target="_blank">buy me a coffee!</a></p>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </div>
        </div>
    </div>

    <!------------------------>
    <!---  PRESETS MODALS ---->
    <!------------------------>
    <!---  Save Preset    ---->
    <div class="modal fade" id="presetsModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="savePresetModalContent">
                <div class="modal-header">
                    <h3 style="margin:0;" class="modal-title">Save Current Settings</h4>
                </div>
                <div class="modal-body">
                    <label for="presetNameLabel">Preset Name</label>
                    <input type="text" class="form-control" id="presetName" aria-describedby="presetNameHelp" placeholder="Chihuahua Recordings">
                    <small id="presetNameHelp" class="form-text text-muted">- A preset named "Default" will load as soon as you open the tool<br>- Presets will collect ALL field info. <b>I recommend leaving Category, Subcategory, and Filename blank.</b><br>- Use the name of an existing preset to edit/overwrite it!</small>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" onClick="saveThisAsPreset()" data-dismiss="modal">Save</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <!---  Delete Preset ---->
    <div class="modal fade" id="deletePresetsModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="deletePresetModalContent">
                <div class="modal-header">
                    <h3 style="margin:0;" class="modal-title">Delete Preset</h4>
                </div>
                <div class="modal-body">
                    <label for="presetNameLabel">Preset To Delete...</label>
                    
                    <select id="deletePresetSelect" class="form-control">

                    </select>

                    <small class="form-text text-muted"><b>WARNING: </b>This is irreversible. There is no undo.</small>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onClick="deleteThisPreset()" data-dismiss="modal">Delete Preset</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  </div>
            </div>
        </div>
    </div>

    <!------------------------->
    <!---  AMBISONICS MODAL --->
    <!------------------------->
    <div class="modal fade" id="ambisonicsModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="ambisonicsModalContent">
                <div class="modal-header">
                    <h3 style="margin:0;" class="modal-title">Ambisonic Mic Configuration</h4>
                </div>
                <div class="modal-body">
                    <div>
                        <h7>Order</h7>
                        <select id="ambiModalOrder" class="form-control">
                            <option>-</option>
                            <option>First (FOA)</option>
                            <option>Second (2OA)</option>
                            <option>Third (3OA)</option>
                            <option>Fourth (4OA)</option>
                            <option>Fifth (5OA)</option>
                            <option>Sixth (6OA)</option>
                        </select>
                        <small id="ambiModalOrderHelp" class="form-text text-muted">What order ambisonic microphone?</small>
                    </div>
                    <div>
                        <h7>Format</h7>
                        <select id="ambiModalFormat" class="form-control">
                            <option>-</option>
                            <option>B-Format FuMa WXYZ (FUMA)</option>
                            <option>B-Format AmbiX WYZX (AMBIX)</option>
                            <option>A-Format (AFMT)</option>
                        </select>
                        <small id="ambiModalFormatHelp" class="form-text text-muted">What format are you rendering to/storing?</small>
                    </div>
                    <div id="ambiModalOrientationDiv" style="display: none">
                        <h7>Orientation</h7>
                        <select id="ambiModalOrientation" class="form-control">
                            <option>-</option>
                            <option>Up-Fire (UF)</option>
                            <option>Down-Fire (DF)</option>
                            <option>End-Fire (EF)</option>
                        </select>
                        <small id="ambiModalOrientationHelp" class="form-text text-muted">What orientation is your microphone? <b>Only relevant for A-Format.</b></small>
                    </div>    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" onClick="setAmbiConfig()" data-dismiss="modal">Confirm</button>
                    <button type="button" class="btn btn-secondary" onClick="doubleCheckAmbiConfig()" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!------------------------>
    <!---  ASWG MODALS    ---->
    <!------------------------>
    <!---  ASWG Info ---->
    <div class="modal fade ASWGInfoModal" id="ASWGInfoModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content" id="ASWGInfoModalContent">
                <div class="modal-header">
                    <h3 style="margin:0;" class="modal-title">Sony ASWG - General</h3>
                </div>
                <div class="modal-body"> 
                    <form id="ASWGInfoForm">
                        <div id="ASWGInfoFormError" style="display: none; margin:0;" class="alert alert-danger" role="alert">Invalid field found! Please double check this form.</div>
                        <h4 style="margin:0;" class="modal-title">Info & Format</h4>
                        <div class="form-row">                            
                            <!-- Project -->
                            <div class="form-group col-md-4">
                                <h7>Project</h7>
                                <br><input type="text" class="form-control" id="ASWGproject" aria-describedby="ASWGprojectHelp" placeholder="Int#">
                                <small id="ASWGprojectHelp" class="form-text text-muted">Project name asset was developed for.</small>
                            </div>

                            <!-- Originator Studio -->
                            <div class="form-group col-md-4">
                                <h7>Originator Studio</h7>
                                <br><input type="text" class="form-control" id="ASWGoriginatorStudio" aria-describedby="ASWGoriginatorStudioHelp" placeholder="Santa Monica Studio (SMS)">
                                <small id="ASWGoriginatorStudioHelp" class="form-text text-muted">Group or studio of originator.</small>
                            </div>

                            <!-- State -->
                            <div class="form-group col-md-4">
                                <h7>State</h7>
                                <select id="ASWGstate" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>Mastered</option>
                                    <option>Processed</option>
                                    <option>Raw</option>
                                    <option>Placeholder</option>
                                </select>
                                <small id="ASWGstateHelp" class="form-text text-muted">File version.</small>
                            </div> 

                            <!-- Editor -->
                            <div class="form-group col-md-4">
                                <h7>Editor</h7>
                                <br><input type="text" class="form-control" id="ASWGeditor" aria-describedby="ASWGeditorHelp" placeholder="">
                                <small id="ASWGeditorHelp" class="form-text text-muted">Name of editor.</small>
                            </div>

                            <!-- Mixer -->
                            <div class="form-group col-md-4">
                                <h7>Mixer</h7>
                                <br><input type="text" class="form-control" id="ASWGmixer" aria-describedby="ASWGmixerHelp" placeholder="">
                                <small id="ASWGmixerHelp" class="form-text text-muted">Name of mix engineer.</small>
                            </div>

                            <!-- FX Chain -->
                            <div class="form-group col-md-4">
                                <h7>FX Chain Name</h7>
                                <br><input type="text" class="form-control" id="ASWGfxChainName" aria-describedby="ASWGfxChainNameHelp" placeholder="">
                                <small id="ASWGfxChainNameHelp" class="form-text text-muted">Name of any FX Chain (.RfxChain) used.</small>
                            </div>

                            <!-- Channel Config -->
                            <div class="form-group col-md-4">
                                <h7>Channel Configuration</h7>
                                <select id="ASWGchannelConfig" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>Mono</option>
                                    <option>Stereo</option>
                                    <option>LCR</option>
                                    <option>Quad</option>
                                    <option>5.0</option>
                                    <option>5.1</option>
                                    <option>7.0</option>
                                    <option>7.1</option>
                                    <option>12.2</option>
                                    <option>Ambisonic</option>
                                </select>
                                <small id="ASWGchannelConfigHelp" class="form-text text-muted">Channel configuration of the file.</small>
                            </div> 

                            <!-- Ambisonic Format -->
                            <div class="form-group col-md-4" id="ASWGambisonicFormatSection" style="display:none">
                                <h7>Ambisonic Order Format</h7>
                                <br><input type="text" class="form-control" id="ASWGambisonicFormat" aria-describedby="ASWGambisonicFormatHelp" placeholder="Format: #h#v, #h#p, #p" pattern="\s*|[0-9]p|[0-9]h[0-9]p|[0-9]h[0-9]v">
                                <small id="ASWGambisonicFormatHelp" class="form-text text-muted">Refer to <a href="https://ambisonics.iem.at/symposium2009/proceedings/ambisym09-travis-newmixedorder.pdf/view" target="_blank">Travis (2009)</a> for scheme.</small>
                            </div>

                            <!-- Ambisonic Chn Order -->
                            <div class="form-group col-md-4" id="ASWGambisonicChnOrderSection" style="display:none">
                                <h7>Ambisonic Channel Order</h7>
                                <select id="ASWGambisonicChnOrder" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>FUMA</option>
                                    <option>ACN</option>
                                </select>
                                <small id="ASWGambisonicChnOrderHelp" class="form-text text-muted"></small>
                            </div> 

                            <!-- Ambisonic Normalization -->
                            <div class="form-group col-md-4" id="ASWGambisonicNormSection" style="display:none">
                                <h7>Ambisonic Normalization</h7>
                                <select id="ASWGambisonicNorm" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>SND3</option>
                                    <option>MAXN</option>
                                    <option>N3D</option>
                                </select>
                                <small id="ASWGambisonicNormHelp" class="form-text text-muted"></small>
                            </div> 

                            <!-- Notes -->
                            <div class="form-group col-md-9">
                                <h7>Notes</h7>
                                <textarea class="form-control" id="ASWGnotes" rows="3"></textarea>
                                <small id="ASWGnotesHelp" class="form-text text-muted">General information not covered in other fields.</small>
                            </div>
                        </div>
                        
                        <!-- Recording -->
                        <h4 style="margin:0;" class="modal-title">Recording</h4>
                        <div class="form-row">                        
                            <!-- Designed -->
                            <div class="form-group col-md-4">
                                <h7>Designed?</h7>
                                <select id="ASWGisDesigned" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisDesignedHelp" class="form-text text-muted">Whether designed (True) or raw (False).</small>
                            </div> 

                            <!-- Rec Engineer -->
                            <div class="form-group col-md-4">
                                <h7>Recording Engineer</h7>
                                <br><input type="text" class="form-control" id="ASWGrecEngineer" aria-describedby="ASWGrecEngineerHelp" placeholder="">
                                <small id="ASWGrecEngineerHelp" class="form-text text-muted">Name of recording engineer.</small>
                            </div>

                            <!-- Rec Studio -->
                            <div class="form-group col-md-4">
                                <h7>Recording Studio</h7>
                                <br><input type="text" class="form-control" id="ASWGrecStudio" aria-describedby="ASWGrecStudioHelp" placeholder="">
                                <small id="ASWGrecStudioHelp" class="form-text text-muted">Name of recording studio.</small>
                            </div>

                            <!-- Impulse Location -->
                            <div class="form-group col-lg-9" id="ASWGimpulseLocationSection" >
                                <h7>Impulse (IR) Location</h7>
                                <br><input type="text" class="form-control" id="ASWGimpulseLocation" aria-describedby="ASWGimpulseLocationHelp" placeholder="Grand Canyon National Park, Desert View Watchtower">
                                <small id="ASWGimpulseLocationHelp" class="form-text text-muted">Specific location of recorded impulse.</small>
                            </div>

                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!---  ASWG SFX ---->
    <div class="modal fade ASWGSFXModal" id="ASWGSFXModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content" id="ASWGSFXModalContent">
                <div class="modal-header">
                    <h3 style="margin:0;" class="modal-title">Sony ASWG - Sound Effects (SFX)</h4>
                </div>
                <div class="modal-body">
                    <form id="ASWGSFXForm">
                        <h4 style="margin:0;" class="modal-title">Info & Format</h4>
                        <div class="form-row">                            
                            

                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!---  ASWG Dialogue ---->
    <div class="modal fade ASWGDialogueModal" id="ASWGDialogueModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content" id="ASWGDialogueContent">
                <div class="modal-header">
                    <h3 style="margin:0;" class="modal-title">Sony ASWG - Dialogue</h4>
                </div>
                <div class="modal-body">
                    <form id="ASWGDialogueForm">
                        <div id="ASWGDialogueFormError" style="display: none; margin:0;" class="alert alert-danger" role="alert">Invalid field found! Please double check this form.</div>
                        <h4 style="margin:0;" class="modal-title">Info & Format</h4>
                        <div class="form-row">                            
                            <!-- Text Transcript-->
                            <div class="form-group col-md-9">
                                <h7>Text Transcript</h7>
                                <textarea class="form-control" id="ASWGtext" rows="2"></textarea>
                                <small id="ASWGtextHelp" class="form-text text-muted">Transcript of the dialogue file.</small>
                            </div>

                            <!-- Language -->
                            <div class="form-group col-lg-9">
                                <h7>Language</h7>
                                <select id="ASWGlanguage" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>ab - Abkhazian</option>
                                    <option>aa - Afar</option>
                                    <option>af - Afrikaans</option>
                                    <option>ak - Akan</option>
                                    <option>sq - Albanian</option>
                                    <option>am - Amharic</option>
                                    <option>ar - Arabic</option>
                                    <option>an - Aragonese</option>
                                    <option>hy - Armenian</option>
                                    <option>as - Assamese</option>
                                    <option>av - Avaric</option>
                                    <option>ae - Avestan</option>
                                    <option>ay - Aymara</option>
                                    <option>az - Azerbaijani</option>
                                    <option>bm - Bambara</option>
                                    <option>ba - Bashkir</option>
                                    <option>eu - Basque</option>
                                    <option>be - Belarusian</option>
                                    <option>bn - Bengali</option>
                                    <option>bi - Bislama</option>
                                    <option>bs - Bosnian</option>
                                    <option>br - Breton</option>
                                    <option>bg - Bulgarian</option>
                                    <option>my - Burmese</option>
                                    <option>ca - Catalan, Valencian</option>
                                    <option>ch - Chamorro</option>
                                    <option>ce - Chechen</option>
                                    <option>ny - Chichewa, Chewa, Nyanja</option>
                                    <option>zh - Chinese</option>
                                    <option>cv - Chuvash</option>
                                    <option>kw - Cornish</option>
                                    <option>co - Corsican</option>
                                    <option>cr - Cree</option>
                                    <option>hr - Croatian</option>
                                    <option>cs - Czech</option>
                                    <option>da - Danish</option>
                                    <option>dv - Divehi, Dhivehi, Maldivian</option>
                                    <option>nl - Dutch, Flemish</option>
                                    <option>dz - Dzongkha</option>
                                    <option>en - English</option>
                                    <option>eo - Esperanto</option>
                                    <option>et - Estonian</option>
                                    <option>ee - Ewe</option>
                                    <option>fo - Faroese</option>
                                    <option>fj - Fijian</option>
                                    <option>fi - Finnish</option>
                                    <option>fr - French</option>
                                    <option>ff - Fulah</option>
                                    <option>gl - Galician</option>
                                    <option>ka - Georgian</option>
                                    <option>de - German</option>
                                    <option>el - Greek, Modern (1453-)</option>
                                    <option>gn - Guarani</option>
                                    <option>gu - Gujarati</option>
                                    <option>ht - Haitian, Haitian Creole</option>
                                    <option>ha - Hausa</option>
                                    <option>he - Hebrew</option>
                                    <option>hz - Herero</option>
                                    <option>hi - Hindi</option>
                                    <option>ho - Hiri Motu</option>
                                    <option>hu - Hungarian</option>
                                    <option>ia - Interlingua (International Auxiliary Language Association)</option>
                                    <option>id - Indonesian</option>
                                    <option>ie - Interlingue, Occidental</option>
                                    <option>ga - Irish</option>
                                    <option>ig - Igbo</option>
                                    <option>ik - Inupiaq</option>
                                    <option>io - Ido</option>
                                    <option>is - Icelandic</option>
                                    <option>it - Italian</option>
                                    <option>iu - Inuktitut</option>
                                    <option>ja - Japanese</option>
                                    <option>jv - Javanese</option>
                                    <option>kl - Kalaallisut, Greenlandic</option>
                                    <option>kn - Kannada</option>
                                    <option>kr - Kanuri</option>
                                    <option>ks - Kashmiri</option>
                                    <option>kk - Kazakh</option>
                                    <option>km - Central Khmer</option>
                                    <option>ki - Kikuyu, Gikuyu</option>
                                    <option>rw - Kinyarwanda</option>
                                    <option>ky - Kirghiz, Kyrgyz</option>
                                    <option>kv - Komi</option>
                                    <option>kg - Kongo</option>
                                    <option>ko - Korean</option>
                                    <option>ku - Kurdish</option>
                                    <option>kj - Kuanyama, Kwanyama</option>
                                    <option>la - Latin</option>
                                    <option>lb - Luxembourgish, Letzeburgesch</option>
                                    <option>lg - Ganda</option>
                                    <option>li - Limburgan, Limburger, Limburgish</option>
                                    <option>ln - Lingala</option>
                                    <option>lo - Lao</option>
                                    <option>lt - Lithuanian</option>
                                    <option>lu - Luba-Katanga</option>
                                    <option>lv - Latvian</option>
                                    <option>gv - Manx</option>
                                    <option>mk - Macedonian</option>
                                    <option>mg - Malagasy</option>
                                    <option>ms - Malay</option>
                                    <option>ml - Malayalam</option>
                                    <option>mt - Maltese</option>
                                    <option>mi - Maori</option>
                                    <option>mr - Marathi</option>
                                    <option>mh - Marshallese</option>
                                    <option>mn - Mongolian</option>
                                    <option>na - Nauru</option>
                                    <option>nv - Navajo, Navaho</option>
                                    <option>nd - North Ndebele</option>
                                    <option>ne - Nepali</option>
                                    <option>ng - Ndonga</option>
                                    <option>nb - Norwegian Bokmål</option>
                                    <option>nn - Norwegian Nynorsk</option>
                                    <option>no - Norwegian</option>
                                    <option>ii - Sichuan Yi, Nuosu</option>
                                    <option>nr - South Ndebele</option>
                                    <option>oc - Occitan</option>
                                    <option>oj - Ojibwa</option>
                                    <option>cu - Church Slavic, Old Slavonic, Church Slavonic, Old Bulgarian, Old Church Slavonic</option>
                                    <option>om - Oromo</option>
                                    <option>or - Oriya</option>
                                    <option>os - Ossetian, Ossetic</option>
                                    <option>pa - Punjabi, Panjabi</option>
                                    <option>pi - Pali</option>
                                    <option>fa - Persian</option>
                                    <option>pl - Polish</option>
                                    <option>ps - Pashto, Pushto</option>
                                    <option>pt - Portuguese</option>
                                    <option>qu - Quechua</option>
                                    <option>rm - Romansh</option>
                                    <option>rn - Rundi</option>
                                    <option>ro - Romanian, Moldavian, Moldovan</option>
                                    <option>ru - Russian</option>
                                    <option>sa - Sanskrit</option>
                                    <option>sc - Sardinian</option>
                                    <option>sd - Sindhi</option>
                                    <option>se - Northern Sami</option>
                                    <option>sm - Samoan</option>
                                    <option>sg - Sango</option>
                                    <option>sr - Serbian</option>
                                    <option>gd - Gaelic, Scottish Gaelic</option>
                                    <option>sn - Shona</option>
                                    <option>si - Sinhala, Sinhalese</option>
                                    <option>sk - Slovak</option>
                                    <option>sl - Slovenian</option>
                                    <option>so - Somali</option>
                                    <option>st - Southern Sotho</option>
                                    <option>es - Spanish, Castilian</option>
                                    <option>su - Sundanese</option>
                                    <option>sw - Swahili</option>
                                    <option>ss - Swati</option>
                                    <option>sv - Swedish</option>
                                    <option>ta - Tamil</option>
                                    <option>te - Telugu</option>
                                    <option>tg - Tajik</option>
                                    <option>th - Thai</option>
                                    <option>ti - Tigrinya</option>
                                    <option>bo - Tibetan</option>
                                    <option>tk - Turkmen</option>
                                    <option>tl - Tagalog</option>
                                    <option>tn - Tswana</option>
                                    <option>to - Tonga (Tonga Islands)</option>
                                    <option>tr - Turkish</option>
                                    <option>ts - Tsonga</option>
                                    <option>tt - Tatar</option>
                                    <option>tw - Twi</option>
                                    <option>ty - Tahitian</option>
                                    <option>ug - Uighur, Uyghur</option>
                                    <option>uk - Ukrainian</option>
                                    <option>ur - Urdu</option>
                                    <option>uz - Uzbek</option>
                                    <option>ve - Venda</option>
                                    <option>vi - Vietnamese</option>
                                    <option>vo - Volapük</option>
                                    <option>wa - Walloon</option>
                                    <option>cy - Welsh</option>
                                    <option>wo - Wolof</option>
                                    <option>fy - Western Frisian</option>
                                    <option>xh - Xhosa</option>
                                    <option>yi - Yiddish</option>
                                    <option>yo - Yoruba</option>
                                    <option>za - Zhuang, Chuang</option>
                                    <option>zu - Zulu</option>
                                </select>
                                <small id="ASWGlanguageHelp" class="form-text text-muted"><a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">ISO639-1 Language Code.</a></small>
                            </div> 

                            <!-- Efforts -->
                            <div class="form-group col-md-4">
                                <h7>Contains Efforts</h7>
                                <select id="ASWGefforts" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                    <option>Mixed</option>
                                </select>
                                <small id="ASWGeffortsHelp" class="form-text text-muted">Efforts (True), Dialogue (False), or mixed.</small>
                            </div> 

                            <!-- Effort Type -->
                            <div class="form-group col-md-4">
                                <h7>Effort Type</h7>
                                <br><input type="text" class="form-control" id="ASWGeffortType" aria-describedby="ASWGeffortTypeHelp" placeholder="Strain, Pain">
                            </div>

                            <!-- Projection -->
                            <div class="form-group col-md-4">
                                <h7>Projection</h7>
                                <select id="ASWGprojection" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>1 - Whispered</option>
                                    <option>2 - To Self</option>
                                    <option>3 - Spoken</option>
                                    <option>4 - Projected</option>
                                    <option>5 - Shouted</option>
                                </select>
                                <small id="ASWGprojectionHelp" class="form-text text-muted">Dialogue projection level.</small>
                            </div> 

                            <!-- Timing Restriction -->
                            <div class="form-group col-md-4">
                                <h7>Timing Restriction</h7>
                                <select id="ASWGtimingRestriction" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>Wild</option>
                                    <option>Time-Sync</option>
                                    <option>Lip-Sync</option>
                                    <option>N/A</option>
                                </select>
                                <small id="ASWGtimingRestrictionHelp" class="form-text text-muted">Dialogue timing restriction.</small>
                            </div> 

                            <!-- FX Used -->
                            <div class="form-group col-md-4">
                                <h7>Effects Used</h7>
                                <br><input type="text" class="form-control" id="ASWGfxUsed" placeholder="Radio, Reverb">
                                <small id="ASWGfxUsedHelp" class="form-text text-muted">General description of any effects.</small>
                            </div>
                        </div>

                        <!-- Character & Actor-->
                        <h4 style="margin:0;" class="modal-title">Character & Actor</h4>
                        <div class="form-row">
                            <!-- Character Name -->
                            <div class="form-group col-md-4">
                                <h7>Character Name</h7>
                                <br><input type="text" class="form-control" id="ASWGcharacterName" placeholder="Atreus">
                            </div>

                            <!-- Character Gender -->
                            <div class="form-group col-md-4">
                                <h7>Character Gender/Sex</h7>
                                <select id="ASWGcharacterGender" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>Female</option>
                                    <option>Male</option>
                                    <option>Other</option>
                                    <option>Unknown</option>
                                </select>
                            </div>

                            <!-- Character Age -->
                            <div class="form-group col-md-4">
                                <h7>Character Age</h7>
                                <br><input type="text" class="form-control" id="ASWGcharacterAge" placeholder="12" pattern="[0-9]*">
                                <small id="ASWGcharacterAgeHelp" class="form-text text-muted">Integer value, in years.</small>
                            </div>
                            
                            <!-- Character Role -->
                            <div class="form-group col-md-4">
                                <h7>Character Role</h7>
                                <select id="ASWGcharacterRole" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>Significant</option>
                                    <option>Background</option>
                                </select>
                                <small id="ASWGcharacterRoleHelp" class="form-text text-muted">Main (Significant) or background.</small>
                            </div> 

                            <!-- Actor Name -->
                            <div class="form-group col-md-4">
                                <h7>Actor Name</h7>
                                <br><input type="text" class="form-control" id="ASWGactorName" placeholder="">
                            </div>

                            <!-- Actor Gender -->
                            <div class="form-group col-md-4">
                                <h7>Actor Gender/Sex</h7>
                                <select id="ASWGactorGender" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>Female</option>
                                    <option>Male</option>
                                    <option>Other</option>
                                    <option>Unknown</option>
                                </select>
                            </div>

                            <!-- Accent -->
                            <div class="form-group col-md-4">
                                <h7>Accent</h7>
                                <br><input type="text" class="form-control" id="ASWGaccent" placeholder="">
                                <small id="ASWGaccentHelp" class="form-text text-muted">Regional accent of the spoken dialogue.</small>
                            </div>
                            
                            <!-- Emotion -->
                            <div class="form-group col-md-4">
                                <h7>Emotion</h7>
                                <br><input type="text" class="form-control" id="ASWGemotion" placeholder="">
                                <small id="ASWGemotionHelp" class="form-text text-muted">Emotional content in delivery.</small>
                            </div>
                        </div>

                        <!-- Direction & Usage -->
                        <h4 style="margin:0;" class="modal-title">Direction & Usage</h4>
                        <div class="form-row">
                            <!-- Director -->
                            <div class="form-group col-md-4">
                                <h7>Director</h7>
                                <br><input type="text" class="form-control" id="ASWGdirector" placeholder="">
                                <small id="ASWGdirectorHelp" class="form-text text-muted">Name of dialogue director.</small>
                            </div>

                            <!-- Direction -->
                            <div class="form-group col-md-4">
                                <h7>Direction Notes</h7>
                                <br><input type="text" class="form-control" id="ASWGdirection" placeholder="">
                                <small id="ASWGdirectionHelp" class="form-text text-muted">Dialogue notes, for context.</small>
                            </div>
                            
                            <!-- Usage Rights -->
                            <div class="form-group col-md-4">
                                <h7>Usage Rights</h7>
                                <br><input type="text" class="form-control" id="ASWGusageRights" placeholder="">
                                <small id="ASWGusageRightsHelp" class="form-text text-muted">Internal code denoting usage rights.</small>
                            </div>

                            <!-- Union -->
                            <div class="form-group col-md-4">
                                <h7>Union</h7>
                                <select id="ASWGisUnion" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisUnionHelp" class="form-text text-muted">Whether asset recorded under union contract.</small>
                            </div>                           
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!---  ASWG Music ---->
    <div class="modal fade ASWGMusicModal" id="ASWGMusicModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content" id="ASWGMusicModalContent">
                <div class="modal-header">
                    <h3 style="margin:0;" class="modal-title">Sony ASWG - Music</h4>
                </div>
                <div class="modal-body">
                    <form id="ASWGMusicForm">
                        <div id="ASWGMusicFormError" style="display: none; margin:0;" class="alert alert-danger" role="alert">Invalid field found! Please double check this form.</div>
                        <h4 style="margin:0;" class="modal-title">Info</h4>
                        <div class="form-row">                            
                            <!-- Composer -->
                            <div class="form-group col-md-4">
                                <h7>Composer</h7>
                                <br><input type="text" class="form-control" id="ASWGcomposer" placeholder="">
                            </div>

                            <!-- Artist -->
                            <div class="form-group col-md-4">
                                <h7>Artist</h7>
                                <br><input type="text" class="form-control" id="ASWGartist" placeholder="">
                            </div>

                            <!-- Song Title -->
                            <div class="form-group col-md-4">
                                <h7>Song Title</h7>
                                <br><input type="text" class="form-control" id="ASWGsongTitle" placeholder="">
                            </div>

                            <!-- Producer -->
                            <div class="form-group col-md-4">
                                <h7>Producer</h7>
                                <br><input type="text" class="form-control" id="ASWGproducer" placeholder="">
                            </div>

                            <!-- Genre -->
                            <div class="form-group col-md-4">
                                <h7>Genre</h7>
                                <br><input type="text" class="form-control" id="ASWGgenre" placeholder="">
                            </div>
                            
                            <!-- Sub Genre -->
                            <div class="form-group col-md-4">
                                <h7>Sub-Genre</h7>
                                <br><input type="text" class="form-control" id="ASWGsubGenre" placeholder="">
                            </div>
                                                                                    
                            <!-- Instrument -->
                            <div class="form-group col-md-4">
                                <h7>Instrument</h7>
                                <br><input type="text" class="form-control" id="ASWGinstrument" placeholder="">
                            </div> 
                            
                            <!-- Intensity -->
                            <div class="form-group col-md-4">
                                <h7>Intensity</h7>
                                <br><input type="text" class="form-control" id="ASWGintensity" placeholder="">
                            </div>   
                            
                            <!-- Tempo -->
                            <div class="form-group col-md-4">
                                <h7>Tempo</h7>
                                <br><input type="text" class="form-control" id="ASWGtempo" aria-describedby="ASWGtempoHelp" placeholder="Format: 128, 144, 106" pattern="(,\s*|[0-9]*)*">
                                <small id="ASWGtempoHelp" class="form-text text-muted">Tempo(s), in BPM.</small>
                            </div> 

                            <!-- Time Signature -->
                            <div class="form-group col-md-4">
                                <h7>Time Signature</h7>
                                <br><input type="text" class="form-control" id="ASWGtimeSig" aria-describedby="ASWGtimeSigHelp" placeholder="Format: 3:4, 4:4, 6:8" pattern="(,\s*|[0-9]*:[0-9]*)*">
                                <small id="ASWGtimeSigHelp" class="form-text text-muted">Time signature(s), in X:Y.</small>
                            </div> 

                            <!-- Key -->
                            <div class="form-group col-md-4">
                                <h7>Key</h7>
                                <br><input type="text" class="form-control" id="ASWGinKey" aria-describedby="ASWGinKeyHelp" placeholder="A#m, D">
                                <small id="ASWGinKeyHelp" class="form-text text-muted">Key(s)</small>
                            </div> 

                            <!-- Rights Owner -->
                            <div class="form-group col-md-4">
                                <h7>Rights Owner</h7>
                                <br><input type="text" class="form-control" id="ASWGrightsOwner" aria-describedby="ASWGrightsOwnerHelp" placeholder="">
                                <small id="ASWGrightsOwnerHelp" class="form-text text-muted">Owner of the recorded work.</small>
                            </div>
                            
                            <!-- Music Supervisor -->
                            <div class="form-group col-md-4">
                                <h7>Music Supervisor</h7>
                                <br><input type="text" class="form-control" id="ASWGmusicSup" placeholder="">
                            </div>

                            <!-- Music Publisher -->
                            <div class="form-group col-md-4">
                                <h7>Music Publisher</h7>
                                <br><input type="text" class="form-control" id="ASWGmusicPublisher" placeholder="">
                            </div>
                        </div>

                        <!-- Format -->
                        <h4 style="margin:0;" class="modal-title">Format - True/False</h4>
                        <div class="form-row">
                            <!-- Source -->
                            <div class="form-group col-md-4">
                                <h7>Source</h7>
                                <select id="ASWGisSource" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisSourceHelp" class="form-text text-muted">Source (True) or edit/other (False).</small>
                            </div>   

                            <!-- Loop -->
                            <div class="form-group col-md-4">
                                <h7>Loop</h7>
                                <select id="ASWGisLoop" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisLoopHelp" class="form-text text-muted">Seamlessly loopable?</small>
                            </div>  

                            <!-- Final -->
                            <div class="form-group col-md-4">
                                <h7>Final</h7>
                                <select id="ASWGisFinal" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisFinalHelp" class="form-text text-muted">Final (True) or temp/other (False).</small>
                            </div>  

                            <!-- OST -->
                            <div class="form-group col-md-4">
                                <h7>OST</h7>
                                <select id="ASWGisOst" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisOstHelp" class="form-text text-muted">Part of original soundtrack?</small>
                            </div>  

                            <!-- Cinematic -->
                            <div class="form-group col-md-4">
                                <h7>Cinematic</h7>
                                <select id="ASWGisCinematic" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisCinematicHelp" class="form-text text-muted">Associated with a cinematic?</small>
                            </div>  

                            <!-- Diegetic -->
                            <div class="form-group col-md-4">
                                <h7>Diegetic</h7>
                                <select id="ASWGisDiegetic" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisDiegeticHelp" class="form-text text-muted">Used diegetically?</small>
                            </div>  

                            <!-- Licensed -->
                            <div class="form-group col-md-4">
                                <h7>Licensed</h7>
                                <select id="ASWGisLicensed" class="form-control" style="margin:0px;">
                                    <option>-</option>
                                    <option>True</option>
                                    <option>False</option>
                                </select>
                                <small id="ASWGisLicensedHelp" class="form-text text-muted">Licensed from a third party?</small>
                            </div>                            
                        </div>

                        <!-- Cataloguing -->
                        <h4 style="margin:0;" class="modal-title">Cataloguing</h4>
                        <div class="form-row">
                            <!-- Order Reference -->
                            <div class="form-group col-md-4">
                                <h7>Order Reference</h7>
                                <br><input type="text" class="form-control" id="ASWGorderRef" aria-describedby="ASWGorderRefHelp" placeholder="">
                                <small id="ASWGorderRefHelp" class="form-text text-muted">Internal cue order, if applicable.</small>
                            </div>  

                            <!-- Music Version -->
                            <div class="form-group col-md-4">
                                <h7>Music Version</h7>
                                <br><input type="text" class="form-control" id="ASWGmusicVersion" aria-describedby="ASWGmusicVersionHelp" placeholder="">
                                <small id="ASWGmusicVersionHelp" class="form-text text-muted">Internal version number.</small>
                            </div> 

                            <!-- ISRC Code -->
                            <div class="form-group col-md-4">
                                <h7>ISRC Code</h7>
                                <br><input type="text" class="form-control" id="ASWGisrcId" aria-describedby="ASWGisrcIdHelp" placeholder="">
                                <small id="ASWGisrcIdHelp" class="form-text text-muted"><a href="https://www.usisrc.org/" target="_blank">ISRC Code.</a></small>
                            </div> 

                            <!-- Billing Code -->
                            <div class="form-group col-md-4">
                                <h7>Billing Code</h7>
                                <br><input type="text" class="form-control" id="ASWGbillingCode" aria-describedby="ASWGbillingCodeHelp" placeholder="">
                                <small id="ASWGbillingCodeHelp" class="form-text text-muted">Internal project billing code.</small>
                            </div> 
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <!------------------------>
    <!--- ROW CLICK ALERT ---->
    <!------------------------>
    <div class="alert alert-success notification float-right copy-alert" style="position: fixed; z-index:100;" role="alert" id="copiedRowAlert">
        Copied data to form!
    </div>
    <div class="alert alert-danger notification float-right copy-alert" style="position: fixed; z-index:100;" role="alert" id="dangerAlert">
    </div>

    <div class="main_wrap">
        <!------------------------>
        <!-- Renaming Tool Form -->
        <!------------------------>
        <form id="ucsForm">
            <!-- NAMING SECTION -->
            <div style="margin-top:40px;"><h5 id="naming"><i>Naming</i></h5></div>

            <div class="form-row" id="namingFormRow">
                <!-- Category -->
                <div class="form-group col-md-6 required" id="typeaheadCategory">
                    <label for="userInputCategoryLabel">Category*</label>
                    <br><input type="text" class="form-control typeahead" id="userInputCategory" aria-describedby="userInputCategoryHelp" placeholder="What kind of sound is this?" required>
                    <div id="userInputCategoryError" style="display: none; margin:0;" class="alert alert-warning" role="alert">No valid CatID found. Please check your Category & Subcategory selections!</div>
                    <small id="userInputCategoryHelp" class="form-text text-muted">Start typing to auto-fill category.</small>
                </div>

                <!-- Subcategory -->
                <div class="form-group col-md-6 required" id="typeaheadSubcategory">
                    <label for="userInputSubCategoryLabel">Subcategory*</label>
                    <select class="form-control" id="userSelectSubCategory" required><option>Please select a category!</option></select>
                    <small id="userInputSubCategoryHelp" class="form-text text-muted">Subcategory dropdown will fill with options when Category is selected. "-" if no subcategory needed.</small>
                </div>

                <!-- User Category -->
                <div class="form-group col-md-6" id="userCategoryGroup">
                    <label for="userInputUserCatLabel">User Category</label>
                    <input type="text" class="form-control" id="userInputUserCat" aria-describedby="userInputUserCatHelp" placeholder="Optional User Category">
                    <small id="userInputUserCatHelp" class="form-text text-muted">If no User Category, leave blank.</small>
                </div>

                <!-- Vendor Category -->
                <div class="form-group col-md-6" id="vendorCategoryGroup">
                    <label for="userInputVendCatLabel">Vendor Category</label>
                    <input type="text" class="form-control" id="userInputVendCat" aria-describedby="userInputVendCatHelp" placeholder="Optional Vendor Category">
                    <small id="userInputVendCatHelp" class="form-text text-muted">If you are not a library vendor, leave blank.</small>
                </div>

                <!-- Name w Var ID -->
                <div class="form-group col-md-6 required" id="fileNameGroup">
                    <label id="fileNameLabelText" for="userInputNameLabel">File Name*</label>
                    <input type="text" class="form-control" id="userInputName" aria-describedby="userInputNameHelp" placeholder="Name your items using spaces (not underscores)." required pattern="(.|\s)*\S(.|\s)*">
                    <div id="userInputNameError" style="display: none; margin:0;" class="alert alert-warning" role="alert">File Name cannot be blank!</div>
                    <div id="varNumberingDiv" class="form-check" style="margin-left:0px">
                        <input class="form-check-input" type="checkbox" checked id="userInputVarNumCheckbox">
                        <h7>Enable variation numbering?</h7>
                    </div>                    
                    <small id="userInputNameHelp" class="form-text text-muted"><b>WILDCARDS: </b>$region, $regionnumber<br />- Available wildcards are dependent on 'Items to Rename' field in <i>Processing</i> below.</small>
                </div>

                <!-- Initials -->
                <div class="form-group col-md-6" id="initialsGroup">
                    <label for="userInputInitialsLabel">Creator ID*</label>
                    <input type="text" class="form-control" id="userInputInitials" aria-describedby="userInputInitialsHelp" placeholder="Identifiable User ID" required pattern=".{1,}">
                    <div id="userInitialsError" style="display: none; margin:0;" class="alert alert-warning" role="alert">Initials cannot be blank!</div>
                    <small id="userInputInitialsHelp" class="form-text text-muted">Aaron Cendan, ACendan, AaCe, AACE, etc.</small>
                </div>

                <!-- Show -->
                <div class="form-group col-md-6" id="showGroup">
                    <label for="userInputShowLabel">Source ID</label>
                    <input type="text" class="form-control" id="userInputShow" aria-describedby="userInputShowHelp" placeholder="Optional Project/Show ID">
                    <small id="userInputShowHelp" class="form-text text-muted">If none, leave blank; it will be replaced with "NONE" per the UCS guidelines.</small>
                </div>

                <!-- User Data -->
                <div class="form-group col-md-6">
                    <label id="userInputDataLabel" for="userDataLabel">User Data/Notes</label>
                    <input type="text" class="form-control" id="userInputData" aria-describedby="userInputDataHelp" placeholder="Optional Notes">
                    <small id="userInputDataHelp" class="form-text text-muted">If none, leave blank.</small>
                </div>

                <!-- GBX Mod - Suffix -->
                <div class="form-group col-md-6" id="gbxSuffixGroup" aria-hidden="true">
                    <label for="gbxSuffixLabel">GBX - Suffix*</label>
                    <select class="form-control" id="gbxSuffix">
                        <option>Raw/Source (SRC)</option>
                        <option>Processed (PRC)</option>
                        <option>Designed (DSN)</option>
                    </select>
                </div>
            </div>

            <!-- PROCESSING SECTION -->
            <div><h5 id="processing"><i>Processing</i></h5></div>
            <div class="form-row" id="processingFormRow">
                <div id="copyResultsWarning2" style="display: none;" class="alert alert-warning" role="alert">You currently have "Copy WITHOUT processing" enabled in the settings. Results will be copied to the clipboard, but nothing will be renamed in your session.</div>

                <!-- RENAME DROPDOWN - Rename Regions/Markers/Items/Tracks -->
                <div class="form-group col-md-6">
                    <h7>Items to Rename*</h7>
                    <select id="userInputItems" class="form-control">
                        <option>Regions</option>
                        <option>Markers</option>
                        <option>Media Items</option>
                        <option>NVK Folder Items</option>
                        <option>Tracks</option>
                    </select>
                    <small id="userInputCategoryHelp" class="form-text text-muted">What would you like to rename?</small>
                </div>
                <!-- AREA DROPDOWN - Time Selection/Full Project - Default to Regions options-->
                <div class="form-group col-md-6">
                    <h7>Search Area*</h7>
                    <select id="userInputArea" class="form-control">
                        <option>Selected Regions in Region Manager</option>
                        <option>Edit Cursor</option>
                        <option>Time Selection</option>
                        <option>Full Project</option>
                    </select>
                    <small id="userInputCategoryHelp" class="form-text text-muted">Select the area of the project you would like to affect.</small>
                </div>
            </div>

            <!-- METADATA SECTION -->
            <div id="metadataTitle">
                <h5><i>Metadata</i></h5>
                <small id="metadataTitleHelp" class="form-text text-muted"><b>WILDCARDS: </b>Text fields below support all of REAPER's native wildcards!<br />- Please refer to the <i>Wildcard Help</i> menu in REAPER's render window for details.<br />- Common: $project, $author, $track, $region, $item, $itemnotes, $marker, $parent, $user</small>                
            </div>
            <div class="form-row" id="metadataSection">
                
                <!-- Description -->
                <div class="form-group col-md-6" id="metaDescDiv">
                    <label for="userDataLabel">Description</label>
                    <input type="text" class="form-control" id="userInputMetaDesc" placeholder="Fully Detailed Description of File Contents">
                </div>

                <!-- Title -->
                <div class="form-group col-md-9 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;" id="metaTitleDiv">
                    <div class="form-group col-md-4" style="margin-left: 15px; margin-right: 15px;">
                        <label for="userDataLabel">Title</label>
                        <input type="text" class="form-control" id="userInputMetaTitle" placeholder="SHORT CATCHY TITLE">
                    </div>

                    <!-- Keywords -->
                    <div class="form-group col-md-4" style="margin-left: 0px">
                        <label for="userDataLabel">Keywords</label>
                        <input type="text" class="form-control" id="userInputMetaKeys" placeholder="Comma, Separated, Keywords, Tags">
                    </div>
                </div>
                
                <!-- Microphone -->
                <div class="form-group col-md-8 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;" id="metaMicDiv">
                    <div class="form-group col-md-3" style="margin-left: 15px; margin-right: 15px;">
                        <label for="userDataLabel">Designer</label>
                        <input type="text" class="form-control" id="userInputMetaDsgnr" placeholder="Aaron Cendan">
                    </div>                    
                    
                    <div class="form-group col-md-3" style="margin-left: 0px">
                        <label for="userDataLabel">Microphone</label>
                        <input type="text" class="form-control" id="userInputMetaMic" placeholder="Mini MS">
                        <!-- <small class="form-text text-muted">Supports multi mics, ex: SM57, 8040, Usi</small> -->
                    </div>
                    
                    <div class="form-group col-md-3" style="margin-left: 0px">
                        <label for="userDataLabel">Recording Medium</label>
                        <input type="text" class="form-control" id="userInputMetaRecMed" placeholder="Sound Devices MixPre3II">
                    </div>                                        
                </div>

                <!-- Microphone Perspective -->
                <div class="form-group col-md-8 custom-control-inline" style="margin-left: 0px;  margin-top: 0px; margin-bottom: 0px;">
                    <div class="form-group col-md-3" style="margin-left: 15px; margin-right: 15px;">
                        <label for="userDataLabel">Microphone Configuration</label>                        
                        <select id="userInputMetaConfig" class="form-control" style="margin-top: 0px;">
                            <option>-</option>
                            
                            <option disabled><i>Mono</i></option>
                            <option>Cardioid (CARD)</option>
                            <option>Supercardioid (SUPCARD)</option>
                            <option>Hypercardioid (HYPCARD)</option>
                            <option>Shotgun (SHOT)</option>
                            <option>Figure 8 (FIG8)</option>
                            <option>Omnidirectional (OMNI)</option>
                            
                            <option disabled></option>
                            <option disabled><i>Stereo</i></option>
                            <option>XY (XY)</option>
                            <option>ORTF (ORTF)</option>
                            <option>Spaced Pair (AB)</option>
                            <option>NOS (NOS)</option>
                            <option>DIN (DIN)</option>
                            <option>Blumlein (BLUM)</option>
                            <option>Binaural (BIN)</option>  
                                                        
                            <option disabled></option>
                            <option disabled><i>Mid-Side</i></option>
                            <option>Mid-Side Encoded (MS-RAW)</option>
                            <option>Mid-Side Decoded (MS-DCOD)</option>
                            <option>Double Mid-Side Encoded (DMS-RAW)</option>
                            <option>Double Mid-Side Decoded (DMS-DCOD)</option>

                            <option disabled></option>
                            <option disabled><i>Specialty</i></option>
                            <option>Left-Center-Right (LCR)</option>
                            <option>Left-Right-Center (LRC)</option>
                            <option>Quadraphonic (QUAD)</option>
                            <option>Contact (CNTCT)</option>  
                            <option>Hydrophone (HYDRO)</option>
                            <option>Electromagnetic (EMF)</option>
                            <option>Ultrasonic (ULTRA)</option>
                            <option>Infrasonic (INFRA)</option>
                            <option>Geophone (GEO)</option>
                            <option>Parabolic (PARA)</option>
                            <option>Jecklin (OSS)</option>
                            <option>SASS (SASS)</option>  
                            <option>Boundary (BOUND)</option>

                            <option disabled></option>
                            <option disabled><i>Ambisonics</i></option>
                            <option>Click to configure...</option>  
                            <option id="customAmbi"></option>                                           
                        </select>    
                    </div>                    
                    <div class="form-group col-md-3" style="margin-left: 0px">
                        <label for="userDataLabel" id="metaMicPerspLabel">Microphone Perspective</label>                        
                        <select id="userInputMetaPersp" class="form-control" style="margin-top: 0px;">
                            <option>-</option>
                            <option>Close Up (CU)</option>
                            <option>Medium (MED)</option>
                            <option>Distant (DST)</option>
                            <option>Direct (D/I)</option>
                            <option>Onboard (OB)</option>
                            <option>Various (VARI)</option>
                            <option disabled></option>
                            <option disabled><i>Specialty</i></option>   
                            <option>Contact (CNTCT)</option>
                            <option>Hydrophone (HYDRO)</option>
                            <option>Electromagnetic (EMF)</option>
                        </select>    
                    </div>
                    <div class="form-group col-md-3" style="margin-left: 0px;" id="metaIntExtDiv">
                        <label for="userDataLabel">Inside or Outside&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                        <select id="userInputMetaIntExt" class="form-control" style="margin-top: 0px;">
                            <option>-</option>
                            <option>Interior (INT)</option>
                            <option>Exterior (EXT)</option>
                        </select>
                    </div>
                </div>
                
                <!-- Designer/URL -->
                <div class="form-group col-md-8 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;" id="metaDsgnDiv">
                    <div class="form-group col-md-3" style="margin-left: 15px; margin-right: 15px;">
                        <label for="userDataLabel">Library</label>
                        <input type="text" class="form-control" id="userInputMetaLib" placeholder="Julibrary 2021">
                    </div>
                    
                    <div class="form-group col-md-3" style="margin-left: 0px">
                        <label for="userDataLabel">URL</label>
                        <input type="text" class="form-control" id="userInputMetaURL" placeholder="https://aaroncendan.me">
                    </div>

                    <div class="form-group col-md-3" style="margin-left: 0px">
                        <label for="userDataLabel">Manufacturer</label>
                        <input type="text" class="form-control" id="userInputMetaManufacturer" placeholder="ARC Sounds, Inc.">
                    </div>
                </div>

                <!-- Location -->
                <div class="form-group col-md-8 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;" id="metaLocDiv">
                    <!-- Country -->
                    <div class="form-group col-md-3" style="margin-left: 15px; margin-right: 15px;">
                        <label for="userDataLabel" style="margin-bottom: 0px;">Location</label>
                        <select name="country" class="form-control countries order-alpha" id="countryId">
                            <option value="">Select Country</option>
                        </select>
                        <small class="form-text text-muted">Country</small>
                    </div>

                    <!-- State -->
                    <div class="form-group col-md-3" style="margin-left: 0px; margin-top: 35px;">
                        <select name="state" class="form-control states order-alpha" id="stateId">
                            <option value="">Select State</option>
                        </select>
                        <small class="form-text text-muted">State</small>
                    </div>

                    <!-- City -->
                    <div class="form-group col-md-3" style="margin-left: 0px; margin-top: 35px;">
                        <select name="city" class="form-control cities order-alpha limit-pop-10000" id="cityId">
                            <option value="">Select City</option>
                        </select>
                        <small class="form-text text-muted">City</small>
                    </div>
                </div>

                <!-- Location - User Textbox Variant-->
                <div class="form-group col-md-9 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;" id="metaUserLocDiv">
                    <div class="form-group col-md-4" style="margin-left: 15px; margin-right: 15px;">
                        <label for="userDataLabel">Location</label>
                        <input type="text" class="form-control" id="userLocId" placeholder="Canada, British Columbia, Vancouver">
                        <small class="form-text text-muted">Country, State, City</small>
                    </div>
                </div>

                <!-- Notes -->
                <div class="form-group col-md-8 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;" id="metaUserNotesDiv">
                    <div class="form-group col-md-8" style="margin-left: 15px; margin-right: 15px;">
                        <label for="metaNotesLabel">Notes</label>
                        <textarea class="form-control" id="metaNotes" rows="3"></textarea>
                    </div>
                </div>

                <!-- Album Art -- DISABLED UNTIL MEDIA EXPLORER CAN SHOW ALBUM ART 
                <div class="form-group col-md-6">
                    <label class="form-label" for="customFile">Embed Artwork</label>
                    <input type="file" class="form-control" id="userInputMetaArt" aria-describedby="userInputMetaArtHelp"/>        
                    <small id="userInputMetaArtHelp" class="form-text text-muted">Supports drag-and-drop! Must be .jpg or .png</small>
                </div>
                -->
                
                <!-- ASWG -->
                <div style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;" id="ASWGSection">
                    <div class="form-group col-lg-9 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;">
                        <div class="form-group col-lg-9" style="margin-left: 15px; margin-right: 15px; margin-top: 10px; margin-bottom: 0px;">
                            <h6><i>Sony ASWG Scheme v1.00</i></h6>
                            <small id="ASWGTitleHelp" class="form-text text-muted">The Sony Playstation&reg; Studios' Audio Standards Working Group (ASWG) Specification</small> 
                        </div>                                                         
                    </div>
                    <!-- Content Type -->
                    <div class="form-group col-md-8 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;">
                        <div class="form-group col-md-4" style="margin-left: 15px;">
                            <h7>Content Type*</h7>
                            <select id="ASWGcontentType" class="form-control" style="margin-top:0; margin-bottom: 0px;" required>
                                <option>-</option>
                                <option>SFX</option>
                                <option>Dialogue</option>
                                <option>Music</option>

                                <option disabled data-divider="true"></option>
                                <option>Mixed</option>
                                <option>Haptic</option>
                                <option>Impulse (IR)</option>                                
                            </select>
                            <small id="ASWGcontentTypeHelp" class="form-text text-muted"></small>
                        </div> 
                    </div>
                    <div class="form-group col-lg-9 custom-control-inline" style="margin-left: 0px; margin-top: 0px; margin-bottom: 0px;">
                        <div class="form-group col-lg-9" style="margin-left: 15px; margin-right: 15px; margin-top: 0px; margin-bottom: 0px;">
                            <button id="ASWGInfoBtn" type="button" class="btn btn-outline-info" data-toggle="modal" data-target=".ASWGInfoModal" style="display:none"><img class="icons filter-info" src="ucs_libraries/info.svg" alt="info_icon">&nbsp;&nbsp;<b>ASWG - General</b></button>
                            <button id="ASWGSFXBtn" type="button" class="btn btn-outline-info" data-toggle="modal" data-target=".ASWGSFXModal" style="display:none"><img class="icons filter-info" src="ucs_libraries/sfx.svg" alt="sfx_icon">&nbsp;&nbsp;<b>ASWG - SFX</b></button>
                            <button id="ASWGDialogueBtn" type="button" class="btn btn-outline-info" data-toggle="modal" data-target=".ASWGDialogueModal" style="display:none"><img class="icons filter-info" src="ucs_libraries/dialogue.svg" alt="dialogue_icon">&nbsp;&nbsp;<b>ASWG - Dialogue</b></button> 
                            <button id="ASWGMusicBtn" type="button" class="btn btn-outline-info" data-toggle="modal" data-target=".ASWGMusicModal" style="display:none"><img class="icons filter-info" src="ucs_libraries/music2.svg" alt="music_icon">&nbsp;&nbsp;<b>ASWG - Music</b></button>                                                   
                        </div>
                    </div>   
                </div>             
            </div>  
            <!-- SUBMIT BUTTON - Web_Interface_Button_1_Test.lua -->
            <div style="margin-top: 30px;">
                <button id="formSubmitButton" type="button" class="btn btn-outline-primary"><img class="icons filter-blue" src="ucs_libraries/share.svg" alt="share_icon">&nbsp;&nbsp;<b>Submit</b></button>
            </div>
            <!-- PAGE DIVIDER -->
            <div><hr></div>
        </form>
        <!--------------->
        <!-- UCS Table -->
        <!--------------->
        <div>
            <h3 id="dataTable">Universal Category System Table</h3>
            <h6 id="UCSTableSubHeading">Google Sheets Data/Online Mode ~ UCS v8.2</h6>
            <!-- OFFLINE/ONLINE INFO - Displayed on load -->
            <h6 id="downloadUCSButtonText" style="display: none">Click here to download for offline use!</h6>
            <h6 id="reenableOnlineUCSButtonText" style="display: none">If you would like to re-enter 'Online Mode' using Google Sheets data, click here.</h6>
            <button id="downloadUCSButton" type="button" class="btn btn-outline-success" style="display: none; margin-top: 10px"><img class="icons filter-green" src="ucs_libraries/data-transfer-download.svg" alt="download_icon">&nbsp;&nbsp;<b>Download</b></button>
            <button id="onlineUCSButton" type="button" class="btn btn-outline-warning" style="display: none; margin-top: 10px"><img class="icons filter-yellow" src="ucs_libraries/wifi.svg" alt="wifi_icon">&nbsp;&nbsp;<b>Online</b></button>
            <div class="card border-dark w-75" id="UCSInstallInstructions" style="display: none">
                <div style="margin-top: 0px; margin-bottom: 0px; margin-right: 0px; margin-left: 0px;" class="card-body">
                    <h6 class="card-title">Offline Installation and Setup Instructions</h6>
                    <ul>
                        <li>
                            To enable offline mode, simply place the downloaded file "UCS.txt" in the appropriate directory:
                        </li>
                        <li>
                            Open the file path /REAPER/reaper_www_root (and verify that "acendan_Universal Category Renaming Tool Interface.html" is present).
                        </li>
                        <li>
                            Drag or copy the "UCS.txt" file into the folder /reaper_www_root and then reload this page.
                        </li>
                        <li>
                            You should see text above the UCS Table indicating that you are succesfully in Offline mode!
                        </li>
                    </ul>
                </div>
            </div>
            <div class="card border-dark w-75" id="UCSOnlineModeInstructions" style="display: none">
                <div style="margin-top: 0px; margin-bottom: 0px; margin-right: 0px; margin-left: 0px;" class="card-body">
                    <h6 class="card-title">Re-enable Online Mode Instructions</h6>
                    <ul>
                        <li>
                            To re-enable online mode, open the file path /REAPER/reaper_www_root.
                        </li>
                        <li>
                            You can either delete "UCS.txt", change its name to something along the lines of "UCS_backup.txt", or place it in a folder/elsewhere on your computer.
                        </li>
                        <li>
                            Reload this page and you should automatically enter Online mode, using Google Sheets data for the latest UCS info.
                        </li>
                    </ul>
                </div>
            </div>
            <div style="margin-bottom:0px;margin-top:25px;">
                <h7 id="ucsTableInstrLabel"><i>Search for an appropriate category then click on a row in the table to instantly fill out the form!</i></h7>                
            </div>
        </div>
        <table id="UCRTDataTable" class="table table-striped table-bordered table-hover table-responsive table-light" style="width:100%"></table>
        <div>
            <h7 id="haveAGreatDay" style="align-items:center;display:flex;justify-content:center;">Have a great day! :)</h7>
        </div>
    </div>
    <script>
        // Initialize connection w Reaper
        wwr_start();

        // ~~~~~~~~~~~~~~~~~~~~
        // GLOBAL VAR DECLARATION
        // ~~~~~~~~~~~~~~~~~~~~
        // Reaper-side Lua Script
        var UCSRTLua = "_RS0d2de1418a084e66229cb513cdb6e8cc99fc7593"; //ACendan Scripts/Various/UCS Renaming Tool.lua
        var UCSMediaFilter = "_RS15f4b156ba3f21ef8806a3c4c1f04ff621d48c9a"; //ACendan Scripts/Various/acendan_UCS Renaming Tool - Media Explorer Filter.lua
        var UCSSendToInterface = "_RS6500fc52057a6aeabf8f4ecabc5c2d3f91cc6062"; //ACendan Scripts/Various/acendan_UCS Renaming Tool - Send To Interface.lua
        var REApath = "40027"; // Open REAPER resource path

        // UCS Google Sheet Languages
        var ucs_gsheet_header = "https://spreadsheets.google.com/feeds/cells/10-IAYKOEpTMoDsv7m_oPZazPVY3HhhUS_hQeEjmK93c/";
        var ucs_gsheet_footer = "/public/full?alt=json";
        var ucs_gsheet_en = ucs_gsheet_header + "1" + ucs_gsheet_footer;
        var ucs_gsheet_fr = ucs_gsheet_header + "2" + ucs_gsheet_footer;
        var ucs_gsheet_pl = ucs_gsheet_header + "3" + ucs_gsheet_footer;
        var ucs_gsheet_de = ucs_gsheet_header + "4" + ucs_gsheet_footer;
        var ucs_gsheet_pt = ucs_gsheet_header + "5" + ucs_gsheet_footer;
        var ucs_gsheet_pt_br = ucs_gsheet_header + "6" + ucs_gsheet_footer;
        var ucs_gsheet_zh = ucs_gsheet_header + "7" + ucs_gsheet_footer;
        var ucs_gsheet_nl = ucs_gsheet_header + "8" + ucs_gsheet_footer;
        var ucs_gsheet_es = ucs_gsheet_header + "9" + ucs_gsheet_footer;
        var ucs_gsheet_ja = ucs_gsheet_header + "10" + ucs_gsheet_footer;
        var ucs_gsheet_it = ucs_gsheet_header + "11" + ucs_gsheet_footer;
        var ucs_gsheet_da = ucs_gsheet_header + "12" + ucs_gsheet_footer;
        var ucs_gsheet_fi = ucs_gsheet_header + "13" + ucs_gsheet_footer;
        var ucs_gsheet_tw = ucs_gsheet_header + "14" + ucs_gsheet_footer;
        var ucs_gsheet_no = ucs_gsheet_header + "15" + ucs_gsheet_footer;
        var ucs_gsheet_se = ucs_gsheet_header + "16" + ucs_gsheet_footer;
        var ucs_gsheet_ru = ucs_gsheet_header + "17" + ucs_gsheet_footer;
        var ucs_gsheet_ua = ucs_gsheet_header + "18" + ucs_gsheet_footer;
        var ucs_gsheet_tr = ucs_gsheet_header + "19" + ucs_gsheet_footer;
        var ucs_gsheet_kr = ucs_gsheet_header + "20" + ucs_gsheet_footer;
 
        // Arrays populated by Google Sheet public JSON
        // Cleaned up arrays for auto-filter
        var jsonFullTable = [];
        var jsonCategoryAutofill = [];
        var jsonSubcategoryAutofill = [];
        var jsonCategorySubcategoryArr = [];
        var jsonCatIDArr = [];

        // Init user preset array
        let userPresets = [];

        // Instructions toggle bool
        var onlineModeInstructionsToggle = true;

        // Reacall handler
        var reacallHandled = false;
        
        // Platform specific bools
        var isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || (typeof safari !== 'undefined' && safari.pushNotification));
        var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;

        // Cache load start time
        var startTime = new Date().valueOf();

        // Cache date getter
        var month = new Date().getMonth() + 1;
        var day = new Date().getDate();

        // ~~~~~~~~~~~~~~~~~~~~
        // ON PAGE LOAD
        // Determine Online or Offline Mode
        // ~~~~~~~~~~~~~~~~~~~~
        $(function () {
            // Alert Safari users of issues with browser            
            if (isSafari) alert("Safari does not play nicely with this tool. I am working to resolve these issues, but until then, please consider using Google Chrome. Thank you for your understanding!");

            // Remove selected regions in region manager option for mac users
            // https://forum.cockos.com/showpost.php?p=2337785&postcount=1326
            // if (isMac) $("#userInputArea option:contains('Selected Regions in Region Manager')").remove();

            // Get previous session settings from local storage
            recallSettings();

            // Assigns country icon for current language to navbar language dropdown
            getUCSLanguage();

            // Attempt to load offline "UCS.txt" file if available. If successful: useOfflineUSCData()
            // If not, get data from public Google sheet via function: useGSheetsUSCData()
            loadOfflineUCSDoc();

            // Check for User Presets
            loadUserPresets();

            // Check for User History
            loadUserHistory();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // CATCH ERROR IN LOADING COUNTRY STATE CITY API
        // ~~~~~~~~~~~~~~~~~~~~
        $.ajax({
            type: "POST",
            url: "http://geodata.solutions/api/api.php",
            success: function(msg){
                // Success
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                console.log("Error: Failed to load CountryStateCity API!");

                // Force manual input
                $("#locationInputSettings").prop('checked',true);
                $("#locInputHeader").hide();
                $("#locInputDiv").hide();
                $("#metaLocDiv").hide();
                $("#metaUserLocDiv").show();    
            }
        });
        
        // ~~~~~~~~~~~~~~~~~~~~
        // RECALL STORAGE SETTINGS
        // ~~~~~~~~~~~~~~~~~~~~
        function recallSettings() {
            // Set dark mode if previously set or sys pref
            if (localStorage.getItem("color-mode") === "dark" || (window.matchMedia("(prefers-color-scheme: dark)").matches && !localStorage.getItem("color-mode"))) enableDarkMode();

            // Get copy results setting
            if (localStorage.getItem("copy-setting")) {
                $("#copyResultsSetting").val(localStorage.getItem("copy-setting"));
                if (localStorage.getItem("copy-setting") == "Copy WITHOUT processing") {
                    $("#copyResultsWarning").show();
                    $("#copyResultsWarning2").show();
                } else {
                    $("#copyResultsWarning").hide();
                    $("#copyResultsWarning2").hide();
                }
            } else {
                $("#copyResultsWarning").hide();
                $("#copyResultsWarning2").hide();
            }

            // Get render metadata setting
            if (localStorage.getItem("ixml-setting")) {
                $("#iXMLSettings").prop('checked',true);
                $("#metadataWarning").show();
            } else {
                $("#iXMLSettings").prop('checked',false);
            }

            // Get render directory setting
            if (localStorage.getItem("directory-setting")) {
                $("#renderDirectorySettings").prop('checked',true);                
            } else {
                $("#renderDirectorySettings").prop('checked',false);      
            }

            // Get location preference settings
            if (localStorage.getItem("location-input-setting")) {
                $("#locationInputSettings").prop('checked',true);
                $("#metaLocDiv").hide();
                $("#metaUserLocDiv").show();                
            } else {
                $("#locationInputSettings").prop('checked',false);
                $("#metaLocDiv").show();
                $("#metaUserLocDiv").hide();
            }

            // Get marker position format setting
            if (localStorage.getItem("marker-pos-setting")) {
                $("#markerPositionSettings").prop('checked',true);
            } else {
                $("#markerPositionSettings").prop('checked',false);
            }

            // Get extended metadata setting
            if (localStorage.getItem("metadata-setting")) {
                $("#metadataSettings").prop('checked',true);
                $("#metadataWarning").show();
                $("#metadataTitle").show();
                $("#metadataSection").show();
                $("#metadataScroll").show();
            } else {
                $("#metadataSettings").prop('checked',false);
                $("#metadataTitle").hide();
                $("#metadataSection").hide();
                $("#metadataScroll").hide();
            }

            // Get ASWG metadata setting
            if (localStorage.getItem("aswg-setting")) {
                $("#ASWGSettings").prop('checked',true);
                $("#ASWGSection").show();
            } else {
                $("#ASWGSettings").prop('checked',false);
                $("#ASWGSection").hide();
            }

            // Get vendor cat setting
            if (localStorage.getItem("vendor-cat-setting")) {
                $("#vendorCatCheckbox").prop('checked',true);
                $("#vendorCategoryGroup").show();
            } else {
                $("#vendorCatCheckbox").prop('checked',false);
                $("#vendorCategoryGroup").hide();
            }

            // Hide metadata warning
            if (!localStorage.getItem("ixml-setting") && !localStorage.getItem("metadata-setting")) {
                $("#metadataWarning").hide();
            }

            // Get name/source capitalization settings
            if (localStorage.getItem("caps-setting")) {
                $("#nameCapitalizationSetting").val(localStorage.getItem("caps-setting"));
            }

            // Get filename formatting settings
            if (localStorage.getItem("fx-format-setting")) {
                $("#fxFormattingSetting").val(localStorage.getItem("fx-format-setting"));
            }

            // GBX Mod
            if (localStorage.getItem("gbx-mod")) {
                GBXMod();
            } else {
                $("#gbxSuffixGroup").hide();
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // DROP-DOWN AUTOFILL
        // ~~~~~~~~~~~~~~~~~~~~
        var substringMatcher = function (strs) {
            return function findMatches(q, cb) {
                var matches, substringRegex;

                // an array that will be populated with substring matches
                matches = [];

                // regex used to determine if a string contains the substring `q`
                substrRegex = new RegExp(q, 'i');

                // iterate through the pool of strings and for any string that
                // contains the substring `q`, add it to the `matches` array
                $.each(strs, function (i, str) {
                    if (substrRegex.test(str)) {
                        matches.push(str);
                    }
                });

                cb(matches);
            };
        };

        // ~~~~~~~~~~~~~~~~~~~~
        // CATEGORY AUTOFILL INIT
        // ~~~~~~~~~~~~~~~~~~~~
        $('#typeaheadCategory .typeahead').typeahead({
            hint: true,
            highlight: true
        },
            {
                name: 'jsonCategoryAutofill',
                source: substringMatcher(jsonCategoryAutofill)
            });

        // ~~~~~~~~~~~~~~~~~~~~
        //   LIGHT / DARK MODE
        // ~~~~~~~~~~~~~~~~~~~~
        const toggleColorMode = e => {
            /* ENABLE LIGHT MODE */
            if (e.currentTarget.classList.contains("light--hidden")) {
                enableLightMode();
                return;
            }

            /* ENABLE DARK MODE */
            enableDarkMode();
        }

        const toggleColorButtons = document.querySelectorAll(".color-mode__btn");
        toggleColorButtons.forEach(btn => {
            btn.addEventListener("click", toggleColorMode);
        });

        function enableDarkMode() {
            document.documentElement.setAttribute("color-mode","dark");
            localStorage.setItem("color-mode","dark");

            $("#UCRTDataTable").removeClass("table-light");
            $("#UCRTDataTable").addClass("table-dark");

            $("#ucsNavbar").removeClass("navbar-light");
            $("#ucsNavbar").addClass("navbar-dark");

            $("#UCSInstallInstructions").removeClass("border-dark");
            $("#UCSInstallInstructions").addClass("border-light");

            $("#UCSOnlineModeInstructions").removeClass("border-dark");
            $("#UCSOnlineModeInstructions").addClass("border-light");
        }

        function enableLightMode() {
            document.documentElement.setAttribute("color-mode","light");
            localStorage.setItem("color-mode","light");
            
            $("#UCRTDataTable").removeClass("table-dark");
            $("#UCRTDataTable").addClass("table-light");

            $("#ucsNavbar").removeClass("navbar-dark");
            $("#ucsNavbar").addClass("navbar-light");

            $("#UCSInstallInstructions").removeClass("border-light");
            $("#UCSInstallInstructions").addClass("border-dark");

            $("#UCSOnlineModeInstructions").removeClass("border-light");
            $("#UCSOnlineModeInstructions").addClass("border-dark");
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // SUBMIT BUTTON & LUA TRIGGER
        // ~~~~~~~~~~~~~~~~~~~~
        // FORMAT: CatID_File Name with Variation Number_Initials_(Show)
        // NEW FORMAT: CatID(-UserCategory)_(VendorCategory-)File Name with Variation Number_Initials_(Show)
        $("#formSubmitButton").click(function (e) {
            // Check for wildcard/search type mismatch
            wildcardCleanup();

            // Process user input
            var selectedCategory = $("#userInputCategory").val();
            var selectedSubcategory = $("select#userSelectSubCategory option:checked").val();
            var selectedCatID = getCatID(selectedCategory, selectedSubcategory); // This function also alerts user if cat/subcat combo is invalid
            var nameAndNum = getNameAndNumber($("#userInputName").val());
            var nameOnly = nameAndNum[0];
            var numOnly = nameAndNum[1];
            var enableNum = $("#userInputVarNumCheckbox").prop("checked");
            var iXMLChecked = $("#iXMLSettings").prop("checked");
            var vendorChecked = $("#vendorCatCheckbox").prop("checked");
            var metadataChecked = $("#metadataSettings").prop("checked");
            var directoryChecked = $("#renderDirectorySettings").prop("checked");
            var locationChecked = $("#locationInputSettings").prop("checked");
            var markerPosChecked = $("#markerPositionSettings").prop("checked");
            var cleanUserCat = stringCleaning($("#userInputUserCat").val());
            var cleanInitials = stringCleaning($("#userInputInitials").val());
            var cleanShow = stringCleaning($("#userInputShow").val());
            var cleanUserData = stringCleaning($("#userInputData").val());
            var gbxMod = localStorage.getItem("gbx-mod");

            // Alert user of invalid entries and bypass triggering ReaScript
            if (selectedCatID == "CATID_INVALID") { return; }                           // Alert is included in getCatID above
            if (nameOnly == "") { $("#userInputNameError").show(); $("#userCategoryGroup")[0].scrollIntoView(); return; }
            if (cleanInitials == "" && !gbxMod) { $("#userInitialsError").show(); $("#fileNameGroup")[0].scrollIntoView(); return; }
            if ($("#ASWGcontentType").val() !== "-" && $("#ASWGInfoForm").hasClass("was-validated") && $("#ASWGInfoForm")[0].checkValidity() === false) { $("#ASWGInfoModal").modal(); $("#ASWGInfoFormError").show(); return;}
            if ($("#ASWGcontentType").val() !== "-" && $("#ASWGDialogueForm").hasClass("was-validated") && $("#ASWGDialogueForm")[0].checkValidity() === false) { $("#ASWGDialogueModal").modal(); $("#ASWGDialogueFormError").show(); return;}
            if ($("#ASWGcontentType").val() !== "-" && $("#ASWGMusicForm").hasClass("was-validated") && $("#ASWGMusicForm")[0].checkValidity() === false) { $("#ASWGMusicModal").modal(); $("#ASWGMusicFormError").show(); return;}

            // Trigger CSS Animation
            $("#formSubmitButton").addClass('anim-trig');
            $("#formSubmitButton").one('webkitAnimationEnd oanimationend msAnimationEnd animationend',
                function (e) {
                    // Code to execute after animation ends
                    $("#formSubmitButton").removeClass('anim-trig');
                });

            // Set project extstates from processed vars
            setProjExtState(selectedCategory, "Category");
            setProjExtState(selectedSubcategory, "Subcategory");
            setProjExtState(selectedCatID, "CatID");
            setProjExtState(nameOnly, "Name");
            setProjExtState(numOnly, "Number");
            setProjExtState(enableNum, "EnableNum");
            setProjExtState(iXMLChecked, "iXMLMetadata");
            setProjExtState(metadataChecked, "ExtendedMetadata");
            setProjExtState(directoryChecked, "RenderDirectory");
            setProjExtState(markerPosChecked, "MarkerPosition");
            setProjExtState(cleanUserCat, "UserCategory");
            setProjExtState(cleanInitials, "Initials");
            setProjExtState(cleanShow, "Show");
            setProjExtState(cleanUserData, "Data");

            // Set project extstates from HTML vals
            setProjExtState("userInputItems");
            setProjExtState("userInputArea");
            setProjExtState("nameCapitalizationSetting");
            setProjExtState("fxFormattingSetting");
            setProjExtState("copyResultsSetting");

            // Vendor category
            console.log("Vendor checked = " + vendorChecked);
            if (vendorChecked) {
                var vendorCat = stringCleaning($("#userInputVendCat").val());
                setProjExtState(vendorCat, "VendorCategory");
            } else {
                setProjExtState("false", "VendorCategory");
            }

            // Set project extstates for extended metadata fields             
            if (metadataChecked) {
                // Extended metadata fields
                var metaTitle  = stringCleaning($("#userInputMetaTitle").val());
                var metaDesc   = $("#userInputMetaDesc").val();
                var metaKeys   = stringCleaning($("#userInputMetaKeys").val());
                var metaMic    = stringCleaning($("#userInputMetaMic").val());
                var metaRecMed = stringCleaning($("#userInputMetaRecMed").val());
                var metaDsgnr  = stringCleaning($("#userInputMetaDsgnr").val());
                var metaLib    = stringCleaning($("#userInputMetaLib").val());                
                var metaURL    = $("#userInputMetaURL").val();
                var metaMftr   = $("#userInputMetaManufacturer").val();
                var metaNotes  = $("#metaNotes").val();

                // Extended metadata - location
                var metaCoun   = $("#countryId").val();
                var metaState  = $("#stateId").val();
                var metaCity   = $("#cityId").val();
                var metaUserLoc = $("#userLocId").val();
                var metaLoc    = "";
                if (locationChecked) {
                    // Custom user field
                    metaLoc = metaUserLoc;
                } else {
                    // Country, city, state dropdowns
                    if (metaCoun != "Please wait.." && metaCoun != "Select Country" && metaCoun != "") metaLoc = metaCoun;                
                    if (metaState != "Please wait.." && metaState != "Select State" && metaState != "") {
                        (metaLoc != "") ? metaLoc = metaLoc + ", " + metaState : metaLoc = metaState;
                    }
                    if (metaCity != "Please wait.." && metaCity != "Select City" && metaCity != "") {
                        (metaLoc != "") ? metaLoc = metaLoc + ", " + metaCity : metaLoc = metaCity;
                    }
                }
                

                // Extended metadata - mic perspective
                var metaConfig = $("#userInputMetaConfig").val();
                metaConfig = (metaConfig != "-") ? metaConfig.match(/\((.*)\)/).pop() : "";

                var metaPersp  = $("#userInputMetaPersp").val();
                var metaIntExt = $("#userInputMetaIntExt").val();
                if (metaPersp != "-" && metaIntExt != "-") {
                    metaPersp = metaPersp.match(/\((.*)\)/).pop() + " | " + metaIntExt.match(/\((.*)\)/).pop();
                } else if  (metaPersp != "-" && metaIntExt == "-") {
                    metaPersp = metaPersp.match(/\((.*)\)/).pop();
                } else if  (metaPersp == "-" && metaIntExt != "-") {
                    metaPersp = metaIntExt.match(/\((.*)\)/).pop();
                } else if  (metaPersp == "-" && metaIntExt == "-") {
                    metaPersp = "";
                }
                                
                setProjExtState(metaTitle, "MetaTitle");
                setProjExtState(metaDesc, "MetaDesc");
                setProjExtState(metaKeys, "MetaKeys");
                setProjExtState(metaMic, "MetaMic");
                setProjExtState(metaRecMed, "MetaRecMed");
                setProjExtState(metaDsgnr, "MetaDsgnr");
                setProjExtState(metaLib, "MetaLib")
                setProjExtState(metaLoc, "MetaLoc");
                setProjExtState(metaURL, "MetaURL");
                setProjExtState(metaMftr, "MetaMftr");
                setProjExtState(metaNotes, "MetaNotes");
                setProjExtState(metaConfig, "MetaConfig");
                setProjExtState(metaPersp, "MetaPersp");
            }

            //#region Fetch ASWG fields           
            var aswgChecked = $("#ASWGSettings").prop("checked");
            if (aswgChecked) {
                var ASWGcontentType = $("#ASWGcontentType").val();
                var ASWGproject = $("#ASWGproject").val();
                var ASWGoriginatorStudio = $("#ASWGoriginatorStudio").val();
                var ASWGnotes = $("#ASWGnotes").val();
                var ASWGstate = $("#ASWGstate").val();
                var ASWGeditor = $("#ASWGeditor").val();
                var ASWGmixer = $("#ASWGmixer").val();
                var ASWGfxChainName = $("#ASWGfxChainName").val();
                var ASWGchannelConfig = $("#ASWGchannelConfig").val();
                var ASWGambisonicFormat = $("#ASWGambisonicFormat").val();
                var ASWGambisonicChnOrder = $("#ASWGambisonicChnOrder").val();
                var ASWGambisonicNorm = $("#ASWGambisonicNorm").val();
                var ASWGisDesigned = $("#ASWGisDesigned").val();
                var ASWGrecEngineer = $("#ASWGrecEngineer").val();
                var ASWGrecStudio = $("#ASWGrecStudio").val();
                var ASWGimpulseLocation = $("#ASWGimpulseLocation").val();
                var ASWGtext = $("#ASWGtext").val();
                var ASWGefforts = $("#ASWGefforts").val();
                var ASWGeffortType = $("#ASWGeffortType").val();
                var ASWGprojection = $("#ASWGprojection").val();
                var ASWGlanguage = $("#ASWGlanguage").val();
                var ASWGtimingRestriction = $("#ASWGtimingRestriction").val();
                var ASWGcharacterName = $("#ASWGcharacterName").val();
                var ASWGcharacterGender = $("#ASWGcharacterGender").val();
                var ASWGcharacterAge = $("#ASWGcharacterAge").val();
                var ASWGcharacterRole = $("#ASWGcharacterRole").val();
                var ASWGactorName = $("#ASWGactorName").val();
                var ASWGactorGender = $("#ASWGactorGender").val();
                var ASWGdirection = $("#ASWGdirection").val();
                var ASWGdirector = $("#ASWGdirector").val();
                var ASWGfxUsed = $("#ASWGfxUsed").val();
                var ASWGusageRights = $("#ASWGusageRights").val();
                var ASWGisUnion = $("#ASWGisUnion").val();
                var ASWGaccent = $("#ASWGaccent").val();
                var ASWGemotion = $("#ASWGemotion").val();
                var ASWGcomposer = $("#ASWGcomposer").val();
                var ASWGartist = $("#ASWGartist").val();
                var ASWGsongTitle = $("#ASWGsongTitle").val();
                var ASWGgenre = $("#ASWGgenre").val();
                var ASWGsubGenre = $("#ASWGsubGenre").val();
                var ASWGproducer = $("#ASWGproducer").val();
                var ASWGmusicSup = $("#ASWGmusicSup").val();
                var ASWGinstrument = $("#ASWGinstrument").val();
                var ASWGmusicPublisher = $("#ASWGmusicPublisher").val();
                var ASWGrightsOwner = $("#ASWGrightsOwner").val();
                var ASWGintensity = $("#ASWGintensity").val();
                var ASWGorderRef = $("#ASWGorderRef").val();
                var ASWGisSource = $("#ASWGisSource").val();
                var ASWGisLoop = $("#ASWGisLoop").val();
                var ASWGisFinal = $("#ASWGisFinal").val();
                var ASWGisOst = $("#ASWGisOst").val();
                var ASWGisCinematic = $("#ASWGisCinematic").val();
                var ASWGisLicensed = $("#ASWGisLicensed").val();
                var ASWGisDiegetic = $("#ASWGisDiegetic").val();
                var ASWGmusicVersion = $("#ASWGmusicVersion").val();
                var ASWGisrcId = $("#ASWGisrcId").val();
                var ASWGtempo = $("#ASWGtempo").val();
                var ASWGtimeSig = $("#ASWGtimeSig").val();
                var ASWGinKey = $("#ASWGinKey").val();
                var ASWGbillingCode = $("#ASWGbillingCode").val();

                ASWGcontentType = (ASWGcontentType != "-") ? ASWGcontentType : "";
                ASWGstate = (ASWGstate != "-") ? ASWGstate : "";
                ASWGchannelConfig = (ASWGchannelConfig != "-") ? ASWGchannelConfig : "";
                ASWGambisonicChnOrder = (ASWGambisonicChnOrder != "-") ? ASWGambisonicChnOrder : "";
                ASWGambisonicNorm = (ASWGambisonicNorm != "-") ? ASWGambisonicNorm : "";
                ASWGisDesigned = (ASWGisDesigned != "-") ? ASWGisDesigned : "";
                ASWGefforts = (ASWGefforts != "-") ? ASWGefforts : "";
                ASWGprojection = (ASWGprojection != "-") ? ASWGprojection.substring(0,1) : "";               // Fetch projection value number only
                ASWGlanguage = (ASWGlanguage != "-") ? ASWGlanguage.substring(0,2) : "";                     // Fetch language code only
                ASWGtimingRestriction = (ASWGtimingRestriction != "-") ? ASWGtimingRestriction : "";
                ASWGcharacterRole = (ASWGcharacterRole != "-") ? ASWGcharacterRole : "";
                ASWGactorGender = (ASWGactorGender != "-") ? ASWGactorGender : "";
                ASWGisUnion = (ASWGisUnion != "-") ? ASWGisUnion : "";
                ASWGisSource = (ASWGisSource != "-") ? ASWGisSource : "";
                ASWGisLoop = (ASWGisLoop != "-") ? ASWGisLoop : "";
                ASWGisFinal = (ASWGisFinal != "-") ? ASWGisFinal : "";
                ASWGisOst = (ASWGisOst != "-") ? ASWGisOst : "";
                ASWGisCinematic = (ASWGisCinematic != "-") ? ASWGisCinematic : "";
                ASWGisLicensed = (ASWGisLicensed != "-") ? ASWGisLicensed : "";
                ASWGisDiegetic = (ASWGisDiegetic != "-") ? ASWGisDiegetic : "";

                setProjExtState(ASWGcontentType,  "ASWGcontentType");
                setProjExtState(ASWGproject,  "ASWGproject");
                setProjExtState(ASWGoriginatorStudio,  "ASWGoriginatorStudio");
                setProjExtState(ASWGnotes,  "ASWGnotes");
                setProjExtState(ASWGstate,  "ASWGstate");
                setProjExtState(ASWGeditor,  "ASWGeditor");
                setProjExtState(ASWGmixer,  "ASWGmixer");
                setProjExtState(ASWGfxChainName,  "ASWGfxChainName");
                setProjExtState(ASWGchannelConfig,  "ASWGchannelConfig");
                setProjExtState(ASWGambisonicFormat,  "ASWGambisonicFormat");
                setProjExtState(ASWGambisonicChnOrder,  "ASWGambisonicChnOrder");
                setProjExtState(ASWGambisonicNorm,  "ASWGambisonicNorm");
                setProjExtState(ASWGisDesigned,  "ASWGisDesigned");
                setProjExtState(ASWGrecEngineer,  "ASWGrecEngineer");
                setProjExtState(ASWGrecStudio,  "ASWGrecStudio");
                setProjExtState(ASWGimpulseLocation,  "ASWGimpulseLocation");
                setProjExtState(ASWGtext,  "ASWGtext");
                setProjExtState(ASWGefforts,  "ASWGefforts");
                setProjExtState(ASWGeffortType,  "ASWGeffortType");
                setProjExtState(ASWGprojection,  "ASWGprojection");
                setProjExtState(ASWGlanguage,  "ASWGlanguage");
                setProjExtState(ASWGtimingRestriction,  "ASWGtimingRestriction");
                setProjExtState(ASWGcharacterName,  "ASWGcharacterName");
                setProjExtState(ASWGcharacterGender,  "ASWGcharacterGender");
                setProjExtState(ASWGcharacterAge,  "ASWGcharacterAge");
                setProjExtState(ASWGcharacterRole,  "ASWGcharacterRole");
                setProjExtState(ASWGactorName,  "ASWGactorName");
                setProjExtState(ASWGactorGender,  "ASWGactorGender");
                setProjExtState(ASWGdirection,  "ASWGdirection");
                setProjExtState(ASWGdirector,  "ASWGdirector");
                setProjExtState(ASWGfxUsed,  "ASWGfxUsed");
                setProjExtState(ASWGusageRights,  "ASWGusageRights");
                setProjExtState(ASWGisUnion,  "ASWGisUnion");
                setProjExtState(ASWGaccent,  "ASWGaccent");
                setProjExtState(ASWGemotion,  "ASWGemotion");
                setProjExtState(ASWGcomposer,  "ASWGcomposer");
                setProjExtState(ASWGartist,  "ASWGartist");
                setProjExtState(ASWGsongTitle,  "ASWGsongTitle");
                setProjExtState(ASWGgenre,  "ASWGgenre");
                setProjExtState(ASWGsubGenre,  "ASWGsubGenre");
                setProjExtState(ASWGproducer,  "ASWGproducer");
                setProjExtState(ASWGmusicSup,  "ASWGmusicSup");
                setProjExtState(ASWGinstrument,  "ASWGinstrument");
                setProjExtState(ASWGmusicPublisher,  "ASWGmusicPublisher");
                setProjExtState(ASWGrightsOwner,  "ASWGrightsOwner");
                setProjExtState(ASWGintensity,  "ASWGintensity");
                setProjExtState(ASWGorderRef,  "ASWGorderRef");
                setProjExtState(ASWGisSource,  "ASWGisSource");
                setProjExtState(ASWGisLoop,  "ASWGisLoop");
                setProjExtState(ASWGisFinal,  "ASWGisFinal");
                setProjExtState(ASWGisOst,  "ASWGisOst");
                setProjExtState(ASWGisCinematic,  "ASWGisCinematic");
                setProjExtState(ASWGisLicensed,  "ASWGisLicensed");
                setProjExtState(ASWGisDiegetic,  "ASWGisDiegetic");
                setProjExtState(ASWGmusicVersion,  "ASWGmusicVersion");
                setProjExtState(ASWGisrcId,  "ASWGisrcId");
                setProjExtState(ASWGtempo,  "ASWGtempo");
                setProjExtState(ASWGtimeSig,  "ASWGtimeSig");
                setProjExtState(ASWGinKey,  "ASWGinKey");
                setProjExtState(ASWGbillingCode,  "ASWGbillingCode");       
            }

            // GBX Mod
            if (gbxMod) {
                var gbxSuffix =  $("#gbxSuffix").val();
                gbxSuffix = gbxSuffix.match(/\((.*)\)/).pop();
                setProjExtState(gbxMod, "GBXMod")
                setProjExtState(gbxSuffix, "GBXSuffix");
            } else {
                setProjExtState("false", "GBXMod")
            }

            //#endregion

            // Tell ReaScript that this is being run from a web interface
            wwr_req("SET/EXTSTATEPERSIST/UCS_WebInterface/" + "runFromWeb" + "/" + "true");

            // Run ReaScript
            wwr_req(encodeURIComponent(UCSRTLua));

            // Save current settings to history
            saveThisHistory();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // CLICK ON TABLE ROW
        // ~~~~~~~~~~~~~~~~~~~~
        $('#UCRTDataTable').on('click', 'tbody tr', function () {
            var tbl = $('#UCRTDataTable').DataTable();
            var row = tbl.row($(this)).data();
            
            // Read settings checkboxes
            var autoSubmit = $("#autoSubmitCheckbox").prop("checked");
            var autoSearchCatSubcat = $("#autoSearchCatSubcatCheckbox").prop("checked");
            var autoSearchSynonyms = $("#autoSearchSynonymsCheckbox").prop("checked");

            // Trigger row change so form updates
            $("#userInputCategory").val(row[0]).trigger('change');
            $("select#userSelectSubCategory").val(row[1]).trigger('change');

            $("#copiedRowAlert").html("<i>Copied data to form!</i><br />Cat: <b>" + row[0] + "</b><br />Sub: <b>" + row[1] + "</b>");
            $(".copy-alert").fadeTo(4000, 500).slideUp(750);

            // Auto search media explorer (see func below)
            if (autoSearchCatSubcat && autoSearchSynonyms) searchMediaExplorer(row[2] + ", " + row[1] + ", " + row[5]); // CATsub, Sub, Syn
            else if (autoSearchCatSubcat) searchMediaExplorer(row[2]);                                                  // CATsub
            else if (autoSearchSynonyms) searchMediaExplorer(row[1] + ", " + row[5]);                                   // Sub, Syn

            // Auto submit form on row click
            if (autoSubmit) $("#formSubmitButton").click();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SEARCH MEDIA EXPLORER FUNCTIONS
        // ~~~~~~~~~~~~~~~~~~~~
        function searchMediaExplorer(search) {
            // Set project extstates from HTML vals
            setProjExtState(search, "searchMediaExplorer");

            // Run ReaScript
            wwr_req(encodeURIComponent(UCSMediaFilter));
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // REACALL
        // ~~~~~~~~~~~~~~~~~~~~
        function reacall() {
            // 0. Warn if not processing regions or media items
            var search_field = $("#userInputItems").val();
            switch (search_field) {
                case "Regions":
                case "Media Items":
                case "NVK Folder Items":
                    break;

                case "Markers":
                case "Tracks":
                default:
                    $("#dangerAlert").html("Reacall only supports Regions, Media Items, and NVK Folder Items processing targets!");
                    $(".copy-alert").fadeTo(4000, 500).slideUp(750);
                    return;
            }

            // 1. Set current target ext states, warn if not regions or items
            setProjExtState("userInputItems");
            setProjExtState("userInputArea");

            // 2. Run ReaScript
            wwr_req(encodeURIComponent(UCSSendToInterface));

            // 3. Wait a sec, fill form if succesful and warn if failed
            reacallHandled = false;
            wwr_req("GET/PROJEXTSTATE/UCS_WebInterface/ReacallName");
            wwr_req("GET/PROJEXTSTATE/UCS_WebInterface/ReacallMeta");
            
            let counter = 0;
            let timeout = 1000;
            let intervalTime = 50;
            let interval = setInterval(function() {
              // Check if response has been received
              if (reacallHandled) {
                clearInterval(interval);
            } else {
                counter++;
                // Check if timeout has been reached
                if (counter >= timeout) {
                  clearInterval(interval);
                  $("#dangerAlert").html("Reacall timed out while waiting for response from REAPER!");
                  $(".copy-alert").fadeTo(4000, 500).slideUp(750);
                }
              }
            }, intervalTime);        
        }

        function reacallName(ucsName) {
            const pattern = /(?<CatID>[^-_]*)-?(?<UserCategory>[^_]*)?_(?<VendorCategory>[^-]*(?=-))?-?(?<FXName>[^_]*)_(?<CreatorID>[^_]*)_(?<SourceID>[^_.]*)_?(?<UserData>[^_.]*)?\.?(?<Extension>[[:alnum:]]+)?/;
            const match = pattern.exec(ucsName);
            if (match) {
                if (jsonCatIDArr.hasOwnProperty(match.groups.CatID)) {
                    document.getElementById("userInputCategory").setCustomValidity("");
                    document.getElementById("userSelectSubCategory").setCustomValidity("");
                    let catSubcat = jsonCatIDArr[match.groups.CatID].split(", ");
                    if (catSubcat[0] !== "") $("#userInputCategory").val(catSubcat[0]).trigger('change');
                    if (catSubcat[1] !== "") $("#userSelectSubCategory").val(catSubcat[1]).trigger('change');
                }

                if (match.groups.FXName && match.groups.FXName !== "") $("#userInputName").val(match.groups.FXName);            
                if (match.groups.UserCategory && match.groups.UserCategory !== "") $("#userInputUserCat").val(match.groups.UserCategory);
                if (match.groups.CreatorID && match.groups.CreatorID !== "") $("#userInputInitials").val(match.groups.CreatorID);
                if (match.groups.SourceID && match.groups.SourceID !== "") $("#userInputShow").val(match.groups.SourceID);
                if (match.groups.UserData && match.groups.UserData !== "") $("#userInputData").val(match.groups.UserData);
                if (match.groups.VendorCategory && match.groups.VendorCategory !== "") $("#userInputVendCat").val(match.groups.VendorCategory);
            }
        }

        function reacallMeta(ucsMeta) {
            const pattern = /(?<Field>[^;=]+)=(?<Value>[^;]+);?/g;
            const matches = [...ucsMeta.matchAll(pattern)];
            
            for (const match of matches) {
                // console.log(`Key: ${match.groups.Field}, Value: ${match.groups.Value}`);

                switch (match.groups.Field) {
                    case "TrackTitle"    : $("#userInputMetaTitle").val(match.groups.Value).trigger('change'); break;
                    case "Description"   : $("#userInputMetaDesc").val(match.groups.Value).trigger('change'); break;
                    case "Keywords"      : $("#userInputMetaKeys").val(match.groups.Value).trigger('change'); break;
                    case "Microphone"    : $("#userInputMetaMic").val(match.groups.Value).trigger('change'); break;
                    case "RecMedium"     : $("#userInputMetaRecMed").val(match.groups.Value).trigger('change'); break;
                    case "Designer"      : $("#userInputMetaDsgnr").val(match.groups.Value).trigger('change'); break;
                    case "Library"       : $("#userInputMetaLib").val(match.groups.Value).trigger('change'); break;
                    case "URL"           : $("#userInputMetaURL").val(match.groups.Value).trigger('change'); break;
                    case "Manufacturer"  : $("#userInputMetaManufacturer").val(match.groups.Value).trigger('change'); break;
                    case "Notes"         : $("#metaNotes").val(match.groups.Value).trigger('change'); break;
                    case "RecType"       : selectDropdownOptionContaining("#userInputMetaConfig", match.groups.Value); break;
                    case "Location"      : {
                        // Force visibility of manual location box
                        locationChecked = true;
                        localStorage.setItem("location-input-setting",locationChecked); // Set value in local storage
                        $("#metaLocDiv").hide();
                        $("#metaUserLocDiv").show();
                        $("#userLocId").val(match.groups.Value).trigger('change'); 
                        break;
                    }
                    case "MicPerspective": {
                        let micPerspIntExt = match.groups.Value.split(" | ");
                        selectDropdownOptionContaining("#userInputMetaPersp", micPerspIntExt[0]);
                        selectDropdownOptionContaining("#userInputMetaIntExt", micPerspIntExt[1]);
                        break;
                    }
                    // TODO: Add ASWG fields, if anyone cares...
                    default: break;
                }
            }
        }

        function selectDropdownOptionContaining(dropdown, contains) {
            $(dropdown).find('option').each(function() {
              if ($(this).text().indexOf(contains) !== -1) {
                $(this).prop('selected', true);
                return false; // stop the loop once the desired option is found
              }
            });
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // WEB INTERFACE REQUEST HANDLER
        // ~~~~~~~~~~~~~~~~~~~~
        function wwr_onreply(results) {
          var ar = results.split("\n");
          var x;
          for (x=0;x<ar.length;x++)
          {
            var tok = ar[x].split("\t");
            if (tok[2] == "ReacallName") {
                reacallHandled = true;
                reacallName(tok[3]);                
            } else if (tok[2] == "ReacallMeta") {
                reacallHandled = true;                
                reacallMeta(tok[3]);                
            }
          }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // TRIGGER SUBMIT ON ENTER KEY
        // ~~~~~~~~~~~~~~~~~~~~
        $(document).keydown(function (event) {
            if (event.which === 13) {
                var categoryFocused = $('#userInputCategory').is(':focus');
                var metaNotesFocused = $('#metaNotes').is(':focus');
                var modalFocused = $('body').find('.modal.show').length > 0;
                if (!categoryFocused && !modalFocused && !metaNotesFocused) {
                    $("#formSubmitButton").click();
                } else if ($('#presetsModal').hasClass('show')) {
                    saveThisAsPreset();
                } else if ($('#deletePresetsModal').hasClass('show')) {
                    $('#deletePresetsModal').modal('hide'); 
                    deleteThisPreset();                    
                } else if (modalFocused) {
                    $('.modal').modal('hide');
                }               
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // DOWNLOAD "UCS.txt" FILE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#downloadUCSButton").click(function (e) {
            $("#UCSInstallInstructions").show();
            $("#downloadUCSButtonText").hide();
            downloadBlobFile();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // REENABLE ONLINE MODE INSTRUCTIONS
        // ~~~~~~~~~~~~~~~~~~~~
        $("#onlineUCSButton").click(function (e) {
            if (onlineModeInstructionsToggle) {
                $("#UCSOnlineModeInstructions").show();
                onlineModeInstructionsToggle = false;
                // Open Reaper resource path
                wwr_req(encodeURIComponent(REApath));
            } else {
                $("#UCSOnlineModeInstructions").hide();
                onlineModeInstructionsToggle = true;
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // BUILD SUBCATEGORY ARRAY BASED ON CATEGORY
        // ~~~~~~~~~~~~~~~~~~~~
        $("#userInputCategory").change(function () {
            var $dropdown = $(this);
            var key = $dropdown.val();
            var vals = [];
            if (jsonCategorySubcategoryArr.hasOwnProperty(key)) {
                document.getElementById("userInputCategory").setCustomValidity("");
                document.getElementById("userSelectSubCategory").setCustomValidity("");
                vals = jsonCategorySubcategoryArr[key].split(", ");
                $("#userInputCategoryError").hide();
            } else {
                document.getElementById("userInputCategory").setCustomValidity("Invalid");
                document.getElementById("userSelectSubCategory").setCustomValidity("Invalid");
                vals = ['Please select a valid category!'];
            }

            var $secondChoice = $("#userSelectSubCategory");
            $secondChoice.empty();
            $.each(vals, function (index, value) {
                $secondChoice.append("<option>" + value + "</option>");
            });
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET MIC PERSPECTIVE BASED ON REC TYPE IF NEEDED/VISE VERSA
        // ~~~~~~~~~~~~~~~~~~~~
        $("#userInputMetaConfig").change(function () {
            var config = $("#userInputMetaConfig").val();
            if (config.includes("Contact") || config.includes("Electro") || config.includes("Hydro")) {
                $("#userInputMetaPersp").val(config);
                $("#userInputMetaIntExt").val("-").trigger('change');
            } else if (config.includes("Click to configure...")) {
                showAmbiModal();
            }
        });
        $("#userInputMetaPersp").change(function () {
            var config = $("#userInputMetaPersp").val();
            if (config.includes("Contact") || config.includes("Electro") || config.includes("Hydro")) {
                $("#userInputMetaConfig").val(config);
                $("#userInputMetaIntExt").val("-").trigger('change');
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // AMBISONICS MODAL FUNCTIONS
        // ~~~~~~~~~~~~~~~~~~~~
        // Show A-Format Orientation Dropdown
        $("#ambiModalFormat").change(function () {
            var config = $("#ambiModalFormat").val();
            if (config.includes("A-Format")) {
                $("#ambiModalOrientationDiv").show();
            } else {
                $("#ambiModalOrientationDiv").hide();
            }
        });

        // Set configuration when submit button is pressed on modal
        function setAmbiConfig() {
            var ambi_order = $("#ambiModalOrder").val();
            var ambi_format = $("#ambiModalFormat").val();
            var ambi_orient = $("#ambiModalOrientation").val();
            var ambi_config = "";

            ambi_order = (ambi_order != "-") ? ambi_order.match(/\((.*)\)/).pop() : "";
            ambi_format = (ambi_format != "-") ? ambi_format.match(/\((.*)\)/).pop() : "";
            ambi_orient = (ambi_orient != "-") ? ambi_orient.match(/\((.*)\)/).pop() : "";

            if (ambi_format == "AFMT") {
                ambi_config = ambi_order + "-" + ambi_format + "-" + ambi_orient;
            } else {
                ambi_config = ambi_order + "-" + ambi_format;
            }

            ambi_config = "Ambisonic (" + ambi_config + ")"

            // Set mic config dropdown option value
            $("#customAmbi").text(ambi_config);
            $("#userInputMetaConfig").val(ambi_config).trigger('change');
        }

        // Show modal
        function showAmbiModal() {
            $('#ambisonicsModal').modal();
        }

        // Make sure user didn't cancel out and leave it with "Click to configure..."
        function doubleCheckAmbiConfig() {
            var meta_config = $("#userInputMetaConfig").val();
            if (meta_config.includes("configure")) {
                $("#userInputMetaConfig").val("-").trigger('change');
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // BUILD SEARCH AREA OPTIONS BASED ON REGION/MARKER/ITEM/TRACK SELECTION
        // ~~~~~~~~~~~~~~~~~~~~
        $("#userInputItems").change(function () {
            var key = $(this).val();
            var vals = [];

            // Clean up wildcard info based on search type
            wildcardCleanup();
            
            switch (key) {
                case "Regions":
                    // Remove selected regions option for mac users for now
                    if (isMac) {
                        vals = ["Edit Cursor", "Time Selection", "Full Project"];
                    } else {
                        vals = ["Selected Regions in Region Manager", "Edit Cursor", "Time Selection", "Full Project"];
                    }
                    break;

                case "Markers":
                    // Remove selected markers option for mac users for now
                    if (isMac) {
                        vals = ["Time Selection", "Full Project"];
                    } else {
                        vals = ["Selected Markers in Marker Manager", "Time Selection", "Full Project"];
                    }
                    break;

                case "Media Items":
                case "NVK Folder Items":
                    vals = ["Selected Items", "All Items"];
                    break;

                case "Tracks":
                    // Remove selected tracks option for mac users for now
                    if (isMac){
                        vals = ["Selected Tracks", "All Tracks"];
                    } else {
                        vals = ["Selected Tracks", "Selected in Track Manager", "All Tracks"];
                    }
                    break;

                default:
                    break;
            }

            // Set up search area options based on search item
            var $secondChoice = $("#userInputArea");
            $secondChoice.empty();
            $.each(vals, function (index, value) {
                $secondChoice.append("<option>" + value + "</option>");
            });            
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // UPDATE NAVBAR HIGHLIGHTS W SCROLL
        // ~~~~~~~~~~~~~~~~~~~~
        $( window ).scroll(function() {
            var removeScrollClasses = function (el1, el2, el3) {
                $(el1).removeClass("active");
                $(el2).removeClass("active");
                $(el3).removeClass("active");
            }

            var processingOffset = $("#userInputData").offset().top - $(window).scrollTop();
            var metadataOffset = $("#userInputArea").offset().top - $(window).scrollTop();
            var dataOffset = $("#formSubmitButton").offset().top - $(window).scrollTop();
            var posBuffer = 200;

            if (dataOffset < posBuffer) {
                removeScrollClasses("#metadataScroll", "#processingScroll", "#namingScroll");
                $("#dataScroll").addClass("active");

            } else if (metadataOffset < posBuffer && localStorage.getItem("metadata-setting")) {
                removeScrollClasses("#dataScroll", "#processingScroll", "#namingScroll");
                $("#metadataScroll").addClass("active");

            } else if (processingOffset < posBuffer) {
                removeScrollClasses("#metadataScroll", "#dataScroll", "#namingScroll");
                $("#processingScroll").addClass("active");

            } else {
                removeScrollClasses("#metadataScroll", "#processingScroll", "#dataScroll");
                $("#namingScroll").addClass("active");
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // WILDCARD CLEANUP
        // ~~~~~~~~~~~~~~~~~~~~
        // Change info under file name field to match current supported wildcards
        // If filename field has wildcard info that doesn't match current item selection, then change it
        function wildcardCleanup() {
            var search_field = $("#userInputItems").val();
            var cur_name = $("#userInputName").val();

            var number_info = "<b>WILDCARDS: </b>";
            var closer_info = "<br />- Available wildcards are dependent on 'Items to Rename' field in <i>Processing</i> below.";

            switch (search_field) {
                case "Regions":
                    // Change text below filenaming section to clarify wildcard support
                    var wildcard_info = "$region, $regionnumber";
                    $("#userInputNameHelp").html(number_info + wildcard_info + closer_info);

                    // Naming
                    if (cur_name.includes("$marker")) cur_name = cur_name.replace("$marker", "$region");
                    if (cur_name.includes("$item")) cur_name = cur_name.replace("$item", "$region");
                    if (cur_name.includes("$track")) cur_name = cur_name.replace("$track", "$region");

                    // Numbering
                    if (cur_name.includes("$markernumber")) cur_name = cur_name.replace("$markernumber", "$regionnumber");
                    if (cur_name.includes("$itemnumber")) cur_name = cur_name.replace("$itemnumber", "$regionnumber");
                    if (cur_name.includes("$tracknumber")) cur_name = cur_name.replace("$tracknumber", "$regionnumber");

                    $("#userInputName").val(cur_name)
                    break;

                case "Markers":
                    var wildcard_info = "$marker, $markernumber";
                    $("#userInputNameHelp").html(number_info + wildcard_info + closer_info);

                    if (cur_name.includes("$region")) cur_name = cur_name.replace("$region", "$marker");
                    if (cur_name.includes("$item")) cur_name = cur_name.replace("$item", "$marker");
                    if (cur_name.includes("$track")) cur_name = cur_name.replace("$track", "$marker");

                    if (cur_name.includes("$regionnumber")) cur_name = cur_name.replace("$regionnumber", "$markernumber");
                    if (cur_name.includes("$itemnumber")) cur_name = cur_name.replace("$itemnumber", "$markernumber");
                    if (cur_name.includes("$tracknumber")) cur_name = cur_name.replace("$tracknumber", "$markernumber");

                    $("#userInputName").val(cur_name)
                    break;

                case "Media Items":
                case "NVK Folder Items":
                    var wildcard_info = "$item, $itemnumber";
                    $("#userInputNameHelp").html(number_info + wildcard_info + closer_info);

                    if (cur_name.includes("$marker")) cur_name = cur_name.replace("$marker", "$item");
                    if (cur_name.includes("$region")) cur_name = cur_name.replace("$region", "$item");
                    if (cur_name.includes("$track")) cur_name = cur_name.replace("$track", "$item");

                    if (cur_name.includes("$markernumber")) cur_name = cur_name.replace("$markernumber", "$itemnumber");
                    if (cur_name.includes("$regionnumber")) cur_name = cur_name.replace("$regionnumber", "$itemnumber");
                    if (cur_name.includes("$tracknumber")) cur_name = cur_name.replace("$tracknumber", "$itemnumber");

                    $("#userInputName").val(cur_name)
                    break;

                case "Tracks":
                    var wildcard_info = "$track, $tracknumber";
                    $("#userInputNameHelp").html(number_info + wildcard_info + closer_info);

                    if (cur_name.includes("$marker")) cur_name = cur_name.replace("$marker", "$track");
                    if (cur_name.includes("$item")) cur_name = cur_name.replace("$item", "$track");
                    if (cur_name.includes("$region")) cur_name = cur_name.replace("$region", "$track");

                    if (cur_name.includes("$markernumber")) cur_name = cur_name.replace("$markernumber", "$tracknumber");
                    if (cur_name.includes("$itemnumber")) cur_name = cur_name.replace("$itemnumber", "$tracknumber");
                    if (cur_name.includes("$regionnumber")) cur_name = cur_name.replace("$regionnumber", "$tracknumber");

                    $("#userInputName").val(cur_name)
                    break;

                default:
                    break;
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // VALIDATE ALL FIELDS ON KEYPRESS
        // ~~~~~~~~~~~~~~~~~~~~
        $("input[type='text']").change(function () {
            // Delayed form check to allow for default preset load
            var loadedSeconds = (new Date().valueOf() - startTime) / 1000;            
            if (loadedSeconds > 1 && event) {
                // validateCategory();
                // Fetch form to apply custom Bootstrap validation
                var form = $("#ucsForm");
                if (form[0].checkValidity() === false) {
                    // Form is invalid
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.addClass('was-validated');

                if ($('#ASWGInfoModal').hasClass('show')) {
                    form = $("#ASWGInfoForm");
                    if (form[0].checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    } else {
                        $("#ASWGInfoFormError").hide();
                    }
                    form.addClass('was-validated');
                    
                } else if ($('#ASWGMusicModal').hasClass('show')) {
                    form = $("#ASWGMusicForm");
                    if (form[0].checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    } else {
                        $("#ASWGMusicFormError").hide();
                    }
                    form.addClass('was-validated');

                } else if ($('#ASWGDialogueModal').hasClass('show')) {
                    form = $("#ASWGDialogueForm");
                    if (form[0].checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();                       
                    } else {
                        $("#ASWGDialogueFormError").hide();
                    }
                    form.addClass('was-validated');                    
                } 
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // VALIDATE NAME FIELD
        // ~~~~~~~~~~~~~~~~~~~~
        $("#userInputName").keyup(function () {
            if (document.getElementById("userInputName").checkValidity() === true) {
                $("#userInputNameError").hide();
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // VALIDATE INITIALS FIELD
        // ~~~~~~~~~~~~~~~~~~~~
        $("#userInputInitials").keyup(function () {
            if (document.getElementById("userInputInitials").checkValidity() === true) {
                $("#userInitialsError").hide();
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // COPY WITHOUT PROCESSING ALERT
        // ~~~~~~~~~~~~~~~~~~~~
        $("#copyResultsSetting").change(function () {
            var key = $(this).val();
            localStorage.setItem("copy-setting",key); // Set value in local storage
            if (key == "Copy WITHOUT processing") {
                $("#copyResultsWarning").show();
                $("#copyResultsWarning2").show();
            } else {
                $("#copyResultsWarning").hide();
                $("#copyResultsWarning2").hide();
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // ASWG Content Type
        // ~~~~~~~~~~~~~~~~~~~~
        $("#ASWGcontentType").change(function () {
            var key = $(this).val();
            if (key == "SFX") {
                $("#ASWGInfoBtn").show();
                //$("#ASWGSFXBtn").show();
                $("#ASWGMusicBtn").hide();
                $("#ASWGDialogueBtn").hide();
                $("#ASWGimpulseLocationSection").hide();
            } else if (key == "Music") {
                $("#ASWGInfoBtn").show();
                //$("#ASWGSFXBtn").hide();
                $("#ASWGMusicBtn").show();
                $("#ASWGDialogueBtn").hide();
                $("#ASWGimpulseLocationSection").hide();
            } else if (key == "Dialogue") {
                $("#ASWGInfoBtn").show();
                //$("#ASWGSFXBtn").hide();
                $("#ASWGMusicBtn").hide();
                $("#ASWGDialogueBtn").show();
                $("#ASWGimpulseLocationSection").hide();
            } else if (key == "Mixed") {
                $("#ASWGInfoBtn").show();
                //$("#ASWGSFXBtn").show();
                $("#ASWGMusicBtn").show();
                $("#ASWGDialogueBtn").show();
                $("#ASWGimpulseLocationSection").show();
            } else if (key == "Impulse (IR)") {
                $("#ASWGInfoBtn").show();
                //$("#ASWGSFXBtn").hide();
                $("#ASWGMusicBtn").hide();
                $("#ASWGDialogueBtn").hide();
                $("#ASWGimpulseLocationSection").show();
            } else if (key == "Haptic") {
                $("#ASWGInfoBtn").show();
                //$("#ASWGSFXBtn").hide();
                $("#ASWGMusicBtn").hide();
                $("#ASWGDialogueBtn").hide();
                $("#ASWGimpulseLocationSection").hide();
            } else {
                $("#ASWGInfoBtn").hide();
                //$("#ASWGSFXBtn").hide();
                $("#ASWGMusicBtn").hide();
                $("#ASWGDialogueBtn").hide();
                $("#ASWGimpulseLocationSection").hide();
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // ASWG Ambisonic Channels
        // ~~~~~~~~~~~~~~~~~~~~
        $("#ASWGchannelConfig").change(function () {
            var key = $(this).val();
            if (key == "Ambisonic") {
                $("#ASWGambisonicFormatSection").show();
                $("#ASWGambisonicChnOrderSection").show();
                $("#ASWGambisonicNormSection").show();
            } else {
                $("#ASWGambisonicFormatSection").hide();
                $("#ASWGambisonicChnOrderSection").hide();
                $("#ASWGambisonicNormSection").hide();
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // UCS iXML RENDERING ON CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#iXMLSettings").change(function () {
            var iXMLChecked = $(this).prop("checked");
            if (iXMLChecked) {
                localStorage.setItem("ixml-setting",iXMLChecked); // Set value in local storage
                $("#metadataWarning").show();
            } else {            
                localStorage.removeItem("ixml-setting");
                if (!$("#metadataSettings").prop("checked")) {
                    $("#metadataWarning").hide();
                }
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // RENDER DIRECTORY SETTINGS ON CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#renderDirectorySettings").change(function () {
            var directoryChecked = $(this).prop("checked");
            if (directoryChecked) {
                localStorage.setItem("directory-setting",directoryChecked); // Set value in local storage
            } else {            
                localStorage.removeItem("directory-setting");
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // LOCATION INPUT SETTINGS ON CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#locationInputSettings").change(function () {
            var locationChecked = $(this).prop("checked");
            if (locationChecked) {
                localStorage.setItem("location-input-setting",locationChecked); // Set value in local storage
                $("#metaLocDiv").hide();
                $("#metaUserLocDiv").show();
            } else {            
                localStorage.removeItem("location-input-setting");
                $("#metaLocDiv").show();
                $("#metaUserLocDiv").hide();
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // MARKER POSITION SETTINGS ON CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#markerPositionSettings").change(function() {
            var markerPosChecked = $(this).prop("checked");
            if (markerPosChecked) {
                localStorage.setItem("marker-pos-setting",markerPosChecked); // Set value in local storage
            } else {            
                localStorage.removeItem("marker-pos-setting");
            }
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // EXTENDED METADATA TOGGLE ON CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#metadataSettings").change(function () {
            var metadataChecked = $(this).prop("checked");
            if (metadataChecked) {
                localStorage.setItem("metadata-setting",metadataChecked);
                $("#metadataWarning").show();
                $("#metadataTitle").show();
                $("#metadataSection").show();
                $("#metadataScroll").show();
            } else {
                localStorage.removeItem("metadata-setting");
                $("#metadataTitle").hide();
                $("#metadataSection").hide();
                $("#metadataScroll").hide();
                if (!$("#iXMLSettings").prop("checked")) {
                    $("#metadataWarning").hide();
                }
            }
        })

        // ~~~~~~~~~~~~~~~~~~~~
        // ASWG METADATA TOGGLE ON CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#ASWGSettings").change(function() {
            var aswgChecked = $(this).prop("checked");
            if (aswgChecked) {
                localStorage.setItem("aswg-setting",aswgChecked);
                $("#ASWGSection").show();
            } else {
                localStorage.removeItem("aswg-setting");
                $("#ASWGSection").hide();
            }
        })

        // ~~~~~~~~~~~~~~~~~~~~
        // VENDOR CAT CHECKBOX TOGGLE ON CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#vendorCatCheckbox").change(function () {
            var vendorCatChecked = $(this).prop("checked");
            if (vendorCatChecked) {
                localStorage.setItem("vendor-cat-setting",vendorCatChecked);
                $("#vendorCategoryGroup").show();
            } else {
                localStorage.removeItem("vendor-cat-setting");
                $("#vendorCategoryGroup").hide();
            }
        })

        // ~~~~~~~~~~~~~~~~~~~~
        // LOG ALBUM ART ON INPUT CHANGE
        // ~~~~~~~~~~~~~~~~~~~~
        $("#userInputMetaArt").on("change", function() {
            var fullName = $(this).file().name[0];
            var fileName = $(this).val().split("\\").pop();
            console.log(fullName);
            console.log(fileName);
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // STORE CAPITALIZATION SETTINGS
        // ~~~~~~~~~~~~~~~~~~~~
        $("#nameCapitalizationSetting").change(function () {
            var key = $(this).val();            
            localStorage.setItem("caps-setting",key); // Set value in local storage
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // FX NAME FORMAT SETTINGS
        // ~~~~~~~~~~~~~~~~~~~~
        $("#fxFormattingSetting").change(function () {
            var key = $(this).val();
            localStorage.setItem("fx-format-setting",key); // Set value in local storage
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - English
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langEN").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_en);
            localStorage.setItem("ucs_language_country", "us");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Spanish
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langES").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_es);
            localStorage.setItem("ucs_language_country", "es");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - French
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langFR").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_fr);
            localStorage.setItem("ucs_language_country", "fr");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - German
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langDE").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_de);
            localStorage.setItem("ucs_language_country", "de");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Italian
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langIT").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_it);
            localStorage.setItem("ucs_language_country", "it");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Polish
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langPL").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_pl);
            localStorage.setItem("ucs_language_country", "pl");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Dutch
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langNL").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_nl);
            localStorage.setItem("ucs_language_country", "nl");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Danish
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langDA").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_da);
            localStorage.setItem("ucs_language_country", "dk");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Finnish
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langFI").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_fi);
            localStorage.setItem("ucs_language_country", "fi");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Portuguese
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langPT").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_pt);
            localStorage.setItem("ucs_language_country", "pt");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Portuguese - Brazil
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langPTBR").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_pt_br);
            localStorage.setItem("ucs_language_country", "br");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Chinese
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langZH").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_zh);
            localStorage.setItem("ucs_language_country", "cn");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Japanese
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langJA").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_ja);
            localStorage.setItem("ucs_language_country", "jp");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Taiwan
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langTW").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_tw);
            localStorage.setItem("ucs_language_country", "tw");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Korean
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langKR").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_kr);
            localStorage.setItem("ucs_language_country", "kr");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Norway
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langNO").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_no);
            localStorage.setItem("ucs_language_country", "no");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Sweden
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langSE").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_se);
            localStorage.setItem("ucs_language_country", "se");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Russian
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langRU").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_ru);
            localStorage.setItem("ucs_language_country", "ru");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Ukrainian
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langUA").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_ua);
            localStorage.setItem("ucs_language_country", "ua");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // SET LANGUAGE - Turkish
        // ~~~~~~~~~~~~~~~~~~~~
        $("#langTR").click(function (e) {
            localStorage.setItem("ucs_language", ucs_gsheet_tr);
            localStorage.setItem("ucs_language_country", "tr");
            location.reload();
        });

        // ~~~~~~~~~~~~~~~~~~~~
        // GET UCS LANGUAGE COUNTRY ICON
        // ~~~~~~~~~~~~~~~~~~~~
        function getUCSLanguage() {
            // Parse JSON from Google Sheet
            var ucs_lang_country = "";
            if (localStorage.getItem("ucs_language_country") !== null) {
                ucs_lang_country = localStorage.getItem("ucs_language_country");
            } else {
                // Default to English/US
                localStorage.setItem("ucs_language_country", "us");
                ucs_lang_country = "us";
            }
            $("#navbarLangDropdown").html('<i class="flag ' + ucs_lang_country + '"></i>&nbsp;&nbsp;Language');

            // Set HTML per language
            switch(ucs_lang_country) {
                case "cn":
                    // Relabel fields for Chinese. Thanks 崔强强!
                    
                    // Navbar
                    $("#navbarTitle").html("&nbsp;UCS Reaper 重命名工具");
                    $("#namingScroll").html('<a class="nav-link" href="#">命名<span class="sr-only">(current)</span></a>');
                    $("#processingScroll").html('<a class="nav-link" href="#userInputData">处理</a>');
                    $("#metadataScroll").html('<a class="nav-link" href="#userInputArea">元数据</a>');
                    $("#dataScroll").html('<a class="nav-link" href="#formSubmitButton">UCS 在线数据库</a>');
                    $("#navbarPresetsDropdown").text('预设');
                    $("#navbarHistoryDropdown").text('历史');
                    $("#navbarLangDropdown").text('数据库语言（请选择中文）');
                    $("#langEN").html('<i class="flag us"></i>&nbsp;&nbsp;英文');
                    $("#langES").html('<i class="flag es"></i>&nbsp;&nbsp;西班牙语');
                    $("#langFR").html('<i class="flag fr"></i>&nbsp;&nbsp;法语');
                    $("#langDE").html('<i class="flag de"></i>&nbsp;&nbsp;德语');
                    $("#langIT").html('<i class="flag it"></i>&nbsp;&nbsp;意大利语');
                    $("#langPL").html('<i class="flag pl"></i>&nbsp;&nbsp;波兰语');
                    $("#langNL").html('<i class="flag nl"></i>&nbsp;&nbsp;荷兰语');
                    $("#langDA").html('<i class="flag dk"></i>&nbsp;&nbsp;丹麦语');
                    $("#langNO").html('<i class="flag no"></i>&nbsp;&nbsp;挪威语');
                    $("#langSE").html('<i class="flag se"></i>&nbsp;&nbsp;瑞典');
                    $("#langFI").html('<i class="flag fi"></i>&nbsp;&nbsp;芬兰语');
                    $("#langPT").html('<i class="flag pt"></i>&nbsp;&nbsp;葡萄牙语');
                    $("#langPTBR").html('<i class="flag br"></i>&nbsp;&nbsp;葡萄牙语-巴西');
                    $("#langZH").html('<i class="flag cn"></i>&nbsp;&nbsp;简体中文');
                    $("#langJA").html('<i class="flag jp"></i>&nbsp;&nbsp;日语');
                    $("#langTW").html('<i class="flag tw"></i>&nbsp;&nbsp;繁体中文');
                    $("#langKR").html('<i class="flag kr"></i>&nbsp;&nbsp;韩国人');
                    $("#langRU").html('<i class="flag ru"></i>&nbsp;&nbsp;俄语');
                    $("#langUA").html('<i class="flag ua"></i>&nbsp;&nbsp;乌克兰语');
                    $("#langTR").html('<i class="flag tr"></i>&nbsp;&nbsp;土耳其');
                    
                    // Settings menu
                    $("#settingsBtnDark").html('<img src="ucs_libraries/settings-icon-dark.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;工具设置');
                    $("#settingsBtnLight").html('<img src="ucs_libraries/settings-icon-light.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;工具设置');
                    $("#settingsMenuTitle").text('UCS 重命名工具设置');
                    $("#settingsMenuProcessingTitle").html('<i>处理数据</i>');
                    $("#settingsVendorHeader").text('供应商类别：');
                    $("#settingsVendorDescription").text('显示供应商类别字段？（只与音效库供应商相关）');
                    $("#settingsCapsHeader").text('自动大写：');
                    $("#settingsCapsDesc").text('创建者ID，源ID，用户类别，供应商类别：');
                    $("#nameCapitalizationSetting").html('<option>全部大写 （默认）</option><option>标题大写</option><option>禁用自动大写</option>');
                    $("#settingsCopyHeader").text('名称复制设置:');
                    $("#copyResultsSetting").html('<option>无需复制（默认）</option><option>处理数据后复制</option><option>无需处理即可复制</option>');
                    $("#copyResultsWarning").text('此处设置可以绕过处理部分和只需复制到剪贴板.');
                    $("#settingsUCSTableHeader").text('UCS 在线数据库');
                    $("#settingsUCSAutoSubmit").text('自动提交：');
                    $("#settingsUCSAutoSubmitDesc").text('单击表格行时自动提交表单数据？');
                    $("#settingsFilterMediaExp").text('过滤媒体资源管理器：');
                    $("#settingsFilterMediaExpDesc").text('单击表格行时在媒体资源管理器中搜索类别/子类别？ ');
                    $("#settingsFilterMediaExpSyn").text('单击表格行时在媒体资源管理器中搜索同义词？');
                    $("#settingsMetadataHeader").text('元数据');
                    $("#settingsUCSMetadataHeader").text('渲染UCS元数据');
                    $("#settingsUCSMetadataDesc").text('渲染时在元数据中嵌入 UCS 表单信息？');
                    $("#settingsExtMetaHeader").text('显示扩展的元数据输入字段，如麦克风，视角，位置等。');
                    $("#metadataWarning").html('- 渲染元数据需要在渲染设置中检查“嵌入：元数据”<br>- 重命名轨道时渲染元数据 <b>不适用</b>。 <br>- 渲染元数据字段都是可选的，可以留空。');
                    $("#settingsAppearanceHeader").text('外观/风格：');
                    $("#settingsLightModeButton").html('<img src="ucs_libraries/light-mode-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;白色模式');
                    $("#settingsDarkModeButton").html('<img src="ucs_libraries/dark-mode-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;黑色模式');
                    $("#settingsLinksHeader").text('外部链接');
                    $("#settingsLightFdbk").html('<img src="ucs_libraries/dark-feedback-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;反馈');
                    $("#settingsDarkFdbk").html('<img src="ucs_libraries/light-feedback-icon.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;反馈');
                    $("#settingsLightUCS").html('<img src="ucs_libraries/ucs_logo_white_on_black.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;UCS 官网');
                    $("#settingsDarkUCS").html('<img src="ucs_libraries/ucs_logo_black_on_white.png" width="25" height="25" class="d-inline-block align-top" alt="">&nbsp;UCS 官网');
                    $("#settingsFooter").html('<p class="mr-auto">由&nbsp;<a href="https://aaroncendan.me" target="_blank">Aaron Cendan</a>开发，请作者&nbsp;<a href="https://ko-fi.com/acendan_" target="_blank">喝杯咖啡！</a> <br/>此界面是由<a href="http://wpa.qq.com/pa?p=2:524541577:41" target="_blank">52HZ Studio</a>修改的中文分支!</p><button type="button" class="btn btn-secondary" data-dismiss="modal">关闭设置</button>');
                    $("#savePresetModalContent").html('<div class="modal-header"><h3 style="margin:0;" class="modal-title">保存当前设置</h4></div><div class="modal-body"><label for="presetNameLabel">预设名称</label><input type="text" class="form-control" id="presetName" aria-describedby="presetNameHelp" placeholder="我的预设"><small id="presetNameHelp" class="form-text text-muted">- 一个名为“Default”的预设会在你打开工具时加载<br>- 预设将收集所有字段信息。 <br>- 我建议将“类别”、“子类别”和“文件名”留空。</br></small></div><div class="modal-footer"><button type="button" class="btn btn-success" onClick="saveThisAsPreset()" data-dismiss="modal">保存</button><button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button></div>');
                    $("#deletePresetModalContent").html('<div class="modal-header"><h3 style="margin:0;" class="modal-title">删除预设</h4></div><div class="modal-body"><label for="presetNameLabel">删除预设...</label><select id="deletePresetSelect" class="form-control"></select><small class="form-text text-muted"><b>警告: </b>删除后无法还原预设.</small></div><div class="modal-footer"><button type="button" class="btn btn-danger" onClick="deleteThisPreset()" data-dismiss="modal">删除预设</button><button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button></div>');
                    
                    // Form
                    $("#naming").html('<i>UCS命名</i>');
                    $("#namingFormRow").html('<!-- Category --><div class="form-group col-md-6 required" id="typeaheadCategory"><label for="userInputCategoryLabel">类别*（必填项）</label><br><input type="text" class="form-control typeahead" id="userInputCategory" aria-describedby="userInputCategoryHelp" placeholder="这是什么声音类型?" required><div id="userInputCategoryError" style="display: none; margin:0;" class="alert alert-warning" role="alert">No valid CatID found. Please check your Category & Subcategory selections!</div><small id="userInputCategoryHelp" class="form-text text-muted">输入即可自动搜索类别，也可点击数据库查询。</small></div><!-- Subcategory --><div class="form-group col-md-6 required" id="typeaheadSubcategory"><label for="userInputSubCategoryLabel">子类别*（必填项）</label><select class="form-control" id="userSelectSubCategory" required><option>请选择一个类别!</option></select><small id="userInputSubCategoryHelp" class="form-text text-muted">选择类别时，子类别下拉列表将填充选项。 如果不需要子类别选择“-” </small>                </div>                <!-- User Category -->                <div class="form-group col-md-6" id="userCategoryGroup"><label for="userInputUserCatLabel">用户类别（可选）</label><input type="text" class="form-control" id="userInputUserCat" aria-describedby="userInputUserCatHelp" placeholder="可选用户类别 "><small id="userInputUserCatHelp" class="form-text text-muted">如果没有“用户类别” 请留空</small>                </div>                <!-- Vendor Category -->                <div class="form-group col-md-6" id="vendorCategoryGroup"><label for="userInputVendCatLabel">供应商名称（可选）</label><input type="text" class="form-control" id="userInputVendCat" aria-describedby="userInputVendCatHelp" placeholder="可选音效库类别 "><small id="userInputVendCatHelp" class="form-text text-muted">如果您不是音效库供应商，请留空。</small>                </div>                <!-- Name w Var ID -->                <div class="form-group col-md-6 required" id="fileNameGroup"><label for="userInputNameLabel">文件名*</label><input type="text" class="form-control" id="userInputName" aria-describedby="userInputNameHelp" placeholder="使用空格（而不是下划线）命名您的项目。" required pattern="(.|\s)*\S(.|\s)*"><div id="userInputNameError" style="display: none; margin:0;" class="alert alert-warning" role="alert">文件名不能为空!</div><div class="form-check" style="margin-left:0px"><input class="form-check-input" type="checkbox" checked id="userInputVarNumCheckbox"><h7>需要改变编号吗？</h7></div><small id="userInputNameHelp" class="form-text text-muted"><b>通配符： </b>$region, $regionnumber<br />- 可用的通配符取决于中的“要重命名的项目”字段 <i>处理（Processing）</i> 以下（below）。</small>                </div>                <!-- Initials -->                <div class="form-group col-md-6" id="initialsGroup"><label for="userInputInitialsLabel">作者名称*</label><input type="text" class="form-control" id="userInputInitials" aria-describedby="userInputInitialsHelp" placeholder="可识别的用户名称或标签" required pattern=".{1,}"><div id="userInitialsError" style="display: none; margin:0;" class="alert alert-warning" role="alert">首字母不能为空!</div><small id="userInputInitialsHelp" class="form-text text-muted">例如"张三" => "ZS"或者"zhangsan"   也可以填写英文名（无法确定版权的建议此处可以做特殊标记）</small>                </div>                <!-- Show -->                <div class="form-group col-md-6"><label for="userInputShowLabel">项目名称（可选）</label><input type="text" class="form-control" id="userInputShow" aria-describedby="userInputShowHelp" placeholder="您正在从事什么项目？"><small id="userInputShowHelp" class="form-text text-muted">如果没有项目，则留空； 根据 UCS 指南，它将自动替换为“NONE”。 （此项目非剪辑项目）</small></div><!-- User Data --><div class="form-group col-md-6"><label for="userDataLabel">数据/注释（可选）</label><input type="text" class="form-control" id="userInputData" aria-describedby="userInputDataHelp" placeholder="麦克风、视角、位置或其他。"><small id="userInputDataHelp" class="form-text text-muted">您还有什么要补充的吗？ 如果没有注释，请留空。</small></div>');
                    $("#processing").html('<i>处理</i>');
                    $("#processingFormRow").html('<div id="copyResultsWarning2" style="display: none;" class="alert alert-warning" role="alert">You currently have "Copy WITHOUT processing" enabled in the settings. Results will be copied to the clipboard, but nothing will be renamed in your session.</div><div class="form-group col-md-6"><h7>要重命名的项目*</h7><select id="userInputItems" class="form-control"><option>区域</option><option>标记</option><option>媒体项目</option><option>轨道</option></select><small id="userInputCategoryHelp" class="form-text text-muted">你想重命名什么？</small></div><div class="form-group col-md-6"><h7>搜索区域*</h7><select id="userInputArea" class="form-control"><option>区域管理器中的选定区域</option><option>编辑光标</option><option>时间选择</option><option>完整项目</option></select><small id="userInputCategoryHelp" class="form-text text-muted">选择您想要影响的项目区域。</small></div>');
                    $("#metadataTitle").html('<i>元数据</i>');
                    $("#metaDescDiv").html('<label for="userDataLabel">描述</label><input type="text" class="form-control" id="userInputMetaDesc" placeholder="文件内容的完整详细说明">');
                    $("#metaTitleDiv").html('<div class="form-group col-md-4" style="margin-left: 15px; margin-right: 15px;"><label for="userDataLabel">标题</label><input type="text" class="form-control" id="userInputMetaTitle" placeholder="简短的标题"></div><div class="form-group col-md-4" style="margin-left: 0px"><label for="userDataLabel">关键词</label><input type="text" class="form-control" id="userInputMetaKeys" placeholder="逗号、分隔符、关键字、标签"></div>');
                    $("#metaMicDiv").html('<div class="form-group col-md-4" style="margin-left: 15px; margin-right: 15px;"><label for="userDataLabel">麦克风</label><input type="text" class="form-control" id="userInputMetaMic" placeholder="Mini MS"></div><div class="form-group col-md-4" style="margin-left: 0px"><label for="userDataLabel">录音设备(AD转换工具)</label><input type="text" class="form-control" id="userInputMetaRecMed"></div>');
                    $("#metaDsgnDiv").html('<div class="form-group col-md-3" style="margin-left: 15px; margin-right: 15px;"><label for="userDataLabel">设计师</label><input type="text" class="form-control" id="userInputMetaDsgnr" placeholder="例如：张三"></div><div class="form-group col-md-3" style="margin-left: 0px"><label for="userDataLabel">信息库（日期）</label><input type="text" class="form-control" id="userInputMetaLib" placeholder="2021年7月"></div><div class="form-group col-md-3" style="margin-left: 0px"><label for="userDataLabel">URL</label><input type="text" class="form-control" id="userInputMetaURL" placeholder="https://aaroncendan.me"></div>');
                    $("#userInputMetaPersp").html('<option>-</option><option>近距离 (CU)</option><option>中等距离 (MED)</option><option>远距离 (DST)</option><option>直接 (DI)</option><option>板载 (OB)</option><option>Various (VARI)</option><option disabled></option><option disabled><i>Specialty</i></option>   <option>Contact (CNTCT)</option><option>Hydrophone (HYDRO)</option><option>Electromagnetic (EMF)</option>');
                    $("#metaIntExtDiv").html('<label for="userDataLabel">室内/室外</label><select id="userInputMetaIntExt" class="form-control" style="margin-top: 0px;"><option>-</option><option>室内 (INT)</option><option>室外 (EXT)</option></select>');
                    $("#metaMicPerspLabel").text('麦克风角度');
                    $("#metaLocDiv").html('<!-- Country --><div class="form-group col-md-3" style="margin-left: 15px; margin-right: 15px;"><label for="userDataLabel" style="margin-bottom: 0px;">地点</label><select name="country" class="form-control countries order-alpha" id="countryId"><option value="">选择国家/地区</option></select><small class="form-text text-muted">国家/地区</small></div><!-- State --><div class="form-group col-md-3" style="margin-left: 0px; margin-top: 35px;"><select name="state" class="form-control states order-alpha" id="stateId"><option value="">选择省份</option></select><small class="form-text text-muted">省份</small></div><!-- City --><div class="form-group col-md-3" style="margin-left: 0px; margin-top: 35px;"><select name="city" class="form-control cities order-alpha limit-pop-10000" id="cityId"><option value="">选择城市</option></select><small class="form-text text-muted">城市</small></div>');
                    $("#formSubmitButton").html('<img class="icons filter-blue" src="ucs_libraries/share.svg" alt="share_icon">&nbsp;&nbsp;<b>提交</b>');

                    // Table
                    $("#dataTable").text('UCS音效系统分类表');
                    $("#UCSTableSubHeading").text('谷歌在线数据库~ UCS v8.2（如无法使用请检查代理）');
                    $("#downloadUCSButtonText").text('点击这里下载离线使用！');
                    $("#reenableOnlineUCSButtonText").text('如果您想使用谷歌表数据重新进入“在线模式”，请点击这里.');
                    $("#downloadUCSButton").html('<img class="icons filter-green" src="ucs_libraries/data-transfer-download.svg" alt="download_icon">&nbsp;&nbsp;<b>下载列表</b>');
                    $("#ucsTableInstrLabel").html('<i>搜索适当的类别，然后单击表格中的一行即可立即填写表格！</i>');
                    $("#haveAGreatDay").html('由&nbsp;<a href="https://aaroncendan.me" target="_blank">Aaron Cendan</a>开发，此项目已在GITHUB开源，此界面由<a href="http://wpa.qq.com/pa?p=2:524541577:41" target="_blank">52HZ Studio</a>修改的中文分支');

                    // $("#").html('');
                    break;
                default:
                    break;
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // CHECK FOR OFFLINE UCS DOC
        // ~~~~~~~~~~~~~~~~~~~~
        function loadOfflineUCSDoc() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    console.log("Found local UCS data file. Entering OFFLINE mode.");
                    useOfflineUSCData(this.responseText);
                }
            };
            xhttp.onloadend = function () {
                if (xhttp.status == 404) {
                    console.log("No local UCS data file found. Entering ONLINE mode (GSheets data).");
                    useGSheetsUSCData();
                }
            }

            // Get language specific offline sheet
            var ucs_lang_file = "";
            if (localStorage.getItem("ucs_language_country") !== null) {
                ucs_lang_file = localStorage.getItem("ucs_language_country");
            } else {
                // Default to English/US
                localStorage.setItem("ucs_language_country", "us");
                ucs_lang_file = "us";
            }
            ucs_lang_file = "ucs_languages/UCS_" + ucs_lang_file + ".txt";

            // Load file
            xhttp.open("GET", ucs_lang_file, true);
            // XML HTTP Cache will try to pull old information if the file is update but keeps the same name.
            // Disable cache controls to get the latest.
            xhttp.setRequestHeader('cache-control', 'no-cache, must-revalidate, post-check=0, pre-check=0');
            xhttp.setRequestHeader('cache-control', 'max-age=0');
            xhttp.setRequestHeader('expires', '0');
            xhttp.setRequestHeader('expires', 'Tue, 01 Jan 1980 1:00:00 GMT');
            xhttp.setRequestHeader('pragma', 'no-cache');
            xhttp.send();
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // CHECK FOR OFFLINE USER PRESETS DOC
        // ~~~~~~~~~~~~~~~~~~~~
        function loadUserPresets() {
            // Load presets
            if (localStorage.getItem("num-presets") !== null) {
                // Found existing number of presets
                var num_presets = parseInt(localStorage.getItem("num-presets"), 10);
                for (var preset_index = 1; preset_index <= num_presets; preset_index++) {
                    if (localStorage.getItem("ucs-preset-" + preset_index) !== null) {
                        // Parse JSON
                        var presetSettings = JSON.parse(localStorage.getItem("ucs-preset-" + preset_index));
                        
                        // Add dropdown element for preset to top of list
                        $("#navbarPresetsDropdownOptions").prepend('<a class="dropdown-item" href="#" id="userPreset' + preset_index + '" onClick="loadUserPreset(' + preset_index + ')" style="display: flex; align-items: center;">' + presetSettings.preset + '</a>');
                        
                        // Add dropdown element to DELETE preset
                        $("#deletePresetSelect").prepend($('<option>', {
                            value: preset_index, 
                            text: presetSettings.preset
                        }));

                        // Load to fields if "Default"
                        if (presetSettings.preset.toUpperCase() == "DEFAULT") loadUserPreset(preset_index);
                    }
                }
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // SHOW PRESET MODAL
        // ~~~~~~~~~~~~~~~~~~~~
        function showPresetModal() {
            $('#presetsModal').modal();
            setTimeout(() => { $('#presetName').focus(); }, 500);
        }

        function showDeletePresetModal() {
            $('#deletePresetsModal').modal();
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // IMPORT/EXPORT PRESETS
        // ~~~~~~~~~~~~~~~~~~~~
        $("#uploadedPresetFile").change(function () {
            // Get uploaded file
            var uploadedPresetFile = document.getElementById('uploadedPresetFile').files[0];
            if (uploadedPresetFile) {
                
                var r = new FileReader();
                r.onload = function(e) { 
                    var presetFileContents = e.target.result;
                    /*
                    alert( "Got the file.n" 
                        +"name: " + uploadedPresetFile.name + "n"
                        +"type: " + uploadedPresetFile.type + "n"
                        +"size: " + uploadedPresetFile.size + " bytesn"
                        + "starts with: " + presetFileContents.substr(1, presetFileContents.indexOf("n"))
                    ); 
                    console.log(presetFileContents);
                    */ 

                    // Validate file
                    if (presetFileContents.includes("exported-preset-file")) {
                        // Clear existing local storage
                        localStorage.clear();

                        // Write local storage using preset file
                        var presetsJSON = JSON.parse(presetFileContents);                        
                        for (var name in presetsJSON) { localStorage.setItem(name, presetsJSON[name] ); }
                        console.log(presetsJSON); 
                        
                        // Reload page
                        location.reload();
                    } else {
                        alert("Invalid settings file! Please only import files that were exported using Settings > Export Data.")
                    }

                }
                r.readAsText(uploadedPresetFile);
            }
        });

        function exportPresetStorage() {
            // Set local storage for preset export
            localStorage.setItem("exported-preset-file", "true");
            
            // Create text file from array input
            var textFile = null,
                makeTextFile = function (arr) {
                    var arrToText = new Blob([JSON.stringify(arr)], { type: 'text/plain' });
                    // If we are replacing a previously generated file we need to
                    // manually revoke the object URL to avoid memory leaks.
                    if (textFile !== null) {
                        window.URL.revokeObjectURL(textFile);
                    }
                    textFile = window.URL.createObjectURL(arrToText);
                    return textFile;
                };

            // Create page element for link to file
            var link = document.createElement('a');
            link.setAttribute('download', 'UCS_Data.txt');
            
            // Write out the whole contents of the localStorage..
            link.href = makeTextFile(localStorage);

            // Spoof user clicking on new download link
            document.body.appendChild(link);
            window.requestAnimationFrame(function () {
                var event = new MouseEvent('click');
                link.dispatchEvent(event);
                document.body.removeChild(link);
            });
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // SAVE CURRENT SETTINGS AS A PRESET
        // ~~~~~~~~~~~~~~~~~~~~
        function saveThisAsPreset() {
            // Hide modal
            $('#presetsModal').modal('hide');            

            //#region Fetch user's settings...            
            var mySettings = {
                presetIndex: preset_index,
                preset: $("#presetName").val(),
                category: $("#userInputCategory").val(),
                subcategory: $("select#userSelectSubCategory option:checked").val(),
                filename: $("#userInputName").val(),
                enumerate: $("#userInputVarNumCheckbox").prop("checked"),
                userCat: $("#userInputUserCat").val(),
                userId: $("#userInputInitials").val(),
                showId: $("#userInputShow").val(),
                userData: $("#userInputData").val(),
                vendorCat: $("#userInputVendCat").val(),
                metaTitle: $("#userInputMetaTitle").val(),
                metaDesc: $("#userInputMetaDesc").val(),
                metaKeys: $("#userInputMetaKeys").val(),
                metaMic: $("#userInputMetaMic").val(),
                metaRecMed: $("#userInputMetaRecMed").val(),
                metaDsgnr: $("#userInputMetaDsgnr").val(),
                metaLib: $("#userInputMetaLib").val(),        
                metaURL: $("#userInputMetaURL").val(),
                metaMftr: $("#userInputMetaManufacturer").val(),
                metaNotes: $("#metaNotes").val(),
                metaCoun: $("#countryId").val(),
                metaState: $("#stateId").val(),
                metaCity: $("#cityId").val(),
                metaUserLoc: $("#userLocId").val(),
                metaPersp: $("#userInputMetaPersp").val(),
                metaConfig: $("#userInputMetaConfig").val(),
                metaIntExt: $("#userInputMetaIntExt").val(),
                userItems: $("#userInputItems").val(),
                userArea: $("#userInputArea").val(),
                gbxSuffix: $("#gbxSuffix").val(),
                ASWGcontentType: $("#ASWGcontentType").val(),
                ASWGproject: $("#ASWGproject").val(),
                ASWGoriginatorStudio: $("#ASWGoriginatorStudio").val(),
                ASWGnotes: $("#ASWGnotes").val(),
                ASWGstate: $("#ASWGstate").val(),
                ASWGeditor: $("#ASWGeditor").val(),
                ASWGmixer: $("#ASWGmixer").val(),
                ASWGfxChainName: $("#ASWGfxChainName").val(),
                ASWGchannelConfig: $("#ASWGchannelConfig").val(),
                ASWGambisonicFormat: $("#ASWGambisonicFormat").val(),
                ASWGambisonicChnOrder: $("#ASWGambisonicChnOrder").val(),
                ASWGambisonicNorm: $("#ASWGambisonicNorm").val(),
                ASWGisDesigned: $("#ASWGisDesigned").val(),
                ASWGrecEngineer: $("#ASWGrecEngineer").val(),
                ASWGrecStudio: $("#ASWGrecStudio").val(),
                ASWGimpulseLocation: $("#ASWGimpulseLocation").val(),
                ASWGtext: $("#ASWGtext").val(),
                ASWGefforts: $("#ASWGefforts").val(),
                ASWGeffortType: $("#ASWGeffortType").val(),
                ASWGprojection: $("#ASWGprojection").val(),
                ASWGlanguage: $("#ASWGlanguage").val(),
                ASWGtimingRestriction: $("#ASWGtimingRestriction").val(),
                ASWGcharacterName: $("#ASWGcharacterName").val(),
                ASWGcharacterGender: $("#ASWGcharacterGender").val(),
                ASWGcharacterAge: $("#ASWGcharacterAge").val(),
                ASWGcharacterRole: $("#ASWGcharacterRole").val(),
                ASWGactorName: $("#ASWGactorName").val(),
                ASWGactorGender: $("#ASWGactorGender").val(),
                ASWGdirection: $("#ASWGdirection").val(),
                ASWGdirector: $("#ASWGdirector").val(),
                ASWGfxUsed: $("#ASWGfxUsed").val(),
                ASWGusageRights: $("#ASWGusageRights").val(),
                ASWGisUnion: $("#ASWGisUnion").val(),
                ASWGaccent: $("#ASWGaccent").val(),
                ASWGemotion: $("#ASWGemotion").val(),
                ASWGcomposer: $("#ASWGcomposer").val(),
                ASWGartist: $("#ASWGartist").val(),
                ASWGsongTitle: $("#ASWGsongTitle").val(),
                ASWGgenre: $("#ASWGgenre").val(),
                ASWGsubGenre: $("#ASWGsubGenre").val(),
                ASWGproducer: $("#ASWGproducer").val(),
                ASWGmusicSup: $("#ASWGmusicSup").val(),
                ASWGinstrument: $("#ASWGinstrument").val(),
                ASWGmusicPublisher: $("#ASWGmusicPublisher").val(),
                ASWGrightsOwner: $("#ASWGrightsOwner").val(),
                ASWGintensity: $("#ASWGintensity").val(),
                ASWGorderRef: $("#ASWGorderRef").val(),
                ASWGisSource: $("#ASWGisSource").val(),
                ASWGisLoop: $("#ASWGisLoop").val(),
                ASWGisFinal: $("#ASWGisFinal").val(),
                ASWGisOst: $("#ASWGisOst").val(),
                ASWGisCinematic: $("#ASWGisCinematic").val(),
                ASWGisLicensed: $("#ASWGisLicensed").val(),
                ASWGisDiegetic: $("#ASWGisDiegetic").val(),
                ASWGmusicVersion: $("#ASWGmusicVersion").val(),
                ASWGisrcId: $("#ASWGisrcId").val(),
                ASWGtempo: $("#ASWGtempo").val(),
                ASWGtimeSig: $("#ASWGtimeSig").val(),
                ASWGinKey: $("#ASWGinKey").val(),
                ASWGbillingCode: $("#ASWGbillingCode").val()
            }
            console.log(mySettings);
            //#endregion
            
            // Get/update number of user presets in local storage
            var preset_index = 0;
            var edit_mode = false;
            if (localStorage.getItem("num-presets") !== null) {
                // Check to see if an existing preset has the same name. Delete if so
                var num_presets = parseInt(localStorage.getItem("num-presets"), 10);
                for (var preset_idx = 1; preset_idx <= num_presets; preset_idx++) {
                    if (localStorage.getItem("ucs-preset-" + preset_idx) !== null) {                        
                        var presetSettings = JSON.parse(localStorage.getItem("ucs-preset-" + preset_idx));
                        // Found a match
                        if (presetSettings.preset === mySettings.preset) {                                                    
                            localStorage.removeItem("ucs-preset-" + preset_idx);
                            console.log("Edited preset: " + presetSettings.preset);
                            edit_mode = true;
                            preset_index = preset_idx;
                        }                    
                    }
                }                
                // Didn't find existing preset with same name
                if (!edit_mode) {
                    preset_index = parseInt(localStorage.getItem("num-presets"), 10) + 1;
                    localStorage.setItem("num-presets", preset_index.toString());
                    console.log("Added preset: " + mySettings.preset);
                }
            } else {
                // No presets stored yet
                localStorage.setItem("num-presets", "1");
                preset_index = 1;
                console.log("Started new preset collection: " + mySettings.preset);
            }

            // Store current preset
            var settingsString = JSON.stringify(mySettings);
            localStorage.setItem("ucs-preset-" + preset_index,settingsString);
            
            // Update dropdowns
            if (!edit_mode) {
                // Add dropdown element for preset to top of list
                $("#navbarPresetsDropdownOptions").prepend('<a class="dropdown-item" href="#" id="userPreset' + preset_index + '" onClick="loadUserPreset(' + preset_index + ')" style="display: flex; align-items: center;">' + mySettings.preset + '</a>');
            
                // Add dropdown element to DELETE preset
                $("#deletePresetSelect").prepend($('<option>', {
                    value: preset_index, 
                    text: mySettings.preset
                }));
            }

            // Clear out preset name entry spot. Just kidding! Useful for edits.
            // $("#presetName").val("").trigger('change');
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // LOAD USER PRESETS
        // ~~~~~~~~~~~~~~~~~~~~
        function loadUserPreset(index) {
            // Close presets dropdown menu, if open
            if ($('#navbarPresetsDropdownOptions').hasClass("show")) $("#navbarPresetsDropdown").dropdown("toggle");
            
            // Fetch preset
            var presetSettings = JSON.parse(localStorage.getItem("ucs-preset-" + index));
            
            //#region Set values
            console.log("Loading preset number: " + index);
            if (presetSettings.category && presetSettings.category !== "") $("#userInputCategory").val(presetSettings.category).trigger('change');
            if (presetSettings.subcategory && presetSettings.subcategory !== "Please select a category!") $("#userSelectSubCategory").val(presetSettings.subcategory).trigger('change');
            if (presetSettings.filename && presetSettings.filename !== "") $("#userInputName").val(presetSettings.filename).trigger('change');            
            if (presetSettings.userCat && presetSettings.userCat !== "") $("#userInputUserCat").val(presetSettings.userCat).trigger('change');
            if (presetSettings.userId && presetSettings.userId !== "") $("#userInputInitials").val(presetSettings.userId).trigger('change');
            if (presetSettings.showId && presetSettings.showId !== "") $("#userInputShow").val(presetSettings.showId).trigger('change');
            if (presetSettings.userData && presetSettings.userData !== "") $("#userInputData").val(presetSettings.userData).trigger('change');
            if (presetSettings.vendorCat && presetSettings.vendorCat !== "") $("#userInputVendCat").val(presetSettings.vendorCat).trigger('change');
            if (presetSettings.metaTitle && presetSettings.metaTitle !== "") $("#userInputMetaTitle").val(presetSettings.metaTitle).trigger('change');
            if (presetSettings.metaDesc && presetSettings.metaDesc !== "") $("#userInputMetaDesc").val(presetSettings.metaDesc).trigger('change');
            if (presetSettings.metaKeys && presetSettings.metaKeys !== "") $("#userInputMetaKeys").val(presetSettings.metaKeys).trigger('change');
            if (presetSettings.metaMic && presetSettings.metaMic !== "") $("#userInputMetaMic").val(presetSettings.metaMic).trigger('change');
            if (presetSettings.metaRecMed && presetSettings.metaRecMed !== "") $("#userInputMetaRecMed").val(presetSettings.metaRecMed).trigger('change');
            if (presetSettings.metaDsgnr && presetSettings.metaDsgnr !== "") $("#userInputMetaDsgnr").val(presetSettings.metaDsgnr).trigger('change');
            if (presetSettings.metaLib && presetSettings.metaLib !== "") $("#userInputMetaLib").val(presetSettings.metaLib).trigger('change');
            if (presetSettings.metaURL && presetSettings.metaURL !== "") $("#userInputMetaURL").val(presetSettings.metaURL).trigger('change');
            if (presetSettings.metaMftr && presetSettings.metaMftr !== "") $("#userInputMetaManufacturer").val(presetSettings.metaMftr).trigger('change');
            if (presetSettings.metaNotes && presetSettings.metaNotes !== "") $("#metaNotes").val(presetSettings.metaNotes).trigger('change');
            if (presetSettings.metaCoun && presetSettings.metaCoun !== "") setTimeout(() => { $("#countryId").val(presetSettings.metaCoun).trigger('change'); }, 500);
            if (presetSettings.metaState && presetSettings.metaState !== "") setTimeout(() => { $("#stateId").val(presetSettings.metaState).trigger('change'); }, 1000);
            if (presetSettings.metaCity && presetSettings.metaCity !== "") setTimeout(() => { $("#cityId").val(presetSettings.metaCity).trigger('change'); }, 1500);            
            if (presetSettings.metaUserLoc && presetSettings.metaUserLoc !== "") $("#userLocId").val(presetSettings.metaUserLoc).trigger('change');
            if (presetSettings.metaPersp && presetSettings.metaPersp !== "-") $("#userInputMetaPersp").val(presetSettings.metaPersp).trigger('change');
            if (presetSettings.metaIntExt && presetSettings.metaIntExt !== "-") $("#userInputMetaIntExt").val(presetSettings.metaIntExt).trigger('change');
            if (presetSettings.userItems && presetSettings.userItems !== "") $("#userInputItems").val(presetSettings.userItems).trigger('change');
            if (presetSettings.gbxSuffix && presetSettings.gbxSuffix !== "") $("#gbxSuffix").val(presetSettings.gbxSuffix).trigger('change');
            if (presetSettings.userArea && presetSettings.userArea !== "") $("#userInputArea").val(presetSettings.userArea).trigger('change');
            $("#userInputVarNumCheckbox").prop("checked",presetSettings.enumerate);

            if (presetSettings.ASWGcontentType && presetSettings.ASWGcontentType !== "-") $("#ASWGcontentType").val(presetSettings.ASWGcontentType).trigger('change');
            if (presetSettings.ASWGproject && presetSettings.ASWGproject !== "") $("#ASWGproject").val(presetSettings.ASWGproject).trigger('change');
            if (presetSettings.ASWGoriginatorStudio && presetSettings.ASWGoriginatorStudio !== "") $("#ASWGoriginatorStudio").val(presetSettings.ASWGoriginatorStudio).trigger('change');
            if (presetSettings.ASWGnotes && presetSettings.ASWGnotes !== "") $("#ASWGnotes").val(presetSettings.ASWGnotes).trigger('change');
            if (presetSettings.ASWGstate && presetSettings.ASWGstate !== "-") $("#ASWGstate").val(presetSettings.ASWGstate).trigger('change');
            if (presetSettings.ASWGeditor && presetSettings.ASWGeditor !== "") $("#ASWGeditor").val(presetSettings.ASWGeditor).trigger('change');
            if (presetSettings.ASWGmixer && presetSettings.ASWGmixer !== "") $("#ASWGmixer").val(presetSettings.ASWGmixer).trigger('change');
            if (presetSettings.ASWGfxChainName && presetSettings.ASWGfxChainName !== "") $("#ASWGfxChainName").val(presetSettings.ASWGfxChainName).trigger('change');
            if (presetSettings.ASWGchannelConfig && presetSettings.ASWGchannelConfig !== "-") $("#ASWGchannelConfig").val(presetSettings.ASWGchannelConfig).trigger('change');
            if (presetSettings.ASWGambisonicFormat && presetSettings.ASWGambisonicFormat !== "") $("#ASWGambisonicFormat").val(presetSettings.ASWGambisonicFormat).trigger('change');
            if (presetSettings.ASWGambisonicChnOrder && presetSettings.ASWGambisonicChnOrder !== "-") $("#ASWGambisonicChnOrder").val(presetSettings.ASWGambisonicChnOrder).trigger('change');
            if (presetSettings.ASWGambisonicNorm && presetSettings.ASWGambisonicNorm !== "-") $("#ASWGambisonicNorm").val(presetSettings.ASWGambisonicNorm).trigger('change');
            if (presetSettings.ASWGisDesigned && presetSettings.ASWGisDesigned !== "-") $("#ASWGisDesigned").val(presetSettings.ASWGisDesigned).trigger('change');
            if (presetSettings.ASWGrecEngineer && presetSettings.ASWGrecEngineer !== "") $("#ASWGrecEngineer").val(presetSettings.ASWGrecEngineer).trigger('change');
            if (presetSettings.ASWGrecStudio && presetSettings.ASWGrecStudio !== "") $("#ASWGrecStudio").val(presetSettings.ASWGrecStudio).trigger('change');
            if (presetSettings.ASWGimpulseLocation && presetSettings.ASWGimpulseLocation !== "") $("#ASWGimpulseLocation").val(presetSettings.ASWGimpulseLocation).trigger('change');
            if (presetSettings.ASWGtext && presetSettings.ASWGtext !== "") $("#ASWGtext").val(presetSettings.ASWGtext).trigger('change');
            if (presetSettings.ASWGefforts && presetSettings.ASWGefforts !== "-") $("#ASWGefforts").val(presetSettings.ASWGefforts).trigger('change');
            if (presetSettings.ASWGeffortType && presetSettings.ASWGeffortType !== "") $("#ASWGeffortType").val(presetSettings.ASWGeffortType).trigger('change');
            if (presetSettings.ASWGprojection && presetSettings.ASWGprojection !== "-") $("#ASWGprojection").val(presetSettings.ASWGprojection).trigger('change');
            if (presetSettings.ASWGlanguage && presetSettings.ASWGlanguage !== "-") $("#ASWGlanguage").val(presetSettings.ASWGlanguage).trigger('change');
            if (presetSettings.ASWGtimingRestriction && presetSettings.ASWGtimingRestriction !== "-") $("#ASWGtimingRestriction").val(presetSettings.ASWGtimingRestriction).trigger('change');
            if (presetSettings.ASWGcharacterName && presetSettings.ASWGcharacterName !== "") $("#ASWGcharacterName").val(presetSettings.ASWGcharacterName).trigger('change');
            if (presetSettings.ASWGcharacterGender && presetSettings.ASWGcharacterGender !== "-") $("#ASWGcharacterGender").val(presetSettings.ASWGcharacterGender).trigger('change');
            if (presetSettings.ASWGcharacterAge && presetSettings.ASWGcharacterAge !== "") $("#ASWGcharacterAge").val(presetSettings.ASWGcharacterAge).trigger('change');
            if (presetSettings.ASWGcharacterRole && presetSettings.ASWGcharacterRole !== "-") $("#ASWGcharacterRole").val(presetSettings.ASWGcharacterRole).trigger('change');
            if (presetSettings.ASWGactorName && presetSettings.ASWGactorName !== "") $("#ASWGactorName").val(presetSettings.ASWGactorName).trigger('change');
            if (presetSettings.ASWGactorGender && presetSettings.ASWGactorGender !== "-") $("#ASWGactorGender").val(presetSettings.ASWGactorGender).trigger('change');
            if (presetSettings.ASWGdirection && presetSettings.ASWGdirection !== "") $("#ASWGdirection").val(presetSettings.ASWGdirection).trigger('change');
            if (presetSettings.ASWGdirector && presetSettings.ASWGdirector !== "") $("#ASWGdirector").val(presetSettings.ASWGdirector).trigger('change');
            if (presetSettings.ASWGfxUsed && presetSettings.ASWGfxUsed !== "") $("#ASWGfxUsed").val(presetSettings.ASWGfxUsed).trigger('change');
            if (presetSettings.ASWGusageRights && presetSettings.ASWGusageRights !== "") $("#ASWGusageRights").val(presetSettings.ASWGusageRights).trigger('change');
            if (presetSettings.ASWGisUnion && presetSettings.ASWGisUnion !== "-") $("#ASWGisUnion").val(presetSettings.ASWGisUnion).trigger('change');
            if (presetSettings.ASWGaccent && presetSettings.ASWGaccent !== "") $("#ASWGaccent").val(presetSettings.ASWGaccent).trigger('change');
            if (presetSettings.ASWGemotion && presetSettings.ASWGemotion !== "") $("#ASWGemotion").val(presetSettings.ASWGemotion).trigger('change');
            if (presetSettings.ASWGcomposer && presetSettings.ASWGcomposer !== "") $("#ASWGcomposer").val(presetSettings.ASWGcomposer).trigger('change');
            if (presetSettings.ASWGartist && presetSettings.ASWGartist !== "") $("#ASWGartist").val(presetSettings.ASWGartist).trigger('change');
            if (presetSettings.ASWGsongTitle && presetSettings.ASWGsongTitle !== "") $("#ASWGsongTitle").val(presetSettings.ASWGsongTitle).trigger('change');
            if (presetSettings.ASWGgenre && presetSettings.ASWGgenre !== "") $("#ASWGgenre").val(presetSettings.ASWGgenre).trigger('change');
            if (presetSettings.ASWGsubGenre && presetSettings.ASWGsubGenre !== "") $("#ASWGsubGenre").val(presetSettings.ASWGsubGenre).trigger('change');
            if (presetSettings.ASWGproducer && presetSettings.ASWGproducer !== "") $("#ASWGproducer").val(presetSettings.ASWGproducer).trigger('change');
            if (presetSettings.ASWGmusicSup && presetSettings.ASWGmusicSup !== "") $("#ASWGmusicSup").val(presetSettings.ASWGmusicSup).trigger('change');
            if (presetSettings.ASWGinstrument && presetSettings.ASWGinstrument !== "") $("#ASWGinstrument").val(presetSettings.ASWGinstrument).trigger('change');
            if (presetSettings.ASWGmusicPublisher && presetSettings.ASWGmusicPublisher !== "") $("#ASWGmusicPublisher").val(presetSettings.ASWGmusicPublisher).trigger('change');
            if (presetSettings.ASWGrightsOwner && presetSettings.ASWGrightsOwner !== "") $("#ASWGrightsOwner").val(presetSettings.ASWGrightsOwner).trigger('change');
            if (presetSettings.ASWGintensity && presetSettings.ASWGintensity !== "") $("#ASWGintensity").val(presetSettings.ASWGintensity).trigger('change');
            if (presetSettings.ASWGorderRef && presetSettings.ASWGorderRef !== "") $("#ASWGorderRef").val(presetSettings.ASWGorderRef).trigger('change');
            if (presetSettings.ASWGisSource && presetSettings.ASWGisSource !== "-") $("#ASWGisSource").val(presetSettings.ASWGisSource).trigger('change');
            if (presetSettings.ASWGisLoop && presetSettings.ASWGisLoop !== "-") $("#ASWGisLoop").val(presetSettings.ASWGisLoop).trigger('change');
            if (presetSettings.ASWGisFinal && presetSettings.ASWGisFinal !== "-") $("#ASWGisFinal").val(presetSettings.ASWGisFinal).trigger('change');
            if (presetSettings.ASWGisOst && presetSettings.ASWGisOst !== "-") $("#ASWGisOst").val(presetSettings.ASWGisOst).trigger('change');
            if (presetSettings.ASWGisCinematic && presetSettings.ASWGisCinematic !== "-") $("#ASWGisCinematic").val(presetSettings.ASWGisCinematic).trigger('change');
            if (presetSettings.ASWGisLicensed && presetSettings.ASWGisLicensed !== "-") $("#ASWGisLicensed").val(presetSettings.ASWGisLicensed).trigger('change');
            if (presetSettings.ASWGisDiegetic && presetSettings.ASWGisDiegetic !== "-") $("#ASWGisDiegetic").val(presetSettings.ASWGisDiegetic).trigger('change');
            if (presetSettings.ASWGmusicVersion && presetSettings.ASWGmusicVersion !== "") $("#ASWGmusicVersion").val(presetSettings.ASWGmusicVersion).trigger('change');
            if (presetSettings.ASWGisrcId && presetSettings.ASWGisrcId !== "") $("#ASWGisrcId").val(presetSettings.ASWGisrcId).trigger('change');
            if (presetSettings.ASWGtempo && presetSettings.ASWGtempo !== "") $("#ASWGtempo").val(presetSettings.ASWGtempo).trigger('change');
            if (presetSettings.ASWGtimeSig && presetSettings.ASWGtimeSig !== "") $("#ASWGtimeSig").val(presetSettings.ASWGtimeSig).trigger('change');
            if (presetSettings.ASWGinKey && presetSettings.ASWGinKey !== "") $("#ASWGinKey").val(presetSettings.ASWGinKey).trigger('change');
            if (presetSettings.ASWGbillingCode && presetSettings.ASWGbillingCode !== "") $("#ASWGbillingCode").val(presetSettings.ASWGbillingCode).trigger('change');
            //#endregion

            // Mic config requires a little bit of extra work due to the ambisonics modal
            if (presetSettings.metaConfig && presetSettings.metaConfig !== "-") {
                if (presetSettings.metaConfig.includes("Ambisonic")) $("#customAmbi").text(presetSettings.metaConfig);
                $("#userInputMetaConfig").val(presetSettings.metaConfig).trigger('change');
            }

            // Set preset edit textbox value
            $("#presetName").val(presetSettings.preset).trigger('change');
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // DELETE USER PRESETS
        // ~~~~~~~~~~~~~~~~~~~~
        function deleteThisPreset() {
            // Get index of selected option
            var preset_index_to_delete = parseInt($("#deletePresetSelect").val(), 10);
            
            // Fetch presets
            if (localStorage.getItem("num-presets") !== null) {
                // Found existing number of presets
                var num_presets = parseInt(localStorage.getItem("num-presets"), 10);
                for (var preset_index = 1; preset_index <= num_presets; preset_index++) {
                    // Delete the selected preset 
                    if (localStorage.getItem("ucs-preset-" + preset_index) !== null && preset_index == preset_index_to_delete) {                        
                        var presetSettings = JSON.parse(localStorage.getItem("ucs-preset-" + preset_index));
                        localStorage.removeItem("ucs-preset-" + preset_index_to_delete);
                        console.log("Deleted preset: " + presetSettings.preset);
                        
                        // Update dropdown elements for preset to top of list
                        $("#userPreset" + preset_index).remove();
                        
                        // Update dropdown elements for DELETE presets
                        $("#deletePresetSelect option[value=" + preset_index_to_delete + "]").remove();
                    }
                }
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // SAVE CURRENT SETTINGS TO HISTORY
        // ~~~~~~~~~~~~~~~~~~~~
        function saveThisHistory() {
            // Get user's settings            
            var currentCatID = getCatID($("#userInputCategory").val(), $("select#userSelectSubCategory option:checked").val());
            if ($("#userInputName").val().length > 14) {
                var historyName = month + "/" + day + ": " + currentCatID + "_" + $("#userInputName").val().substring(0,12) + "..."
            } else {
                var historyName = month + "/" + day + ": " + currentCatID + "_" + $("select#userSelectSubCategory option:checked").val() + " " + $("#userInputName").val();
            }

            //#region Fetch user's settings
            var mySettings = {
                presetIndex: history_index,
                preset: historyName,
                category: $("#userInputCategory").val(),
                subcategory: $("select#userSelectSubCategory option:checked").val(),
                filename: $("#userInputName").val(),
                enumerate: $("#userInputVarNumCheckbox").prop("checked"),
                userCat: $("#userInputUserCat").val(),
                userId: $("#userInputInitials").val(),
                showId: $("#userInputShow").val(),
                userData: $("#userInputData").val(),
                vendorCat: $("#userInputVendCat").val(),
                metaTitle: $("#userInputMetaTitle").val(),
                metaDesc: $("#userInputMetaDesc").val(),
                metaKeys: $("#userInputMetaKeys").val(),
                metaMic: $("#userInputMetaMic").val(),
                metaRecMed: $("#userInputMetaRecMed").val(),
                metaDsgnr: $("#userInputMetaDsgnr").val(),
                metaLib: $("#userInputMetaLib").val(),        
                metaURL: $("#userInputMetaURL").val(),
                metaMftr: $("#userInputMetaManufacturer").val(),
                metaNotes: $("#metaNotes").val(),
                metaCoun: $("#countryId").val(),
                metaState: $("#stateId").val(),
                metaCity: $("#cityId").val(),
                metaUserLoc: $("#userLocId").val(),
                metaPersp: $("#userInputMetaPersp").val(),
                metaConfig: $("#userInputMetaConfig").val(),
                metaIntExt: $("#userInputMetaIntExt").val(),
                userItems: $("#userInputItems").val(),
                userArea: $("#userInputArea").val(),
                gbxSuffix: $("#gbxSuffix").val(),
                ASWGcontentType: $("#ASWGcontentType").val(),
                ASWGproject: $("#ASWGproject").val(),
                ASWGoriginatorStudio: $("#ASWGoriginatorStudio").val(),
                ASWGnotes: $("#ASWGnotes").val(),
                ASWGstate: $("#ASWGstate").val(),
                ASWGeditor: $("#ASWGeditor").val(),
                ASWGmixer: $("#ASWGmixer").val(),
                ASWGfxChainName: $("#ASWGfxChainName").val(),
                ASWGchannelConfig: $("#ASWGchannelConfig").val(),
                ASWGambisonicFormat: $("#ASWGambisonicFormat").val(),
                ASWGambisonicChnOrder: $("#ASWGambisonicChnOrder").val(),
                ASWGambisonicNorm: $("#ASWGambisonicNorm").val(),
                ASWGisDesigned: $("#ASWGisDesigned").val(),
                ASWGrecEngineer: $("#ASWGrecEngineer").val(),
                ASWGrecStudio: $("#ASWGrecStudio").val(),
                ASWGimpulseLocation: $("#ASWGimpulseLocation").val(),
                ASWGtext: $("#ASWGtext").val(),
                ASWGefforts: $("#ASWGefforts").val(),
                ASWGeffortType: $("#ASWGeffortType").val(),
                ASWGprojection: $("#ASWGprojection").val(),
                ASWGlanguage: $("#ASWGlanguage").val(),
                ASWGtimingRestriction: $("#ASWGtimingRestriction").val(),
                ASWGcharacterName: $("#ASWGcharacterName").val(),
                ASWGcharacterGender: $("#ASWGcharacterGender").val(),
                ASWGcharacterAge: $("#ASWGcharacterAge").val(),
                ASWGcharacterRole: $("#ASWGcharacterRole").val(),
                ASWGactorName: $("#ASWGactorName").val(),
                ASWGactorGender: $("#ASWGactorGender").val(),
                ASWGdirection: $("#ASWGdirection").val(),
                ASWGdirector: $("#ASWGdirector").val(),
                ASWGfxUsed: $("#ASWGfxUsed").val(),
                ASWGusageRights: $("#ASWGusageRights").val(),
                ASWGisUnion: $("#ASWGisUnion").val(),
                ASWGaccent: $("#ASWGaccent").val(),
                ASWGemotion: $("#ASWGemotion").val(),
                ASWGcomposer: $("#ASWGcomposer").val(),
                ASWGartist: $("#ASWGartist").val(),
                ASWGsongTitle: $("#ASWGsongTitle").val(),
                ASWGgenre: $("#ASWGgenre").val(),
                ASWGsubGenre: $("#ASWGsubGenre").val(),
                ASWGproducer: $("#ASWGproducer").val(),
                ASWGmusicSup: $("#ASWGmusicSup").val(),
                ASWGinstrument: $("#ASWGinstrument").val(),
                ASWGmusicPublisher: $("#ASWGmusicPublisher").val(),
                ASWGrightsOwner: $("#ASWGrightsOwner").val(),
                ASWGintensity: $("#ASWGintensity").val(),
                ASWGorderRef: $("#ASWGorderRef").val(),
                ASWGisSource: $("#ASWGisSource").val(),
                ASWGisLoop: $("#ASWGisLoop").val(),
                ASWGisFinal: $("#ASWGisFinal").val(),
                ASWGisOst: $("#ASWGisOst").val(),
                ASWGisCinematic: $("#ASWGisCinematic").val(),
                ASWGisLicensed: $("#ASWGisLicensed").val(),
                ASWGisDiegetic: $("#ASWGisDiegetic").val(),
                ASWGmusicVersion: $("#ASWGmusicVersion").val(),
                ASWGisrcId: $("#ASWGisrcId").val(),
                ASWGtempo: $("#ASWGtempo").val(),
                ASWGtimeSig: $("#ASWGtimeSig").val(),
                ASWGinKey: $("#ASWGinKey").val(),
                ASWGbillingCode: $("#ASWGbillingCode").val()
            }
            console.log(mySettings);
            //#endregion
            
            // Get/update number of user history in local storage
            var history_index = 0;
            var edit_mode = false;
            if (localStorage.getItem("num-history") !== null) {

                // Increment index
                var num_history = parseInt(localStorage.getItem("num-history"), 10);
                history_index = parseInt(localStorage.getItem("num-history"), 10) + 1;
                localStorage.setItem("num-history", history_index.toString());

            } else {
                // No history stored yet
                localStorage.setItem("num-history", "1");
                history_index = 1;
            }

            // Store current history
            var settingsString = JSON.stringify(mySettings);
            localStorage.setItem("ucs-history-" + history_index,settingsString);
            
            // Add dropdown element for this history to top of list
            $("#navbarHistoryDropdownOptions").prepend('<a class="dropdown-item" href="#" id="userHistory' + history_index + '" onClick="loadThisHistory(' + history_index + ')" style="display: flex; align-items: center;">' + mySettings.preset + '</a>');
        
            // Delete old history
            deleteOldHistory();
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // LOAD SPECIFIC HISTORY
        // ~~~~~~~~~~~~~~~~~~~~
        function loadThisHistory(index) {
            // Close presets dropdown menu, if open
            if ($('#navbarHistoryDropdownOptions').hasClass("show")) $("#navbarHistoryDropdown").dropdown("toggle");
            
            // Fetch preset
            var historySettings = JSON.parse(localStorage.getItem("ucs-history-" + index));
            
            //#region Set values
            console.log("Loading history number: " + index);
            if (historySettings.category && historySettings.category !== "") $("#userInputCategory").val(historySettings.category).trigger('change');
            if (historySettings.subcategory && historySettings.subcategory !== "Please select a category!") $("#userSelectSubCategory").val(historySettings.subcategory).trigger('change');
            if (historySettings.filename && historySettings.filename !== "") $("#userInputName").val(historySettings.filename).trigger('change');            
            if (historySettings.userCat && historySettings.userCat !== "") $("#userInputUserCat").val(historySettings.userCat).trigger('change');
            if (historySettings.userId && historySettings.userId !== "") $("#userInputInitials").val(historySettings.userId).trigger('change');
            if (historySettings.showId && historySettings.showId !== "") $("#userInputShow").val(historySettings.showId).trigger('change');
            if (historySettings.userData && historySettings.userData !== "") $("#userInputData").val(historySettings.userData).trigger('change');
            if (historySettings.vendorCat && historySettings.vendorCat !== "") $("#userInputVendCat").val(historySettings.vendorCat).trigger('change');
            if (historySettings.metaTitle && historySettings.metaTitle !== "") $("#userInputMetaTitle").val(historySettings.metaTitle).trigger('change');
            if (historySettings.metaDesc && historySettings.metaDesc !== "") $("#userInputMetaDesc").val(historySettings.metaDesc).trigger('change');
            if (historySettings.metaKeys && historySettings.metaKeys !== "") $("#userInputMetaKeys").val(historySettings.metaKeys).trigger('change');
            if (historySettings.metaMic && historySettings.metaMic !== "") $("#userInputMetaMic").val(historySettings.metaMic).trigger('change');
            if (historySettings.metaRecMed && historySettings.metaRecMed !== "") $("#userInputMetaRecMed").val(historySettings.metaRecMed).trigger('change');
            if (historySettings.metaDsgnr && historySettings.metaDsgnr !== "") $("#userInputMetaDsgnr").val(historySettings.metaDsgnr).trigger('change');
            if (historySettings.metaLib && historySettings.metaLib !== "") $("#userInputMetaLib").val(historySettings.metaLib).trigger('change');
            if (historySettings.metaURL && historySettings.metaURL !== "") $("#userInputMetaURL").val(historySettings.metaURL).trigger('change');
            if (historySettings.metaMftr && historySettings.metaMftr !== "") $("#userInputMetaManufacturer").val(historySettings.metaMftr).trigger('change');    
            if (historySettings.metaNotes && historySettings.metaNotes !== "") $("#metaNotes").val(historySettings.metaNotes).trigger('change');        
            if (historySettings.metaCoun && historySettings.metaCoun !== "") setTimeout(() => { $("#countryId").val(historySettings.metaCoun).trigger('change'); }, 500);
            if (historySettings.metaState && historySettings.metaState !== "") setTimeout(() => { $("#stateId").val(historySettings.metaState).trigger('change'); }, 1000);
            if (historySettings.metaCity && historySettings.metaCity !== "") setTimeout(() => { $("#cityId").val(historySettings.metaCity).trigger('change'); }, 1500);            
            if (historySettings.metaUserLoc && historySettings.metaUserLoc !== "") $("#userLocId").val(historySettings.metaUserLoc).trigger('change');
            if (historySettings.metaPersp && historySettings.metaPersp !== "-") $("#userInputMetaPersp").val(historySettings.metaPersp).trigger('change');
            if (historySettings.metaIntExt && historySettings.metaIntExt !== "-") $("#userInputMetaIntExt").val(historySettings.metaIntExt).trigger('change');
            if (historySettings.userItems && historySettings.userItems !== "") $("#userInputItems").val(historySettings.userItems).trigger('change');
            if (historySettings.userArea && historySettings.userArea !== "") $("#userInputArea").val(historySettings.userArea).trigger('change');
            if (historySettings.gbxSuffix && historySettings.gbxSuffix !== "") $("#gbxSuffix").val(historySettings.gbxSuffix).trigger('change');
            $("#userInputVarNumCheckbox").prop("checked",historySettings.enumerate);

            if (historySettings.ASWGcontentType && historySettings.ASWGcontentType !== "-") $("#ASWGcontentType").val(historySettings.ASWGcontentType).trigger('change');
            if (historySettings.ASWGproject && historySettings.ASWGproject !== "") $("#ASWGproject").val(historySettings.ASWGproject).trigger('change');
            if (historySettings.ASWGoriginatorStudio && historySettings.ASWGoriginatorStudio !== "") $("#ASWGoriginatorStudio").val(historySettings.ASWGoriginatorStudio).trigger('change');
            if (historySettings.ASWGnotes && historySettings.ASWGnotes !== "") $("#ASWGnotes").val(historySettings.ASWGnotes).trigger('change');
            if (historySettings.ASWGstate && historySettings.ASWGstate !== "-") $("#ASWGstate").val(historySettings.ASWGstate).trigger('change');
            if (historySettings.ASWGeditor && historySettings.ASWGeditor !== "") $("#ASWGeditor").val(historySettings.ASWGeditor).trigger('change');
            if (historySettings.ASWGmixer && historySettings.ASWGmixer !== "") $("#ASWGmixer").val(historySettings.ASWGmixer).trigger('change');
            if (historySettings.ASWGfxChainName && historySettings.ASWGfxChainName !== "") $("#ASWGfxChainName").val(historySettings.ASWGfxChainName).trigger('change');
            if (historySettings.ASWGchannelConfig && historySettings.ASWGchannelConfig !== "-") $("#ASWGchannelConfig").val(historySettings.ASWGchannelConfig).trigger('change');
            if (historySettings.ASWGambisonicFormat && historySettings.ASWGambisonicFormat !== "") $("#ASWGambisonicFormat").val(historySettings.ASWGambisonicFormat).trigger('change');
            if (historySettings.ASWGambisonicChnOrder && historySettings.ASWGambisonicChnOrder !== "-") $("#ASWGambisonicChnOrder").val(historySettings.ASWGambisonicChnOrder).trigger('change');
            if (historySettings.ASWGambisonicNorm && historySettings.ASWGambisonicNorm !== "-") $("#ASWGambisonicNorm").val(historySettings.ASWGambisonicNorm).trigger('change');
            if (historySettings.ASWGisDesigned && historySettings.ASWGisDesigned !== "-") $("#ASWGisDesigned").val(historySettings.ASWGisDesigned).trigger('change');
            if (historySettings.ASWGrecEngineer && historySettings.ASWGrecEngineer !== "") $("#ASWGrecEngineer").val(historySettings.ASWGrecEngineer).trigger('change');
            if (historySettings.ASWGrecStudio && historySettings.ASWGrecStudio !== "") $("#ASWGrecStudio").val(historySettings.ASWGrecStudio).trigger('change');
            if (historySettings.ASWGimpulseLocation && historySettings.ASWGimpulseLocation !== "") $("#ASWGimpulseLocation").val(historySettings.ASWGimpulseLocation).trigger('change');
            if (historySettings.ASWGtext && historySettings.ASWGtext !== "") $("#ASWGtext").val(historySettings.ASWGtext).trigger('change');
            if (historySettings.ASWGefforts && historySettings.ASWGefforts !== "-") $("#ASWGefforts").val(historySettings.ASWGefforts).trigger('change');
            if (historySettings.ASWGeffortType && historySettings.ASWGeffortType !== "") $("#ASWGeffortType").val(historySettings.ASWGeffortType).trigger('change');
            if (historySettings.ASWGprojection && historySettings.ASWGprojection !== "-") $("#ASWGprojection").val(historySettings.ASWGprojection).trigger('change');
            if (historySettings.ASWGlanguage && historySettings.ASWGlanguage !== "-") $("#ASWGlanguage").val(historySettings.ASWGlanguage).trigger('change');
            if (historySettings.ASWGtimingRestriction && historySettings.ASWGtimingRestriction !== "-") $("#ASWGtimingRestriction").val(historySettings.ASWGtimingRestriction).trigger('change');
            if (historySettings.ASWGcharacterName && historySettings.ASWGcharacterName !== "") $("#ASWGcharacterName").val(historySettings.ASWGcharacterName).trigger('change');
            if (historySettings.ASWGcharacterGender && historySettings.ASWGcharacterGender !== "-") $("#ASWGcharacterGender").val(historySettings.ASWGcharacterGender).trigger('change');
            if (historySettings.ASWGcharacterAge && historySettings.ASWGcharacterAge !== "") $("#ASWGcharacterAge").val(historySettings.ASWGcharacterAge).trigger('change');
            if (historySettings.ASWGcharacterRole && historySettings.ASWGcharacterRole !== "-") $("#ASWGcharacterRole").val(historySettings.ASWGcharacterRole).trigger('change');
            if (historySettings.ASWGactorName && historySettings.ASWGactorName !== "") $("#ASWGactorName").val(historySettings.ASWGactorName).trigger('change');
            if (historySettings.ASWGactorGender && historySettings.ASWGactorGender !== "-") $("#ASWGactorGender").val(historySettings.ASWGactorGender).trigger('change');
            if (historySettings.ASWGdirection && historySettings.ASWGdirection !== "") $("#ASWGdirection").val(historySettings.ASWGdirection).trigger('change');
            if (historySettings.ASWGdirector && historySettings.ASWGdirector !== "") $("#ASWGdirector").val(historySettings.ASWGdirector).trigger('change');
            if (historySettings.ASWGfxUsed && historySettings.ASWGfxUsed !== "") $("#ASWGfxUsed").val(historySettings.ASWGfxUsed).trigger('change');
            if (historySettings.ASWGusageRights && historySettings.ASWGusageRights !== "") $("#ASWGusageRights").val(historySettings.ASWGusageRights).trigger('change');
            if (historySettings.ASWGisUnion && historySettings.ASWGisUnion !== "-") $("#ASWGisUnion").val(historySettings.ASWGisUnion).trigger('change');
            if (historySettings.ASWGaccent && historySettings.ASWGaccent !== "") $("#ASWGaccent").val(historySettings.ASWGaccent).trigger('change');
            if (historySettings.ASWGemotion && historySettings.ASWGemotion !== "") $("#ASWGemotion").val(historySettings.ASWGemotion).trigger('change');
            if (historySettings.ASWGcomposer && historySettings.ASWGcomposer !== "") $("#ASWGcomposer").val(historySettings.ASWGcomposer).trigger('change');
            if (historySettings.ASWGartist && historySettings.ASWGartist !== "") $("#ASWGartist").val(historySettings.ASWGartist).trigger('change');
            if (historySettings.ASWGsongTitle && historySettings.ASWGsongTitle !== "") $("#ASWGsongTitle").val(historySettings.ASWGsongTitle).trigger('change');
            if (historySettings.ASWGgenre && historySettings.ASWGgenre !== "") $("#ASWGgenre").val(historySettings.ASWGgenre).trigger('change');
            if (historySettings.ASWGsubGenre && historySettings.ASWGsubGenre !== "") $("#ASWGsubGenre").val(historySettings.ASWGsubGenre).trigger('change');
            if (historySettings.ASWGproducer && historySettings.ASWGproducer !== "") $("#ASWGproducer").val(historySettings.ASWGproducer).trigger('change');
            if (historySettings.ASWGmusicSup && historySettings.ASWGmusicSup !== "") $("#ASWGmusicSup").val(historySettings.ASWGmusicSup).trigger('change');
            if (historySettings.ASWGinstrument && historySettings.ASWGinstrument !== "") $("#ASWGinstrument").val(historySettings.ASWGinstrument).trigger('change');
            if (historySettings.ASWGmusicPublisher && historySettings.ASWGmusicPublisher !== "") $("#ASWGmusicPublisher").val(historySettings.ASWGmusicPublisher).trigger('change');
            if (historySettings.ASWGrightsOwner && historySettings.ASWGrightsOwner !== "") $("#ASWGrightsOwner").val(historySettings.ASWGrightsOwner).trigger('change');
            if (historySettings.ASWGintensity && historySettings.ASWGintensity !== "") $("#ASWGintensity").val(historySettings.ASWGintensity).trigger('change');
            if (historySettings.ASWGorderRef && historySettings.ASWGorderRef !== "") $("#ASWGorderRef").val(historySettings.ASWGorderRef).trigger('change');
            if (historySettings.ASWGisSource && historySettings.ASWGisSource !== "-") $("#ASWGisSource").val(historySettings.ASWGisSource).trigger('change');
            if (historySettings.ASWGisLoop && historySettings.ASWGisLoop !== "-") $("#ASWGisLoop").val(historySettings.ASWGisLoop).trigger('change');
            if (historySettings.ASWGisFinal && historySettings.ASWGisFinal !== "-") $("#ASWGisFinal").val(historySettings.ASWGisFinal).trigger('change');
            if (historySettings.ASWGisOst && historySettings.ASWGisOst !== "-") $("#ASWGisOst").val(historySettings.ASWGisOst).trigger('change');
            if (historySettings.ASWGisCinematic && historySettings.ASWGisCinematic !== "-") $("#ASWGisCinematic").val(historySettings.ASWGisCinematic).trigger('change');
            if (historySettings.ASWGisLicensed && historySettings.ASWGisLicensed !== "-") $("#ASWGisLicensed").val(historySettings.ASWGisLicensed).trigger('change');
            if (historySettings.ASWGisDiegetic && historySettings.ASWGisDiegetic !== "-") $("#ASWGisDiegetic").val(historySettings.ASWGisDiegetic).trigger('change');
            if (historySettings.ASWGmusicVersion && historySettings.ASWGmusicVersion !== "") $("#ASWGmusicVersion").val(historySettings.ASWGmusicVersion).trigger('change');
            if (historySettings.ASWGisrcId && historySettings.ASWGisrcId !== "") $("#ASWGisrcId").val(historySettings.ASWGisrcId).trigger('change');
            if (historySettings.ASWGtempo && historySettings.ASWGtempo !== "") $("#ASWGtempo").val(historySettings.ASWGtempo).trigger('change');
            if (historySettings.ASWGtimeSig && historySettings.ASWGtimeSig !== "") $("#ASWGtimeSig").val(historySettings.ASWGtimeSig).trigger('change');
            if (historySettings.ASWGinKey && historySettings.ASWGinKey !== "") $("#ASWGinKey").val(historySettings.ASWGinKey).trigger('change');
            if (historySettings.ASWGbillingCode && historySettings.ASWGbillingCode !== "") $("#ASWGbillingCode").val(historySettings.ASWGbillingCode).trigger('change');
            //#endregion

            // Mic config requires a little bit of extra work due to the ambisonics modal
            if (historySettings.metaConfig && historySettings.metaConfig !== "-") {
                if (historySettings.metaConfig.includes("Ambisonic")) $("#customAmbi").text(historySettings.metaConfig);
                $("#userInputMetaConfig").val(historySettings.metaConfig).trigger('change');
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // DELETE USER PRESETS
        // ~~~~~~~~~~~~~~~~~~~~
        function deleteOldHistory() {
            // Fetch presets
            if (localStorage.getItem("num-history") !== null) {
                // Count the actual number of saved history items
                var num_history = parseInt(localStorage.getItem("num-history"), 10);
                var actual_num = 0;
                for (var history_index = 1; history_index <= num_history; history_index++) {                    
                    if (localStorage.getItem("ucs-history-" + history_index) !== null) {                        
                        actual_num = actual_num + 1;
                    }
                }

                // Delete the lowest numbers up to the max history slots
                var max_history_slots = 10
                for (var history_index = 1; history_index <= num_history; history_index++) {
                    if (localStorage.getItem("ucs-history-" + history_index) !== null) {                                                                                
                        if (actual_num > max_history_slots) {
                            localStorage.removeItem("ucs-history-" + history_index);
                            $("#userHistory" + history_index).remove();
                            actual_num = actual_num - 1;
                        }
                    }
                }
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // LOAD USERS HISTORY AND FILL OUT DROPDOWN
        // ~~~~~~~~~~~~~~~~~~~~
        function loadUserHistory() {
            // Load presets
            if (localStorage.getItem("num-history") !== null) {
                // Found existing number of presets
                var num_history = parseInt(localStorage.getItem("num-history"), 10);
                for (var history_index = 1; history_index <= num_history; history_index++) {
                    if (localStorage.getItem("ucs-history-" + history_index) !== null) {
                        // Parse JSON
                        var historySettings = JSON.parse(localStorage.getItem("ucs-history-" + history_index));
                        
                        // Add dropdown element for history to top of list
                        $("#navbarHistoryDropdownOptions").prepend('<a class="dropdown-item" href="#" id="userHistory' + history_index + '" onClick="loadThisHistory(' + history_index + ')" style="display: flex; align-items: center;">' + historySettings.preset + '</a>');
                    }
                }
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // GBX Mod
        // Format:  GBX [UCS Cat] [UCS Sub Cat] [Brief Description based on Meta Tag incl Source + Source Descriptor] [Mic] SRC
        // Example: GBX FOLY CLOTH Canvas Large Snap Whoosh Cloth Fight Explo 416 SRC.wav
        // ~~~~~~~~~~~~~~~~~~~~
        function GBXMod() {
            // Update Title
            $("#navbarTitle").text("UCS Tool - GBX Mod");
            $("#navbarLogo").attr("src","ucs_libraries/gbx_logo.png");

            // // Brief Description = File Name
            // $("#fileNameLabelText").text("GBX - Brief Description*");
            // $("#userInputName").attr("placeholder", "Based on Meta Tag including source and source descriptor");
            
            // // Hide variation numberin
            // $("#userInputVarNumCheckbox").prop("checked",false);
            // $("#varNumberingDiv").hide();

            // // GBX Microphone = User Data/Notes
            $("#userInputDataLabel").text("GBX - Microphone*");
            $("#userInputData").attr("placeholder", "416, 8040, CO100K, synth");
            $("#userInputDataHelp").text("If source was synthesis, use 'synth'.");
            // Sync Microphone field with metadata mic
            $("#userInputData").on("input", function() { $("#userInputMetaMic").val(this.value); });
            $("#userInputMetaMic").on("input", function() { $("#userInputData").val(this.value); });

            // GBX Suffix (Show Hidden Dropdown)
            $("#gbxSuffixGroup").show();
            
            // // Hide & Remove: User Category, Creator ID, Source ID
            $("#userInputInitials").removeAttr('required');
            $("#initialsGroup").hide();
            //$("#userCategoryGroup").hide();
            // $("#showGroup").hide();
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // USE OFFLINE UCS DATA IF AVAILABLE
        // ~~~~~~~~~~~~~~~~~~~~
        function useOfflineUSCData(offlineTableData) {
            // Display appropriate HTML elements
            $("#UCSTableSubHeading").text("UCS Data Offline Mode ~ UCS v8.2");
            //$("#reenableOnlineUCSButtonText").show();
            //$("#onlineUCSButton").show();

            // Build full table from offline info
            jsonFullTable = JSON.parse(offlineTableData);

            // Loop through table data
            for (let [key, value] of Object.entries(jsonFullTable)) {
                var jsonCategory = value[0];
                var jsonSubcategory = value[1];
                var jsonCatID = value[2];
                var jsonShortID = value[3];
                var jsonExplanation = value[4];
                var jsonSynonym = value[5];

                // Build category & subcategory array for dynamic subcategories
                if (!jsonCategorySubcategoryArr.hasOwnProperty(jsonCategory)) {
                    jsonCategorySubcategoryArr[jsonCategory] = jsonSubcategory;
                } else {
                    jsonCategorySubcategoryArr[jsonCategory] = jsonCategorySubcategoryArr[jsonCategory] + ", " + jsonSubcategory;
                }

                // Build CatID array for Reaper
                if (!jsonCatIDArr.hasOwnProperty(jsonCatID)) {
                    jsonCatIDArr[jsonCatID] = jsonCategory + ", " + jsonSubcategory;
                } else {
                    console.log("There is a duplicate CatID: " + jsonCatID + "\n" + "Using first occurrence: " + jsonCatIDArr[jsonCatID]);
                }

                // Build autocomplete arrays
                if (!jsonCategoryAutofill.includes(jsonCategory) && jsonCategory != "Category") {
                    jsonCategoryAutofill.push(jsonCategory);
                }
                if (!jsonSubcategoryAutofill.includes(jsonSubcategory) && jsonSubcategory != "SubCategory" && jsonSubcategory != "-") {
                    jsonSubcategoryAutofill.push(jsonSubcategory);
                }
            }

            // Initialize data table
            $('#UCRTDataTable').DataTable({
                "paging": true,
                "info": false,
                "lengthChange": false,
                "pageLength": 50,
                data: jsonFullTable,
                columns: [
                    { title: "Category" },
                    { title: "Subcategory" },
                    { title: "CatID" },
                    { title: "ShortID" },
                    { title: "Explanations" },
                    { title: "Synonyms" }
                ],
                "dom": '<"dtSearch"f>rt<"dtPages"lp><"clear">'
            });

            $('.dataTables_filter input[type="search"]').css(
                { 'min-width': '500px', 'display': 'inline-block' }
            );
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // USE GOOGLE SHEET DATA IF UCS OFFLINE NOT AVAILABLE
        // ~~~~~~~~~~~~~~~~~~~~
        function useGSheetsUSCData() {
            // Display appropriate HTML elements
            $("#downloadUCSButton").show();
            $("#downloadUCSButtonText").show();

            // Parse JSON from Google Sheet
            var ucs_gsheet = "";

            if (localStorage.getItem("ucs_language") !== null) {
                console.log("Language preference found in local storage.")
                ucs_gsheet = localStorage.getItem("ucs_language");
            } else {
                console.log("No language preference set. Default: English.");
                localStorage.setItem("ucs_language", ucs_gsheet_en);
                localStorage.setItem("ucs_language_country", "us");
                ucs_gsheet = ucs_gsheet_en;
            }

            $.getJSON(ucs_gsheet, function (data) {
                var entry = data.feed.entry;

                // Get UCS data version number
                var UCSVersionNumber = entry[0].content.$t;
                $("#UCSTableSubHeading").text("Google Sheets Data/Online Mode ~ UCS " + UCSVersionNumber);

                // Loop through the JSON, starting on the second row (skip headers)
                // For this process to work, there CANNOT be any blank cells
                for (var i = 6; i < entry.length - 6; i += 6) {
                    // entry[i].content.$t retrieves the content of each cell
                    var jsonCategory = entry[i].content.$t;
                    var jsonSubcategory = entry[i + 1].content.$t;
                    var jsonCatID = entry[i + 2].content.$t;
                    var jsonShortID = entry[i + 3].content.$t;
                    var jsonExplanation = entry[i + 4].content.$t;
                    var jsonSynonym = entry[i + 5].content.$t;

                    // Build full table for DataTable
                    jsonFullTable.push([jsonCategory, jsonSubcategory, jsonCatID, jsonShortID, jsonExplanation, jsonSynonym]);

                    // Build category & subcategory array for dynamic subcategories
                    if (!jsonCategorySubcategoryArr.hasOwnProperty(jsonCategory)) {
                        jsonCategorySubcategoryArr[jsonCategory] = jsonSubcategory;
                    } else {
                        jsonCategorySubcategoryArr[jsonCategory] = jsonCategorySubcategoryArr[jsonCategory] + ", " + jsonSubcategory;
                    }

                    // Build CatID array for Reaper
                    if (!jsonCatIDArr.hasOwnProperty(jsonCatID)) {
                        jsonCatIDArr[jsonCatID] = jsonCategory + ", " + jsonSubcategory;
                    } else {
                        console.log("There is a duplicate CatID: " + jsonCatID + "\n" + "Using first occurrence: " + jsonCatIDArr[jsonCatID]);
                    }

                    // Build autocomplete arrays
                    if (!jsonCategoryAutofill.includes(jsonCategory) && jsonCategory != "Category") {
                        jsonCategoryAutofill.push(jsonCategory);
                    }
                    if (!jsonSubcategoryAutofill.includes(jsonSubcategory) && jsonSubcategory != "SubCategory" && jsonSubcategory != "-") {
                        jsonSubcategoryAutofill.push(jsonSubcategory);
                    }
                }

                // Initialize data table
                $('#UCRTDataTable').DataTable({
                    "paging": true,
                    "info": false,
                    "lengthChange": false,
                    "pageLength": 50,
                    data: jsonFullTable,
                    columns: [
                        { title: "Category" },
                        { title: "Subcategory" },
                        { title: "CatID" },
                        { title: "ShortID" },
                        { title: "Explanations" },
                        { title: "Synonyms" }
                    ],
                    "dom": '<"dtSearch"f>rt<"dtPages"lp><"clear">'
                });

                $('.dataTables_filter input[type="search"]').css(
                    { 'width': '100%', 'box-sizing': 'border-box', 'max-width': '500px', 'display': 'inline-block' }
                );
            })
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // SET REAPER PROJEXTSTATE
        // ~~~~~~~~~~~~~~~~~~~~
        // Can accept HTML element ID as input 1, will use element ID as extstate field name
        // Can accept other variables as input 1, with extstate field name as input 2 string
        function setProjExtState(field, extName = "") {
            var htmlEle = document.getElementById(field);
            if (htmlEle) {
                var val = htmlEle.value;
                wwr_req("SET/PROJEXTSTATE/UCS_WebInterface/" + field + "/" + val);
            } else {
                var val = field;
                wwr_req("SET/PROJEXTSTATE/UCS_WebInterface/" + extName + "/" + val);
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // FIND CATID FROM CAT & SUBCAT
        // ~~~~~~~~~~~~~~~~~~~~
        function getCatID(selectedCat, selectedSubcat) {
            var arrVal = selectedCat + ", " + selectedSubcat;
            if (Object.keys(jsonCatIDArr).find(key => jsonCatIDArr[key] === arrVal)) {
                var arrCatID = Object.keys(jsonCatIDArr).find(key => jsonCatIDArr[key] === arrVal);
                console.log("Found CatID: " + arrCatID);
                return arrCatID;
            } else {
                //alert("No valid CatID found." + "\n" + "\n" + "Please check your Category & Subcategory selections!");
                $("#userInputCategoryError").show();
                window.scrollTo(0,0);
                var invalid = "CATID_INVALID";
                return invalid;
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // CLEAN UP USER'S FILE NAME INPUT
        // ~~~~~~~~~~~~~~~~~~~~
        // Splits into name & number (formatted as string)
        // Uses RegEx to ensure name conforms to UCS standard (see RegEx function below)
        function getNameAndNumber(name) {
            var fxFormattingSetting = $("#fxFormattingSetting").val();
            var cleanName = (fxFormattingSetting.includes("Enable")) ? stringCleaning(name) : name.replace(/_/g, " ");
            var matches = cleanName.match(/\d+$/);
            if (matches) {
                // If user included a number at the end of the name...
                var number = String(parseInt(matches[0], 10));
                var noNum = cleanName.replace(/\d+$/, "");
                var noSpace = stringCleaning(noNum);
                console.log("Name: " + noSpace + " | Number: " + number);
                return [noSpace, number];
            } else {
                // Start at 1 otherwise
                var number = "1";
                console.log("Name: " + cleanName + " | Number: " + number);
                return [cleanName, number];
            }
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // REGEX USER INPUT CLEANING
        // ~~~~~~~~~~~~~~~~~~~~
        // RegEx to clean up user input fields, see comments on right
        function stringCleaning(inString) {
            var noIllegalChars = inString.replace(/[\"\'\~\`\@\=\&\*\/\\\:\<\>\?\|\%\#\!\+\[\]\{\}]/g, "");    // Removes illegal characters
            var noLeadingWhitespace = noIllegalChars.replace(/^\s+/, "");                          // Removes whitespace at start of string
            var noTrailingWhitespace = noLeadingWhitespace.replace(/\s+$/, "");                    // Removes whitespace at end of string
            var noUnderscores = noTrailingWhitespace.replace(/_/g, " ");                           // Replaces underscores with spaces
            var noDoubleSpaces = noUnderscores.replace(/\s\s+/g, " ");                             // Removes double spaces, tabs, or multiple spaces in the middle of a string
            return noDoubleSpaces;
        }

        // ~~~~~~~~~~~~~~~~~~~~
        // DOWNLOAD "UCS.txt" BLOB FILE
        // ~~~~~~~~~~~~~~~~~~~~
        // Creates a text file from the Univ Cat System array
        // Spoofs a download link on the page for the created file, clicks it then removes spoof (sneaky)
        function downloadBlobFile() {
            // Open Reaper resource path
            wwr_req(encodeURIComponent(REApath));

            // Create text file from array input
            var textFile = null,
                makeTextFile = function (arr) {
                    var arrToText = new Blob([JSON.stringify(arr)], { type: 'text/plain' });
                    // If we are replacing a previously generated file we need to
                    // manually revoke the object URL to avoid memory leaks.
                    if (textFile !== null) {
                        window.URL.revokeObjectURL(textFile);
                    }
                    textFile = window.URL.createObjectURL(arrToText);
                    return textFile;
                };

            // Create page element for link to file
            var link = document.createElement('a');
            link.setAttribute('download', 'UCS.txt');
            link.href = makeTextFile(jsonFullTable);

            // Spoof user clicking on new download link
            document.body.appendChild(link);
            window.requestAnimationFrame(function () {
                var event = new MouseEvent('click');
                link.dispatchEvent(event);
                document.body.removeChild(link);
            });
        }
    </script>
</body>
</html>